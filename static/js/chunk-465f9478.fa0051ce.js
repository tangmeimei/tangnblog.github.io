(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-465f9478"],{2476:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"toms-container"},[a("div",{staticClass:"toms-list-searchWrap"},[a("zm-Search",{ref:"search",attrs:{inputList:e.inputList,btnConfig:e.btnConfig},on:{handleAddProcess:e.handleAddProcess,search:e.search,reset:e.resetTable}})],1),a("div",{staticClass:"toms-list-tableWrap"},[a("zm-table",{ref:"tableRef",staticStyle:{width:"100%"},attrs:{tableData:e.tableData,columns:e.columns,height:"527px",currentPage:e.pageData.pageIndex,pageSize:e.pageData.pageSize,total:e.pageData.pageCount,sizeList:e.sizeList,isCheckboxGroup:!0},on:{handleCurrentChange:e.handleCurrentChange,sortChange:e.sortChange,handleSizeChange:e.handleSizeChange}})],1),a("el-dialog",{attrs:{title:e.modalTitle,visible:e.openAddModal,width:"40%","before-close":e.handleClose},on:{"update:visible":function(t){e.openAddModal=t}}},[a("zm-form",{key:e.keyFlag,ref:"addProcess",attrs:{formData:e.addProcessForm,formConfig:e.formConfig,rules:e.addProcessRules,labelWidth:"140px"}}),a("div",{staticClass:"uploadImg"},[a("div",{staticClass:"left"},[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v(" ICON图标")]),a("div",{staticClass:"right"},[e.imageUrl?e._e():a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.fileLoadUrl,name:"files","show-file-list":!1,"list-type":"picture-card","on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,limit:1}},[a("i",{staticClass:"el-icon-plus"})]),e.imageUrl?a("div",{staticClass:"previewImg",staticStyle:{width:"148px",height:"148px"}},[a("el-image",{staticStyle:{width:"148px",height:"148px"},attrs:{src:e.imageUrl,fit:"fit"}}),a("div",{staticClass:"bgc",staticStyle:{"text-align":"center","line-height":"148px"}},[a("i",{staticClass:"el-icon-delete",staticStyle:{color:"#cccccc","font-size":"36px",cursor:"pointer"},on:{click:e.handleRemoveImg}})])],1):e._e()],1)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),a("Debounce",{attrs:{time:500,events:"click"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitAddProcess(t)}}},[e._v("确 定")])],1)],1)],1)],1)},i=[],n=a("5530"),o=a("1da1"),r=a("ade3"),l=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("b0c0"),a("d81d"),a("159b"),a("a434"),a("8cc7")),c=a("c91b"),d=a("a937"),p=(a("ed08"),a("5f98")),u=function(e){var t=e.$store.state.baseData.baseDataOptionList,a=t.IS_ISEF.map((function(e){return{text:"是"===e.text?"有效":"无效",value:e.value}}));return[{type:"text-input",bind_key:"flowName",labelWidth:"60px",inputWidth:240,label:"流程名称",placeholder:"请输入",span:6},{type:"select-input",bind_key:"flowClass",label:"流程种类",span:6,optionList:t.IT_PCTP},{type:"select-input",bind_key:"flowType",label:"流程类型",span:6,optionList:t.IT_PTYP},{type:"select-input",bind_key:"isValid",label:"是否有效",span:6,optionList:a}]},f={span:24,customList:[{role:"flow.name.add",customBtnText:"新增",changeFn:"handleAddProcess"}],leftBtnHidden:!Object(p["a"])("flow.name.list")},h=function(e){var t=Object(p["a"])("flow.name.edit"),a=Object(p["a"])("flow.name.delete");return[{label:"序号",width:"50px",kind:"render",render:function(t,a){var s=a.$index+1,i=(e.pageData.pageIndex-1)*e.pageData.pageSize;return t("span",s+i)}},{label:"流程种类",prop:"flowClass",sortable:"custom"},{label:"流程类型",prop:"flowType",sortable:"custom"},{label:"流程编号",prop:"flowNo",sortable:"custom"},{label:"流程名称",prop:"flowName",align:"left"},{label:"是否关联移动端",prop:"isPhone",sortable:"custom"},{label:"是否有效",prop:"isValid",sortable:"custom"},{label:"操作",kind:"render",render:function(s,i){return s("div",[s("span",{class:{renderOperation:!0},style:{display:t?"inline":"none"},on:{click:function(){e.editFn(i.row)}}},"编辑"),s("span",{class:{renderOperation:!0},style:{display:a?"inline":"none"},on:{click:function(){e.deleteFn(i.row)}}},"删除")])}}]},g=function(e){var t=e.$store.state.baseData.baseDataOptionList;return[{span:12,list:[{type:"select",prop:"flowClass",label:"流程种类",placeholder:"请选择",optionList:t.IT_PCTP}]},{span:12,list:[{type:"select",label:"流程类型",prop:"flowType",placeholder:"请选择",optionList:t.IT_PTYP}]},{span:12,list:[{type:"text",label:"流程编号",prop:"flowNo"}]},{span:12,list:[{type:"text",label:"流程名称",prop:"flowName"}]},{span:12,list:[{type:"radioGroup",label:"是否关联移动端",prop:"isPhone",optionList:t.IT_RLH5}]},{span:12,list:[{type:"radioGroup",label:"是否有效",prop:"isValid",optionList:t.IS_ISEF}]}]},m={flowClass:{required:!0,message:"请选择流程种类",trigger:"change"},flowType:{required:!0,message:"请选择流程类型",trigger:"change"},flowNo:{required:!0,message:"请输入流程编号",trigger:"blur"},flowName:{required:!0,message:"请输入流程名称",trigger:"blur"},isPhone:{required:!0,message:"请选择是否关联移动端",trigger:"change"},isValid:{required:!0,message:"请选择是否有效",trigger:"change"}},b=a("fa38"),w=(a("3f5e"),{name:"ProcessNameConfig",components:{zmTable:l["a"],zmSearch:d["a"],zmForm:c["a"]},data:function(){var e=u(this),t=h(this);return{btnConfig:f,inputList:e,tableData:[{}],columns:t,pageData:{pageIndex:1,pageSize:15,pageCount:0},searchData:{},sortData:[],sizeList:[15,30,50],openAddModal:!1,modalTitle:"流程名称-新增",addProcessForm:Object(r["a"])({iconFileId:"",flowClass:"",flowName:"",flowNo:"",flowType:"",isPhone:"",isValid:""},"iconFileId",""),formConfig:g(this),addProcessRules:m,imageUrl:"",keyFlag:0,fileLoadUrl:"https://www.tobowork.com/api/tobosoft-toms/strato/cloud/file/contract/toms-1255586777/upload",isDisabledEvents:!1}},mounted:function(){this.getProcessNameData()},activated:function(){var e=this;this.$nextTick((function(){e.$refs.tableRef.doLayoutTable()}))},methods:{handleAvatarSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw),this.addProcessForm.iconFileId=Array.isArray(e)&&e[0].fileId},beforeAvatarUpload:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),a="jpg"===t,s="jpeg"===t,i="png"===t,n=e.size/1024/1024<1;a||s||i||this.$message.error("上传头像图片只能是 JPG、JPEG、PNG 格式!"),n||this.$message.error("上传ICON图片大小不能超过 1MB!");var o=a||s||i;return o&&n},handleRemoveImg:function(){this.imageUrl=""},getProcessNameData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var s,i,o,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=e||{},i={input:s},o=Object.assign({},t.pageData,i),o.input.displays=t.sortData,a.next=6,Object(b["p"])(o);case 6:r=a.sent,t.pageData.pageIndex=r.pageIndex,t.pageData.pageCount=r.rowCount,t.tableData=r.result&&r.result.map((function(e){return Object(n["a"])(Object(n["a"])({},e.clientCompany),e)}));case 10:case"end":return a.stop()}}),a)})))()},handleAddProcess:function(){this.isDisabledEvents=!1,this.openAddModal=!0,this.modalTitle="流程名称-新增",this.addProcessForm=Object(r["a"])({iconFileId:"",flowClass:"",flowName:"",flowNo:"",flowType:"",isPhone:"",isValid:""},"iconFileId",""),this.keyFlag+=1},handleClose:function(){this.openAddModal=!1,this.imageUrl=""},submitAddProcess:function(){var e=this;console.log(this.isDisabledEvents,"shifoukeyi"),this.isDisabledEvents||this.$refs.addProcess.validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=9;break}if(console.log(a,"收集的数据"),a.iconFileId){t.next=5;break}return e.$message.warning("请上传icon图片"),t.abrupt("return");case 5:return t.next=7,Object(b["k"])(a);case 7:s=t.sent,"200"===s.code&&(e.isDisabledEvents=!0,e.$message.success("新增成功"),e.openAddModal=!1,e.getProcessNameData(),e.imageUrl="");case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},search:function(e){this.pageData.pageIndex=1;var t=JSON.parse(JSON.stringify(e));this.searchData=t,this.getProcessNameData(t)},handleSizeChange:function(e){this.pageData.pageIndex=1,this.pageData.pageSize=e,this.getProcessNameData(this.searchData)},editFn:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.isDisabledEvents=!1,t.keyFlag+=1,s=e.flowId,t.openAddModal=!0,t.modalTitle="流程名称-编辑",a.next=7,Object(b["c"])({flowId:s});case 7:i=a.sent,t.addProcessForm={iconFileId:i.iconFileId,flowClass:i.flowClass,flowName:i.flowName,flowNo:i.flowNo,flowType:i.flowType,isPhone:i.isPhone,isValid:i.isValid,flowId:i.flowId},i.iconFileId&&(t.imageUrl="https://www.tobowork.com//api/tobosoft-toms/cos/file/view/"+i.iconFileId),console.log(i,"详情");case 11:case"end":return a.stop()}}),a)})))()},resetTable:function(){this.pageData.pageIndex=1,this.searchData={},this.getProcessNameData(this.searchData)},deleteFn:function(e){var t=this,a={flowId:e.flowId};this.$confirm("删除此流程名称后将导致此流程无法发起且与之相关的数据项都将受到影响,且将记录此次删除人的操作和信息.","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(b["a"])(a);case 2:s=e.sent,"200"===s.code&&(t.$message.success("删除成功"),t.getProcessNameData());case 4:case"end":return e.stop()}}),e)}))))},handleCurrentChange:function(e){this.pageData.pageIndex=e,this.getProcessNameData(this.searchData)},sortChange:function(e){var t=this,a="";a="ascending"===e.order?"asc":"desc";var s={display:a,field:e.prop};0===this.sortData.length?this.sortData.push(s):this.sortData.forEach((function(e,a){if(e.field===s.field){if(e.display===s.display)return void t.sortData.splice(a,1);t.sortData.splice(a,1),t.sortData.push(s)}else t.sortData.push(s)})),this.getProcessNameData()}},watch:{$route:function(){this.getProcessNameData()}}}),v=w,D=(a("8500"),a("2877")),C=Object(D["a"])(v,s,i,!1,null,"7a0b4dad",null);t["default"]=C.exports},"3f5e":function(e,t,a){"use strict";a("b775")},"4c9d":function(e,t,a){},"5d12":function(e,t,a){"use strict";var s={ONLY_NUMBER_NO_ZERO:/[^1-9]/g,ONLY_NUMBER:/[\D]/g,ONLY_NUMBER_LETTER:/[\W]/g,NO_CN:/[\u0391-\uFFE5]+/,EMAIL:/\{|\}|\（|\)|\=|\%|\~|\!|\^|\&|\+|\#|\￥|\）|\{|\}|\！|[\u0391-\uFFE5]/g,NUMBER_WITH_POINT:/[^\d\.]/g};t["a"]=s},8500:function(e,t,a){"use strict";a("4c9d")}}]);