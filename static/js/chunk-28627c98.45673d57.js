(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28627c98"],{3402:function(t,e,a){"use strict";a("a3af")},"35ad":function(t,e,a){"use strict";a.d(e,"f",(function(){return r})),a.d(e,"k",(function(){return i})),a.d(e,"b",(function(){return s})),a.d(e,"y",(function(){return o})),a.d(e,"A",(function(){return c})),a.d(e,"d",(function(){return l})),a.d(e,"j",(function(){return u})),a.d(e,"l",(function(){return p})),a.d(e,"c",(function(){return d})),a.d(e,"p",(function(){return m})),a.d(e,"z",(function(){return f})),a.d(e,"x",(function(){return v})),a.d(e,"e",(function(){return C})),a.d(e,"h",(function(){return b})),a.d(e,"w",(function(){return h})),a.d(e,"a",(function(){return y})),a.d(e,"v",(function(){return g})),a.d(e,"B",(function(){return _})),a.d(e,"r",(function(){return D})),a.d(e,"q",(function(){return w})),a.d(e,"s",(function(){return O})),a.d(e,"i",(function(){return T})),a.d(e,"u",(function(){return I})),a.d(e,"o",(function(){return L})),a.d(e,"n",(function(){return S})),a.d(e,"t",(function(){return x})),a.d(e,"g",(function(){return j})),a.d(e,"m",(function(){return k}));var n=a("b775");function r(t){return Object(n["a"])({url:"/business/contract/queryContractList",method:"post",data:t})}function i(t){return Object(n["a"])({url:"/business/client/queryClientCompanyInfos",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/business/contract/deleteContract",method:"post",params:t})}function o(t){return Object(n["a"])({url:"/business/contract/saveOrUpdate",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/business/contract/saveOrUpdateRelation",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/business/contract/queryContractInfo",method:"post",params:t})}function u(t){return Object(n["a"])({url:"/business/contract/queryContractSelectList",method:"post",data:t})}function p(t){return Object(n["a"])({url:"/commons/basedata/queryCompanyList",method:"post",data:t})}function d(t){return Object(n["a"])({url:"/business/client/queryAllClientCompanySelectList",method:"post",data:t})}function m(t){return Object(n["a"])({url:"/business/client/queryClientCompanyListNoScope",method:"post",data:t})}function f(t){return Object(n["a"])({url:"/business/contract/saveContractPrice",method:"post",data:t})}function v(t){return Object(n["a"])({url:"/business/contract/addContractAndVirtualRelation",method:"post",data:t})}function C(t){return Object(n["a"])({url:"/business/contract/queryContractFileList",method:"post",params:t})}function b(t){return Object(n["a"])({url:"/business/contract/queryContractPrice",method:"post",params:t})}function h(t){return Object(n["a"])({url:"/business/contract/queryTMContractPrice",method:"post",params:t})}function y(t){return Object(n["a"])({url:"/business/contract/checkContractInfo",method:"post",data:t})}function g(t){return Object(n["a"])({url:"/business/contract/queryStagingList",method:"post",data:t})}function _(t){return Object(n["a"])({url:"/business/contract/saveOrupdateStaging",method:"post",data:t})}function D(t){return Object(n["a"])({url:"/business/contract/queryContractPriceDimension",method:"post",params:t})}function w(t){return Object(n["a"])({url:"/business/contract/queryContractSelectListByLike",method:"post",params:t})}function O(t){return Object(n["a"])({url:"/business/contract/queryContractPriceResult",method:"post",params:t})}function T(t){return Object(n["a"])({url:"/salary/salaryLineSet/queryForStation",method:"post",data:t})}function I(t){return Object(n["a"])({url:"/salary/salaryLineSet/queryForLevel",method:"post",data:t})}function L(t){return Object(n["a"])({url:"/salary/salaryLineSet/querForPirce",method:"post",data:t})}function S(t){return Object(n["a"])({url:"/salary/salaryLineSet/querForDetail",method:"post",data:t})}function x(t){return Object(n["a"])({url:"/business/contract/queryContractSelectByOrgIdANDClientCompanyId",method:"post",params:t})}function j(t){return Object(n["a"])({url:"/business/contract/getContractPrice",method:"post",params:t})}function k(t){return Object(n["a"])({url:"/business/contract/queryContractPriceVersionList/".concat(t),method:"post"})}},"5d12":function(t,e,a){"use strict";var n={ONLY_NUMBER_NO_ZERO:/[^1-9]/g,ONLY_NUMBER:/[\D]/g,ONLY_NUMBER_LETTER:/[\W]/g,NO_CN:/[\u0391-\uFFE5]+/,EMAIL:/\{|\}|\（|\)|\=|\%|\~|\!|\^|\&|\+|\#|\￥|\）|\{|\}|\！|[\u0391-\uFFE5]/g,NUMBER_WITH_POINT:/[^\d\.]/g};e["a"]=n},6062:function(t,e,a){"use strict";var n=a("6d61"),r=a("6566");t.exports=n("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},6566:function(t,e,a){"use strict";var n=a("9bf2").f,r=a("7c73"),i=a("e2cc"),s=a("0366"),o=a("19aa"),c=a("2266"),l=a("7dd0"),u=a("2626"),p=a("83ab"),d=a("f183").fastKey,m=a("69f3"),f=m.set,v=m.getterFor;t.exports={getConstructor:function(t,e,a,l){var u=t((function(t,n){o(t,u,e),f(t,{type:e,index:r(null),first:void 0,last:void 0,size:0}),p||(t.size=0),void 0!=n&&c(n,t[l],t,a)})),m=v(e),C=function(t,e,a){var n,r,i=m(t),s=b(t,e);return s?s.value=a:(i.last=s={index:r=d(e,!0),key:e,value:a,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=s),n&&(n.next=s),p?i.size++:t.size++,"F"!==r&&(i.index[r]=s)),t},b=function(t,e){var a,n=m(t),r=d(e);if("F"!==r)return n.index[r];for(a=n.first;a;a=a.next)if(a.key==e)return a};return i(u.prototype,{clear:function(){var t=this,e=m(t),a=e.index,n=e.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete a[n.index],n=n.next;e.first=e.last=void 0,p?e.size=0:t.size=0},delete:function(t){var e=this,a=m(e),n=b(e,t);if(n){var r=n.next,i=n.previous;delete a.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),a.first==n&&(a.first=r),a.last==n&&(a.last=i),p?a.size--:e.size--}return!!n},forEach:function(t){var e,a=m(this),n=s(t,arguments.length>1?arguments[1]:void 0,3);while(e=e?e.next:a.first){n(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!b(this,t)}}),i(u.prototype,a?{get:function(t){var e=b(this,t);return e&&e.value},set:function(t,e){return C(this,0===t?0:t,e)}}:{add:function(t){return C(this,t=0===t?0:t,t)}}),p&&n(u.prototype,"size",{get:function(){return m(this).size}}),u},setStrong:function(t,e,a){var n=e+" Iterator",r=v(e),i=v(n);l(t,e,(function(t,e){f(this,{type:n,target:t,state:r(t),kind:e,last:void 0})}),(function(){var t=i(this),e=t.kind,a=t.last;while(a&&a.removed)a=a.previous;return t.target&&(t.last=a=a?a.next:t.state.first)?"keys"==e?{value:a.key,done:!1}:"values"==e?{value:a.value,done:!1}:{value:[a.key,a.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),a?"entries":"values",!a,!0),u(e)}}},"6d61":function(t,e,a){"use strict";var n=a("23e7"),r=a("da84"),i=a("94ca"),s=a("6eeb"),o=a("f183"),c=a("2266"),l=a("19aa"),u=a("861d"),p=a("d039"),d=a("1c7e"),m=a("d44e"),f=a("7156");t.exports=function(t,e,a){var v=-1!==t.indexOf("Map"),C=-1!==t.indexOf("Weak"),b=v?"set":"add",h=r[t],y=h&&h.prototype,g=h,_={},D=function(t){var e=y[t];s(y,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(C&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return C&&!u(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(C&&!u(t))&&e.call(this,0===t?0:t)}:function(t,a){return e.call(this,0===t?0:t,a),this})};if(i(t,"function"!=typeof h||!(C||y.forEach&&!p((function(){(new h).entries().next()})))))g=a.getConstructor(e,t,v,b),o.REQUIRED=!0;else if(i(t,!0)){var w=new g,O=w[b](C?{}:-0,1)!=w,T=p((function(){w.has(1)})),I=d((function(t){new h(t)})),L=!C&&p((function(){var t=new h,e=5;while(e--)t[b](e,e);return!t.has(-0)}));I||(g=e((function(e,a){l(e,g,t);var n=f(new h,e,g);return void 0!=a&&c(a,n[b],n,v),n})),g.prototype=y,y.constructor=g),(T||L)&&(D("delete"),D("has"),v&&D("get")),(L||O)&&D(b),C&&y.clear&&delete y.clear}return _[t]=g,n({global:!0,forced:g!=h},_),m(g,t),C||a.setStrong(g,t,v),g}},"937e":function(t,e,a){},"9a54":function(t,e,a){"use strict";a("937e")},a3af:function(t,e,a){},a4fc:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addCustomer-container"},[a("div",{staticClass:"navBar"},t._l(t.navList,(function(e,n){return a("div",{key:e,class:{current:t.navFlag===n},on:{click:function(e){return t.navChange(n)}}},[t._v(" "+t._s(e)+" ")])})),0),a("div",{staticClass:"form-wrap"},[t.currentAdd?a("div",{staticClass:"temporary-btn"},[a("span",{on:{click:t.getStorageDataShow}},[t._v("获取暂存数据")])]):t._e(),a("div",{staticClass:"basicInfo"},[t._m(0),a("zm-form",{ref:"firstForm",attrs:{formData:t.formData,formConfig:t.formConfig,rules:t.rules,labelWidth:"140px"},on:{contractSelectChange:t.contractSelectChange,remoteSelectChange:t.remoteSelectChange,remoteSelectBlur:t.remoteSelectBlur,remoteMethod:t.remoteMethod}}),a("el-row",{staticStyle:{"padding-top":"20px"}},[a("el-col",{staticClass:"formItem"},[a("div",{staticClass:"label"},[t._v("是否为续期")]),a("div",{staticClass:"content"},[a("el-radio-group",{model:{value:t.formData.isRenewal,callback:function(e){t.$set(t.formData,"isRenewal",e)},expression:"formData.isRenewal"}},[a("el-radio",{attrs:{label:!1}},[t._v("未续期")]),a("el-radio",{attrs:{label:!0}},[t._v("续期")])],1),t.formData.isRenewal?a("div",{staticClass:"right"},[a("div",{staticClass:"item"},[a("span",[t._v("第")]),a("el-input-number",{staticStyle:{width:"100px"},attrs:{"controls-position":"right",min:1,max:1e3},model:{value:t.formData.renewalCount,callback:function(e){t.$set(t.formData,"renewalCount",e)},expression:"formData.renewalCount"}}),a("span",[t._v("次")]),a("span",{staticStyle:{"margin-left":"10px"}},[t._v("第")]),a("el-input-number",{staticStyle:{width:"100px"},attrs:{"controls-position":"right",min:1,max:1e3},model:{value:t.formData.renewalYear,callback:function(e){t.$set(t.formData,"renewalYear",e)},expression:"formData.renewalYear"}}),a("span",[t._v("年续期")])],1),a("div",{staticClass:"item"},[a("span",{staticClass:"sonLabel"},[t._v("关联上期合同")]),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData.parentId,callback:function(e){t.$set(t.formData,"parentId",e)},expression:"formData.parentId"}},t._l(t.previousContractList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)],1)]):t._e()],1)])],1)],1),a("div",{staticClass:"customerInfo"},[t._m(1),a("zm-form",{ref:"secondForm",attrs:{formData:t.formData2,formConfig:t.formConfig2,rules:t.rules2,labelWidth:"140px"}})],1),a("div",{staticClass:"customerInfo"},[t._m(2),a("zm-form",{ref:"thirdForm",attrs:{formData:t.formData3,formConfig:t.formConfig3,rules:t.rules3,labelWidth:"140px"},on:{partBSelectChange:t.partBSelectChange}})],1),a("div",{staticClass:"customerInfo"},[t._m(3),a("zm-form",{ref:"fourthForm",attrs:{formData:t.formData4,formConfig:t.formConfig4,rules:t.rules4,labelWidth:"140px"}})],1),a("div",{staticClass:"customerInfo"},[t._m(4),a("el-form",{ref:"fivethForm",staticClass:"demo-ruleForm",attrs:{model:t.contractStatusFormData,rules:t.contractStatusRules,"label-width":"140px"}},[a("el-row",{staticStyle:{"padding-top":"20px"}},[a("el-col",{staticClass:"formItem",attrs:{span:8}},[a("el-form-item",{attrs:{label:"合同状态",prop:"contractStatus"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.handleContractStatusSelect},model:{value:t.contractStatusFormData.contractStatus,callback:function(e){t.$set(t.contractStatusFormData,"contractStatus",e)},expression:"contractStatusFormData.contractStatus"}},t._l(t.contractStatusList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)],1)],1),t.contractStatusFlag?a("el-col",{staticClass:"formItem",attrs:{span:8}},[a("el-form-item",{attrs:{label:"合同终止方式",prop:"contractOverStatus"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.handleContractStatusOverSelect},model:{value:t.contractStatusFormData.contractOverStatus,callback:function(e){t.$set(t.contractStatusFormData,"contractOverStatus",e)},expression:"contractStatusFormData.contractOverStatus"}},t._l(t.contractOverStatusList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)],1)],1):t._e(),t.contractOverStatusFlag?a("el-col",{staticClass:"formItem",attrs:{span:8}},[a("el-form-item",{attrs:{label:"合同协议终止日期",prop:"contractOverDate"}},[a("el-date-picker",{staticStyle:{width:"400px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期","picker-options":t.pickerOptions},model:{value:t.contractStatusFormData.contractOverDate,callback:function(e){t.$set(t.contractStatusFormData,"contractOverDate",e)},expression:"contractStatusFormData.contractOverDate"}})],1)],1):t._e(),t.contractOverStatusFlag?a("el-col",{staticClass:"formItem",staticStyle:{"margin-top":"20px"},attrs:{span:24}},[a("el-form-item",{attrs:{label:"合同终止原因",prop:"contractOverRemark"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",rows:3,resize:"none"},model:{value:t.contractStatusFormData.contractOverRemark,callback:function(e){t.$set(t.contractStatusFormData,"contractOverRemark",e)},expression:"contractStatusFormData.contractOverRemark"}})],1)],1):t._e()],1)],1)],1),a("div",{staticClass:"customerInfo"},[t._m(5),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contractCompanyRelationList,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号","min-width":"100px"}}),a("el-table-column",{attrs:{label:"公司名称","min-width":"400px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",filterable:"","remote-method":t.companyRemoteMethod,loading:t.companyLoading,"allow-create":"",placeholder:"请选择"},on:{focus:t.handleFocus,change:function(a){return t.companySelectChange(a,e.row)}},model:{value:e.row.clientCompanyId,callback:function(a){t.$set(e.row,"clientCompanyId",a)},expression:"scope.row.clientCompanyId"}},t._l(t.companyOptionList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.text,value:t.value,disabled:t.disabled}})})),1)]}}])}),a("el-table-column",{attrs:{label:"建档状态","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.documentStatus)+" ")]}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"blue",cursor:"pointer"},on:{click:function(a){return t.delCompany(e)}}},[t._v("删除")])]}}])})],1),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:t.addCompany}},[t._v("添加")])],1),a("div",{staticClass:"customerInfo"},[t._m(6),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.AgreeProvision,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号","min-width":"100px"}}),a("el-table-column",{attrs:{label:"条款名称","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"50"},model:{value:e.row.title,callback:function(a){t.$set(e.row,"title",a)},expression:"scope.row.title"}})]}}])}),a("el-table-column",{attrs:{label:"条款内容","min-width":"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",maxlength:"200","show-word-limit":"",rows:4,resize:"none"},model:{value:e.row.content,callback:function(a){t.$set(e.row,"content",a)},expression:"scope.row.content"}})]}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"blue",cursor:"pointer"},on:{click:function(a){return t.delTerm(e)}}},[t._v("删除")])]}}])})],1),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:t.addTerm}},[t._v("添加")])],1),a("div",{staticClass:"customerInfo"},[t._m(7),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.riskTipsList,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号","min-width":"100px"}}),a("el-table-column",{attrs:{label:"风险名称","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"50"},model:{value:e.row.title,callback:function(a){t.$set(e.row,"title",a)},expression:"scope.row.title"}})]}}])}),a("el-table-column",{attrs:{label:"风险内容","min-width":"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",maxlength:"200","show-word-limit":"",rows:4,resize:"none"},model:{value:e.row.content,callback:function(a){t.$set(e.row,"content",a)},expression:"scope.row.content"}})]}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"blue",cursor:"pointer"},on:{click:function(a){return t.delRisk(e)}}},[t._v("删除")])]}}])})],1),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:t.addRisk}},[t._v("添加")])],1),a("div",{staticClass:"customerInfo"},[t._m(8),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.uploadFileList,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号","min-width":"100px"}}),a("el-table-column",{attrs:{label:"合同附件类型","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{staticStyle:{width:"100%"},attrs:{remote:"",loading:t.companyLoading,placeholder:"请选择"},on:{change:function(a){return t.contractFileTypeChange(a,e.row)}},model:{value:e.row.contractFileType,callback:function(a){t.$set(e.row,"contractFileType",a)},expression:"scope.row.contractFileType"}},t._l(t.contractTypeList,(function(t){return a("el-option",{key:t.value,attrs:{disabled:t.disabled,label:t.text,value:t.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"适用公司","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:!0,placeholder:"请选择"},model:{value:e.row.relationIds,callback:function(a){t.$set(e.row,"relationIds",a)},expression:"scope.row.relationIds"}},t._l(t.contractCompanyList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"文件名","min-width":"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.fileName))]}}])}),a("el-table-column",{attrs:{label:"大小","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.fileSize))]}}])}),a("el-table-column",{attrs:{label:"上传时间","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.uploadTime))]}}])}),a("el-table-column",{attrs:{label:"上传人","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.createorName))]}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{color:"blue",cursor:"pointer"},on:{click:function(a){return t.previewContract(e)}}},[t._v("预览")]),a("span",{staticStyle:{color:"blue",cursor:"pointer","margin-left":"10px"},on:{click:function(a){return t.delFileContract(e)}}},[t._v("删除")])]}}])})],1),a("el-upload",{staticClass:"upload-demo is-error",attrs:{action:t.fileLoadUrl,headers:t.fileuploadHeader,"show-file-list":!1,name:"files",multiple:"","before-upload":t.beforeUpload,"on-success":t.uploadFileSuccess,"on-error":t.uploadFileError,limit:100}},[a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{size:"small",type:"primary"}},[t._v("上传合同附件")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 支持上文件格式pdf,doc,docx,xls,xslx,ppt,pptx,jpg,png,rar,zip，文件大小不超过20M. ")])],1)],1)]),a("zm-modal",{attrs:{title:"新增合同预览",openModal:t.openPreviewModal},on:{"update:openModal":function(e){t.openPreviewModal=e},"update:open-modal":function(e){t.openPreviewModal=e}}},[a("preview",{ref:"preview",attrs:{slot:"content",previewData:t.previewData,uploadFileList:t.uploadFileList},slot:"content"})],1),a("div",{staticClass:"submitForm"},[a("div",{staticClass:"close",on:{click:t.closePage}},[t._v("关闭")]),t.currentAdd?a("div",{staticClass:"preview",on:{click:t.saveDraft}},[t._v("暂存草稿")]):t._e(),a("div",{staticClass:"preview",on:{click:t.previewPage}},[t._v("预览")]),a("Debounce",{attrs:{time:5100}},[a("div",{staticClass:"submit",on:{click:t.submitForm}},[t._v("提交")])])],1),a("el-dialog",{attrs:{title:"获取暂存数据",visible:t.dialogTableVisible,width:"60%"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-table",{ref:"Table",attrs:{data:t.storageListData,height:"400px"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{width:"55",type:"selection"}}),a("el-table-column",{attrs:{prop:"itemObj.formData.contractContentType",label:"合同类型",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.getqueryLabelById(t.contractContentTypeList,e.row.itemObj.formData.contractContentType)))])]}}])}),a("el-table-column",{attrs:{prop:"itemObj.formData.contractName",label:"合同名称",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.itemObj.formData.contractName||"--"))])]}}])}),a("el-table-column",{attrs:{prop:"itemObj.formData.clientCompanyId",label:"客户名称",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.getqueryLabelById(t.companyOptionList,e.row.itemObj.formData.clientCompanyId)))])]}}])}),a("el-table-column",{attrs:{label:"合同起始日期",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(void 0==e.row.itemObj.formData.startEndDate?"--":e.row.itemObj.formData.startEndDate[0]))])]}}])}),a("el-table-column",{attrs:{prop:"mdeUpdatedDate",label:"更新时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s((e.row.mdeUpdatedDate||"").split("T")[0]))])]}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.selectmessage}},[t._v("确 定")])],1)],1)],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title",attrs:{id:"nav0"}},[a("span",[t._v("基本信息")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title",attrs:{id:"nav1"}},[a("span",[t._v("甲方信息")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title",attrs:{id:"nav2"}},[a("span",[t._v("乙方信息")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title",attrs:{id:"nav3"}},[a("span",[t._v("签订信息")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title",attrs:{id:"nav4"}},[a("span",[t._v("合同状态")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title",attrs:{id:"nav5"}},[a("span",[t._v("适用公司")]),a("span",{staticClass:"son"},[t._v("(选填)")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title",attrs:{id:"nav6"}},[a("span",[t._v("约束条款")]),a("span",{staticClass:"son"},[t._v("(选填)")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title",attrs:{id:"nav7"}},[a("span",[t._v("风险提示")]),a("span",{staticClass:"son"},[t._v("(选填)")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title",attrs:{id:"nav8"}},[a("span",[t._v("合同附件")]),a("span",{staticClass:"son"},[t._v("(必填)")]),a("div",{staticClass:"line"})])}],i=a("b85c"),s=a("2909"),o=a("5530"),c=a("1da1"),l=(a("d81d"),a("fb6a"),a("b680"),a("a9e3"),a("b0c0"),a("7db0"),a("159b"),a("4de4"),a("a15b"),a("ac1f"),a("1276"),a("99af"),a("a434"),a("a630"),a("3ca3"),a("d3b7"),a("6062"),a("ddb0"),a("96cf"),a("c91b")),u=a("bf3e"),p=a("f6b0"),d=a("8cc7"),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addCustomer-container"},[a("div",{staticClass:"navBar"},t._l(t.navList,(function(e,n){return a("div",{key:e,class:{current:t.navFlag===n},on:{click:function(e){return t.navChange(n)}}},[t._v(" "+t._s(e)+" ")])})),0),a("div",{staticClass:"form-wrap"},[a("div",{staticClass:"basicInfo"},[t._m(0),a("div",{staticClass:"basicForm"},[a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("合同编号")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.basicInfo.contractId||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("客户合同编号")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.basicInfo.clientContractId||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("合同名称")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.basicInfo.contractName||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("客户名称")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientCompanyName||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("合同类型")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.getTargetLabel("contractType",t.previewData.basicInfo.contractContentType)||"-- ")+" ")])]),"IT_CTCT_001"!=t.previewData.basicInfo.contractContentType?a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("项目名称")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.basicInfo.projectName||"--")+" ")])]):t._e(),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("合同开始日期")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.basicInfo.startEndDate&&(t.previewData.basicInfo.startEndDate[0]||"").split("T")[0]||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("合同结束日期")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.basicInfo.startEndDate&&(t.previewData.basicInfo.startEndDate[1]||"").split("T")[0]||"--")+" ")])]),"IT_CTCT_001"!=t.previewData.basicInfo.contractContentType?a("div",{staticClass:"item"},[a("div",{staticClass:"label"}),a("div",{staticClass:"value"},[t._v(" "+t._s((t.previewData.basicInfo.contractPrice||"")+t.getTargetLabel("contractCurrency",t.previewData.basicInfo.contractPriceCurrency)||"--")+" ")])]):t._e(),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("履约保证金")]),a("div",{staticClass:"value"},[t._v(" "+t._s((t.previewData.basicInfo.contractDeposit||"")+t.getTargetLabel("contractCurrency",t.previewData.basicInfo.contractDepositCurrency)||"--")+" ")])])])]),a("div",{staticClass:"formOneLine"},[a("div",{staticClass:"label"},[t._v("是否为续期")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.basicInfo.isRenewal?"已续期":"未续期")+" ")])]),a("div",{staticClass:"customerLevelInfo",staticStyle:{"margin-top":"30px"},attrs:{id:"customerLevelInfo"}},[t._m(1),a("div",{staticClass:"basicForm"},[a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("公司名称")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientAInfo.clientCompanyName)+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("联系人")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientAInfo.clientCompanyContactName||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("联系电话")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientAInfo.clientCompanyContactPhone||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("联系邮箱")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientAInfo.clientCompanyContactEmail||"--")+" ")])])]),a("div",{staticClass:"formOneLine"},[a("div",{staticClass:"label"},[t._v("公司注册地址")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientAInfo.registerAddressLabel||"--")+" ")])]),a("div",{staticClass:"formOneLine"},[a("div",{staticClass:"label"},[t._v("联系地址")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientAInfo.clientCompanyContactAddressLabel||"--")+" ")])])]),a("div",{staticClass:"customerLevelInfo",staticStyle:{"margin-top":"30px"},attrs:{id:"customerLevelInfo"}},[t._m(2),a("div",{staticClass:"basicForm"},[a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("公司名称")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientBInfo.tbCompanyName||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("联系人")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientBInfo.contactName||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("联系电话")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientBInfo.contactPhone||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("联系邮箱")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientBInfo.contactEmail||"--")+" ")])])]),a("div",{staticClass:"formOneLine"},[a("div",{staticClass:"label"},[t._v("公司注册地址")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientBInfo.registerAreaCode+t.previewData.clientBInfo.registerAddress||"--")+" ")])]),a("div",{staticClass:"formOneLine"},[a("div",{staticClass:"label"},[t._v("联系地址")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.clientBInfo.contactArea+t.previewData.clientBInfo.contactAddress||"--")+" ")])])]),a("div",{staticClass:"customerLevelInfo",staticStyle:{"margin-top":"30px"},attrs:{id:"customerLevelInfo"}},[t._m(3),a("div",{staticClass:"basicForm"},[a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("业务员")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.signInfo.signingUserName||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("签单日期")]),a("div",{staticClass:"value"},[t._v(" "+t._s((t.previewData.signInfo.signingDate||"").split("T")[0]||"--")+" ")])])]),a("div",{staticClass:"formOneLine"},[a("div",{staticClass:"label"},[t._v("签订地址")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.signInfo.signingAddressLabel||"--")+" ")])])]),a("div",{staticClass:"customerLevelInfo",staticStyle:{"margin-top":"30px"},attrs:{id:"customerLevelInfo"}},[t._m(4),a("div",{staticClass:"basicForm"},[a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("合同状态")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.getTargetLabel("contractStatus",t.previewData.contractStatus.contractStatus)||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("合同结束状态")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.getTargetLabel("contractOverStatus",t.previewData.contractStatus.contractOverStatus)||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("合同协议结束日期")]),a("div",{staticClass:"value"},[t._v(" "+t._s((t.previewData.contractStatus.contractOverDate||"").split("T")[0]||"--")+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"label"},[t._v("合同终止原因")]),a("div",{staticClass:"value"},[t._v(" "+t._s(t.previewData.contractStatus.contractOverRemark||"--")+" ")])])])]),a("div",{staticClass:"workplace",staticStyle:{"margin-top":"30px"}},[t._m(5),a("zm-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{tableData:t.companyTableData,columns:t.companyColumns,border:"",isShowPagenation:!1}})],1),a("div",{staticClass:"workplace",staticStyle:{"margin-top":"30px"}},[t._m(6),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.termTableData,border:"","header-cell-style":{color:"#333"}}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"180"}}),a("el-table-column",{attrs:{prop:"title",align:"center",label:"条款名称",width:"180"}}),a("el-table-column",{attrs:{prop:"content",label:"条款内容"}})],1)],1),a("div",{staticClass:"workplace",staticStyle:{"margin-top":"30px"}},[t._m(7),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.riskTableData,border:"","header-cell-style":{color:"#333"}}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"180"}}),a("el-table-column",{attrs:{prop:"title",align:"center",label:"风险名称",width:"180"}}),a("el-table-column",{attrs:{prop:"content",label:"风险内容"}})],1)],1),a("div",{staticClass:"workplace",staticStyle:{"margin-top":"30px"}},[t._m(8),a("div",{staticClass:"headerI",staticStyle:{"margin-top":"10px","font-size":"14px"}},[a("span",[t._v(" 主合同： "),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.previewData.mainContract))]),t._v("份 ")]),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(" 附加合同 "),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.previewData.additionalContract))]),t._v("份 ")])]),a("zm-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{tableData:t.contractTableData,columns:t.contractColumns,border:"",isShowPagenation:!1}})],1)]),a("zm-modal",{attrs:{title:"财务系统开发合同附件",openModal:t.contractModal}},[t._v("dfasdf")])],1)},f=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-item",attrs:{id:"nava0"}},[a("span",[t._v("基本信息")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-item",attrs:{id:"nava1"}},[a("span",[t._v("甲方信息")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-item",attrs:{id:"nava2"}},[a("span",[t._v("乙方信息")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-item",attrs:{id:"nava3"}},[a("span",[t._v("签订信息")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-item",attrs:{id:"nava4"}},[a("span",[t._v("合同状态")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-item",attrs:{id:"nava5"}},[a("span",[t._v("适用公司")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-item",attrs:{id:"nava6"}},[a("span",[t._v("约束条款")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-item",attrs:{id:"nava7"}},[a("span",[t._v("风险提示")]),a("div",{staticClass:"line"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-item",attrs:{id:"nava8"}},[a("span",[t._v("合同附件")]),a("div",{staticClass:"line"})])}],v=a("ed08"),C=a("4360"),b=C["a"].state.baseData.baseDataOptionList.IT_CPSC,h=C["a"].state.baseData.baseDataOptionList.IT_RISK,y=C["a"].state.baseData.baseDataOptionList.IT_FNLV,g=C["a"].state.baseData.baseDataOptionList.IT_COPT,_=C["a"].state.baseData.baseDataOptionList.IT_IDST,D=C["a"].state.baseData.baseDataOptionList.IT_IDSB,w=C["a"].state.baseData.baseDataOptionList.IT_CTCT,O=C["a"].state.baseData.baseDataOptionList.IT_CTST,T=C["a"].state.baseData.baseDataOptionList.IT_CTOV,I=C["a"].state.baseData.baseDataOptionList.IT_CURR,L=C["a"].state.baseData.baseDataOptionList.IT_CTFT,S=function(t){return[{label:"序号",type:"index",width:"120px"},{label:"风险名称",prop:"title",width:"220px"},{label:"风险内容",prop:"content",sortable:!0}]},x=function(t){return[{label:"序号",type:"index",width:"120px"},{label:"条款标题",prop:"title",width:"220px"},{label:"条款内容",prop:"content"}]},j=function(t){return[{label:"序号",type:"index",width:"120px"},{label:"公司名称",prop:"companyName",sortable:!0},{label:"建档状态",prop:"documentStatus",width:"120px"}]},k=function(t){return[{label:"合同附件类型",prop:"contractFileType",kind:"render",render:function(t,e){var a=Object(v["k"])(L,e.row.contractFileType);return t("span",a)}},{label:"适用公司",prop:"relationCompanyNames"},{label:"文件名",prop:"fileName"},{label:"大小",prop:"fileSize",width:"120px",kind:"render",render:function(t,e){return t("div",e.row.fileSize+"kb")}},{label:"上传时间",prop:"uploadTime"},{label:"上传人",prop:"createorName",width:"120px"},{label:"操作",kind:"render",render:function(e,a){return e("div",[e("span",{style:{color:"blue",cursor:"pointer",marginRight:"10px"},on:{click:function(){t.viewContract(a)}}},"预览"),e("span",{style:{color:"blue",cursor:"pointer"},on:{click:function(){t.downloadContract(a)}}},"下载")])}}]},F=function(t){return[{label:"结算岗位",prop:"group",sortable:!0},{label:"结算职级",prop:"city"},{label:"驻场模式",prop:"Big"},{label:"结算单位",prop:"small",width:"120px"},{label:"含税报价",prop:"cooperation",width:"120px",kind:"render",render:function(t,e){var a=e.row.cooperation||"-";return t("span",{style:{color:"blue",cursor:"pointer"},on:{click:function(){alert("事件触发")}}},a)}},{label:"不含税报价",prop:"xinzhi",width:"120px"}]},A=[{companyScale:Object(s["a"])(b)},{riskType:Object(s["a"])(h)},{financeType:Object(s["a"])(y)},{cooperationMode:Object(s["a"])(g)},{industryType:Object(s["a"])(_)},{industrySubType:Object(s["a"])(D)},{contractType:Object(s["a"])(w)},{contractStatus:Object(s["a"])(O)},{contractOverStatus:Object(s["a"])(T)},{contractCurrency:Object(s["a"])(I)}],N=a("35ad"),R=(a("a417"),{name:"detail",components:{zmTable:d["a"],zmModal:u["a"]},props:{previewData:{type:Object,default:function(){return{}}},uploadFileList:""},data:function(){var t=S(this),e=x(this),a=j(this),n=k(this),r=F(this);return{basicData:{},navList:["基本信息","甲方信息","乙方信息","签订信息","合同状态","适用公司","约束条款","风险提示","合同附件"],tbCompany:{},riskTableData:[],riskColumns:t,termTableData:[],termColumns:e,companyTableData:[],companyColumns:a,contractTableData:[],contractColumns:n,offerTableData:[],offerColumns:r,navFlag:0,signRadio:"",suitbleRadio:"",contractModal:!1,allSelectList:A,groupLabel:"",additionalContract:0,mainContract:0}},watch:{"previewData.uploadFileList":{deep:!0,handler:function(t){var e=this;t.forEach((function(t){t.uploadTime=(t.uploadTime||"").split("T")[0],"IT_CTFT_001"===t.contractFileType?e.mainContract++:e.additionalContract++}))}}},mounted:function(){this.setTableData()},methods:{setTableData:function(){var t=this;if(this.companyTableData=this.previewData.contractCompanyRelationList||[],this.uploadFileList[0]){this.uploadFileList[0].relationIds.forEach((function(e,a){void 0==e&&t.uploadFileList[0].relationIds.splice(a,1)}));this.uploadFileList[0].relationIds}this.termTableData=this.previewData.AgreeProvision||[],this.riskTableData=this.previewData.riskTipsList||[],this.contractTableData=this.previewData.uploadFileList||[],console.log("previewData",this.previewData),console.log("uploadFileList",this.uploadFileList)},navChange:function(t){this.navFlag=t;var e=document.querySelector("#nava".concat(t));e&&e.scrollIntoView()},getTargetLabel:function(t,e){var a=[];this.allSelectList.forEach((function(e){Object.prototype.hasOwnProperty.call(e,t)&&(a=e[t])}));var n="";return a.forEach((function(t){t.value===String(e)&&(n=t.text)})),n},viewContract:function(t){var e=t.row.fileId,a="https://www.tobowork.com//api/tobosoft-toms/cos/file/view/"+e;window.open(a)},downloadContract:function(t){var e=t.row.fileId,a="https://www.tobowork.com//api/tobosoft-toms/cos/file/download/"+e,n=document.createElement("a");n.setAttribute("download",t.row.fileName),n.href=a,document.body.appendChild(n),n.click(),n.remove()}}}),E=R,$=(a("3402"),a("2877")),P=Object($["a"])(E,m,f,!1,null,"6f03a550",null),B=P.exports,q=a("61f7"),M=function(t){return{contractContentType:{required:!0,message:"请选择合同类型",trigger:"change"},startEndDate:{required:!0,message:"请选择合同起始日期",trigger:"change"},contractValidMonth:{required:!0,message:"请选择合同有效期",trigger:"change"},projectName:{required:!0,message:"请输入项目名称",trigger:"blur"},clientCompanyId:{required:!0,message:"请选择客户名称",trigger:"change"},contractName:{required:!0,message:"请输入合同名称",trigger:"blur"},contractPrice:{required:t.isValidContractPrice,message:"请输入合同金额(数字)",trigger:"blur"},contractDeposit:{required:!1,trigger:"blur",message:"请输入履约保证金(数字)",validator:q["b"]}}},z=function(t){return[{span:12,list:[{type:"text",label:"公司名称",prop:"clientCompanyName",placeholder:"请输入"}]},{span:12,list:[{type:"text",label:"联系人",prop:"clientCompanyContactName",placeholder:"请输入"}]},{span:12,list:[{type:"text",label:"联系电话",prop:"clientCompanyContactPhone",maxlength:"16",placeholder:"请输入"}]},{span:12,list:[{type:"text",prop:"clientCompanyContactEmail",label:"联系邮箱",minRows:4}]},{span:12,list:[{type:"addressCascader",optionList:Object(v["i"])("cityTree"),label:"公司注册地址",prop:"clientCompanyRegisterArea",disabled:!0}]},{span:12,list:[{type:"text",labelWidth:"0px",label:"",prop:"clientCompanyRegisterAddress",placeholder:"请输入详细地址",disabled:!0}]},{span:12,list:[{type:"addressCascader",optionList:Object(v["i"])("cityTree"),label:"联系地址",prop:"clientCompanyContactArea"}]},{span:12,list:[{type:"text",labelWidth:"0px",label:"",prop:"clientCompanyContactAddress",placeholder:"请输入详细地址"}]}]},V={clientCompanyName:{required:!0,message:"请输入公司名称",trigger:"blur"},clientCompanyContactName:{required:!1,message:"请输入联系人",trigger:"blur"},clientCompanyContactPhone:{message:"请输入正确的电话号码",trigger:"blur",validator:q["w"]},clientCompanyContactEmail:{message:"请输入正确的邮箱",trigger:"blur",validator:q["h"]}},U={tbCompanyId:{required:!0,message:"请选择乙方客户",trigger:"change"},contactPhone:{message:"请输入正确的电话号码",trigger:"change",validator:q["w"]},contactEmail:{message:"请输入正确的邮箱",trigger:"change",validator:q["h"]}},J=function(t){return[{span:12,list:[{type:"text",label:"业务员",prop:"signingUserName",placeholder:"请输入"}]},{span:12,list:[{type:"date",label:"签单日期",prop:"signingDate",placeholder:"请输入",dateConfig:{disabledDate:function(t){return t.getTime()>Date.now()}}}]},{span:12,list:[{type:"addressCascader",optionList:Object(v["i"])("cityTree"),label:"签订地址",prop:"signingAddress"}]}]},W={signingUserName:{required:!0,message:"请选择签单人",trigger:"blur"},signingDate:{required:!0,message:"请输入详细的公司的地址",trigger:"change"},signingAddress:{required:!0,message:"请选择签单地址",trigger:"change"}},Y={contractStatus:{required:!0,message:"请选择合同终止状态",trigger:"change"},contractOverStatus:{required:!0,message:"请选择合同终止方式",trigger:"change"},contractOverRemark:{required:!0,message:"请输入合同终止原因",trigger:"blur"},contractOverDate:{required:!0,message:"请输入合同终止日期",trigger:"change"}},H=a("2f62"),Q={name:"addVCtrct",components:{zmForm:l["a"],zmTable:d["a"],zmModal:u["a"],preview:B},data:function(){var t=z(this),e=J(this),a=this.$store.state.baseData.baseDataOptionList.IT_CTOV,n=this.$store.state.baseData.baseDataOptionList.IT_CTST,r="https://www.tobowork.com/api/tobosoft-toms/strato/cloud/file/contract/toms-1255586777/upload";return{pickerOptions:{disabledDate:function(t){return!1}},navList:["基本信息","甲方信息","乙方信息","签订信息","合同状态","适用公司","约束条款","风险提示","合同附件"],navFlag:0,formData:{contractType:"IT_CTTP_002",priceCeiling:!1,contractDepositCurrency:"IT_CURR_001",contractPriceCurrency:"IT_CURR_001"},formConfig:[],formData2:{clientCompanyRegisterArea:"",clientCompanyName:"",clientCompanyContactName:"",clientCompanyContactPhone:"",clientCompanyRegisterAddress:"",clientCompanyContactArea:"",clientCompanyContactAddress:"",clientCompanyContactEmail:""},rules2:V,formConfig2:t,formData3:{tbCompanyId:"",contactName:"",contactPhone:"",contactEmail:"",contactArea:"",contactAddress:""},rules3:U,formConfig3:[],clienBSelectList:[],formData4:{},rules4:W,formConfig4:e,contractStatusFormData:{},contractStatusList:n,contractStatusFlag:!1,contractOverStatusList:a,contractOverStatusFlag:!1,contractStatusRules:Y,contractCompanyRelationList:[],companyOptionList:[],companyLoading:!1,AgreeProvision:[],riskTipsList:[],uploadFileList:[],contractTypeList:[],contractCompanyList:[],previousContractList:[],virtualContractList:[],agentContractList:[],clientCompanyId:"",virtualYesOrNo:"",agentStatus:"",noContract:!0,currentAdd:!0,fileuploadHeader:{},openPreviewModal:!1,previewData:{basicInfo:{},clientAInfo:{},clientBInfo:{},signInfo:{},contractStatus:{}},fileLoadUrl:r,selectOptionList:[],curCustomer:{},storageListData:[],dialogTableVisible:!1,contractContentTypeList:[],showMessage:{},changeClientCompanyId:[],companyOptionListAll:[],isValidContractPrice:!0}},mounted:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.contractContentTypeList=t.$store.state.baseData.baseDataOptionList.IT_CTCT,t.getBaseData(),e.next=4,t.isEditOrNew();case 4:return e.next=6,t.getClientCompanyListAll();case 6:t.$route.query.id||(t.formConfig=t.initBasicForm(!0)),t.initClientBInfo(),t.getRemoteSelectList(),t.disabledSelect(t.contractCompanyRelationList);case 10:case"end":return e.stop()}}),e)})))()},methods:Object(o["a"])(Object(o["a"])({},Object(H["d"])("listCacheFlag",["CHANGE_VC_STATUS"])),{},{getQueryClientCompanyListNoScope:function(t){var e=this,a={clientCompanyName:"",clientType:"IT_CLTP_001",clientCompanyIds:t};Object(N["p"])(a).then((function(t){e.companyOptionListAll=t&&t.map((function(t){return{text:t.clientCompanyName,value:t.clientCompanyId}})),e.companyOptionList=t&&t.map((function(t){return{text:t.clientCompanyName,value:t.clientCompanyId}})),e.ClientCompanyListAll=e.companyOptionList}))},remoteSelectBlur:function(){this.remoteMethod("")},getClientCompanyListAll:function(){var t=this,e={clientCompanyName:"",clientType:"IT_CLTP_001"};Object(N["c"])(e).then((function(e){t.companyOptionListAll=e&&e.map((function(t){return{text:t.clientCompanyName,value:t.clientCompanyId}})),t.companyOptionList=e&&e.map((function(t){return{text:t.clientCompanyName,value:t.clientCompanyId}})),t.ClientCompanyListAll=t.companyOptionList}))},initBasicForm:function(t){var e=this.$store.state.baseData.baseDataOptionList.IT_CTCT,a=this.$store.state.baseData.baseDataOptionList.IT_CTTP,n=this.$store.state.baseData.baseDataOptionList.IT_CURR,r=t,i=this.selectOptionList;return[{span:12,list:[{label:"虚拟合同编号",type:"text",prop:"contractId",placeholder:"无需填写，系统生成",disabled:!0}]},{span:12,list:[{type:"select",prop:"contractType",label:"合同种类",disabled:!0,optionList:a}]},{span:12,list:[{type:"select",prop:"contractContentType",label:"合同类型",optionList:e,changeFn:"contractSelectChange"}]},{span:12,list:[{label:"客户合同编号",type:"text",prop:"clientContractId",placeholder:"请输入客户合同编号",maxlength:"50"}]},{span:12,list:[{label:"合同名称",type:"text",prop:"contractName",placeholder:"请输入合同名称"}]},{span:12,list:[{label:"客户名称",type:"remoteSelect",prop:"clientCompanyId",placeholder:"请输入搜索关键字",remoteMethod:"remoteMethod",changeFn:"remoteSelectChange",blurFn:"remoteSelectBlur",selectOptionList:i}]},{span:12,list:[{type:"date",prop:"startEndDate",datePickerType:"daterange",label:"合同起始日期",placeholder:"请选择合同起始日期"}]},{span:12,list:[{type:"currencyInput",prop:"contractDeposit",label:"履约保证金",maxlength:"7",currencyProp:"contractDepositCurrency",optionList:n}]},{span:12,list:[{type:"text",prop:"projectName",label:"项目名称",placeholder:"请输入项目名称",hidden:r}]},{span:12,list:[{type:"currencyInputCheckbox",prop:"contractPrice",hidden:r,label:"合同金额",currencyProp:"contractPriceCurrency",optionList:n,checkboxName:"priceCeiling",regex:"ONLY_NUMBER"}]}]},uploadFileSuccess:function(t,e,a){var n=this.$store.state.user.userInfo.userName,r=t[0].uploadTime&&t[0].uploadTime.slice(0,t[0].uploadTime.indexOf("T"));this.uploadFileList.push({createorName:n,fileId:t[0].fileId,fileSize:(Number(t[0].fileSize)/1024).toFixed(2)+"kb",fileName:t[0].originName,uploadTime:r,filePath:t[0].filePath}),this.$message.success(e.name+"上传成功")},beforeUpload:function(t){if(this.uploadFileList.length>0&&!this.uploadFileList.find((function(t){return"IT_CTFT_001"===t.contractFileType})))return this.$message.warning("请先选择上传主合同，在进行选择附件合同！"),!1;var e=t.name.substring(t.name.lastIndexOf(".")+1),a="xls"===e,n="xlsx"===e,r="pdf"===e,i="doc"===e,s="docx"===e,o="ppt"===e,c="pptx"===e,l="jpg"===e,u="png"===e,p="rar"===e,d="zip"===e,m=t.size/1024/1024<20;return a||n||r||i||s||o||c||l||u||p||d||this.$message({message:"上传文件只能是 pdf,doc,docx,xls,xslx,ppt,pptx,jpg,png,rar,zip格式!",type:"warning"}),m||this.$message({message:"上传文件大小不能超过 20MB!",type:"warning"}),(a||n||r||i||s||o||c||l||u||p||d)&&m},uploadFileError:function(t,e){this.$message.error(e.name+"上传失败")},submitForm:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n,r,i,s,o,c,l,u,p,d,m,f,C,b,h,y;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.validateForm(),!a){e.next=75;break}return n=t.$route.query.id,r=JSON.parse(JSON.stringify(t.formData)),i={},i.endDate=r.startEndDate&&r.startEndDate[1],i.startDate=r.startEndDate&&r.startEndDate[0],i.contractName=r.contractName,i.contractContentType=r.contractContentType,i.clientCompanyId=r.clientCompanyId,i.contractType="IT_CTTP_002",r&&(i.contractId=n),e.next=14,Object(N["a"])(i);case 14:if(e.sent,s=!0,t.uploadFileList.forEach((function(e){e.contractFileType||(s=!1,t.$message.warning("合同附件类型不能够为空"))})),s){e.next=19;break}return e.abrupt("return");case 19:if(0!==t.uploadFileList.filter((function(t){return"IT_CTFT_001"===t.contractFileType})).length){e.next=22;break}return t.$message.warning("合同附件必须上传主合同！"),e.abrupt("return");case 22:if(o=Object(v["i"])("cityTree"),c=t.$route.query.id,l=!!t.$route.query.formalContractId,t.formData.isRenewal?t.formData.isRenewal="1":t.formData.isRenewal="0",u={},p=Object.assign({},t.formData,t.formData2,t.formData3,t.formData4,t.contractStatusFormData),c&&(p.contractId=c),l&&(p.contractId="",p.otherContractId=""),t.contractStatusFlag||(p.contractOverStatus="",p.contractOverDate="",p.contractOverRemark=""),p.proxyCompanyIds=p.proxyCompanyIds&&p.proxyCompanyIds.join(","),d=[],m=[],f=[],C=[],p.clientCompanyContactArea=p.clientCompanyContactArea?p.clientCompanyContactArea:[],p.clientCompanyContactArea.forEach((function(t){d.push(Object(v["b"])(o,t))})),p.clientCompanyContactArea=d.join(","),p.clientCompanyRegisterArea.forEach((function(t){m.push(Object(v["b"])(o,t))})),p.clientCompanyRegisterArea=m.join(","),p.signingAddress.forEach((function(t){f.push(Object(v["b"])(o,t))})),p.signingAddress=f.join(","),p.contactArea&&(p.contactArea.forEach((function(t){C.push(Object(v["b"])(o,t))})),p.contactArea=C.join(",")),delete p.signingAddressLabel,delete p.clientCompanyContactAreaLabel,p.endDate=p.startEndDate&&p.startEndDate[1],p.startDate=p.startEndDate&&p.startEndDate[0],delete p.startEndDate,p.tbCompanyId=t.formData3.tbCompanyId,p.contactName=t.formData3.contactName,p.contactPhone=t.formData3.contactPhone,p.contactEmail=t.formData3.contactEmail,b=t.contractCompanyRelationList.map((function(t){return{clientCompanyId:"已建档"===t.documentStatus?t.clientCompanyId:"",companyName:t.companyName,documentStatus:t.documentStatus}})),Array.isArray(p.contactAreaLabel)&&p.contactAreaLabel.length>0&&delete p.contactAreaLabel,Array.isArray(p.registerAreaCode)&&p.registerAreaCode.length>0&&delete p.registerAreaCode,p.contractDeposit&&(p.contractDeposit=Number(p.contractDeposit)),p.contractPrice&&(p.contractPrice=Number(p.contractPrice)),u={contract:p,contractCompanyRelationList:b,agreeProvisionList:t.AgreeProvision,riskTipsList:t.riskTipsList},t.uploadFileList.forEach((function(t){1===t.relationIds.length?t.relationIds=t.relationIds[0]:t.relationIds=t.relationIds&&t.relationIds.join(",")})),u.contractFileList=t.uploadFileList,h=null,!l){e.next=69;break}return u.oldContractId=t.$route.query.formalContractId,e.next=66,Object(N["A"])(u);case 66:h=e.sent,e.next=72;break;case 69:return e.next=71,Object(N["y"])(u);case 71:h=e.sent;case 72:h&&(y=t.$route,c?t.$message.success("编辑成功"):t.$message.success("新增成功"),t.CHANGE_VC_STATUS(!0),t.$store.dispatch("tagsView/delView",y).then((function(e){e.visitedViews;t.$router.push("/contract/virtualContract")}))),e.next=78;break;case 75:return t.$message.warning("请填写必填项或是正确填写非必填项"),t.$nextTick((function(){var t=document.getElementsByClassName("is-error");t&&t[0].scrollIntoView({block:"center",behavior:"smooth"})})),e.abrupt("return");case 78:case"end":return e.stop()}}),e)})))()},isEditOrNew:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n,r,i,s,c,l,u,p,d,m,f,C,b,h,y,g,_;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.$route.query.id,n=t.$route.query.formalContractId,!a&&!n){e.next=50;break}return n&&(a=n),t.currentAdd=!1,e.next=7,Object(N["d"])({contractId:a});case 7:r=e.sent,i=r.contract||{},t.clientCompanyId=i.clientCompanyId,t.getContractSelect(),t.formData={contractContentType:i.contractContentType,clientContractId:i.clientContractId,startEndDate:[i.startDate,i.endDate],projectName:i.projectName,contractType:n?"IT_CTTP_002":i.contractType,contractName:i.contractName,contractDeposit:i.contractDeposit,contractDepositCurrency:i.contractDepositCurrency,creditOde:i.creditOde,clientCompanyId:i.clientCompanyId,contractPrice:i.contractPrice,contractPriceCurrency:i.contractPriceCurrency,isRenewal:1==i.isRenewal,renewalCount:i.renewalCount,renewalYear:i.renewalYear,parentId:i.parentId,contractId:n?"":i.contractId,priceCeiling:"true"==i.priceCeiling},t.selectOptionList=[{text:i.clientCompanyName,value:i.clientCompanyId}],t.curCustomer={text:i.clientCompanyName,value:i.clientCompanyId},"IT_CTCT_001"!=i.contractContentType?t.formConfig=t.initBasicForm(!1):t.formConfig=t.initBasicForm(!0),s=Object(v["i"])("cityTree"),c=[],l=[],i.clientCompanyRegisterArea&&(c=i.clientCompanyRegisterArea.split(","),c.length>0&&c.forEach((function(t){var e=Object(v["f"])(s,t);l.push(e)}))),u=[],p=[],i.clientCompanyContactArea&&(u=i.clientCompanyContactArea.split(","),u.length>0&&u.forEach((function(t){var e=Object(v["f"])(s,t);p.push(e)}))),0==c.length&&(c=""),0==u.length&&(u=""),t.formData2={clientCompanyName:i.clientCompanyName,clientCompanyContactName:i.clientCompanyContactName,clientCompanyContactPhone:i.clientCompanyContactPhone,clientCompanyRegisterAddress:i.clientCompanyRegisterAddress,clientCompanyRegisterArea:l,clientCompanyContactArea:p,clientCompanyContactAddress:i.clientCompanyContactAddress,clientCompanyContactEmail:i.clientCompanyContactEmail},d=r.contract||{},m=r.tbCompany||{},f=[],C=[],m.registerAreaCode&&(f=m.registerAreaCode.split(","),f.length>0&&f.forEach((function(t){var e=Object(v["f"])(s,t);C.push(e)}))),b=[],h=[],d.contactArea&&(b=d.contactArea.split(","),b.length>0&&b.forEach((function(t){var e=Object(v["f"])(s,t);h.push(e)}))),t.formData3={tbCompanyId:d.tbCompanyId,contactName:i.contactName,contactPhone:i.contactPhone,registerAddress:m.registerAddress,registerAreaCode:C,contactArea:h,contactAddress:d.contactAddress,contactEmail:i.contactEmail},y=[],g=[],i.signingAddress&&(y=i.signingAddress.split(","),y.length>0&&y.forEach((function(t){var e=Object(v["f"])(s,t);g.push(e)}))),t.formData4={signingUserName:i.signingUserName,signingDate:i.signingDate,signingAddress:g},t.contractStatusFlag="IT_CTST_002"==i.contractStatus,t.contractOverStatusFlag="IT_CTST_002"==i.contractOverStatus,t.contractStatusFormData={contractStatus:i.contractStatus,contractOverStatus:i.contractOverStatus,contractOverDate:i.contractOverDate,contractOverRemark:i.contractOverRemark},t.AgreeProvision=r.agreeProvisionList||[],t.contractCompanyRelationList=r.contractCompanyRelationList||[],_=t.contractCompanyRelationList.map((function(t){return t.clientCompanyId})),_.length>0&&t.getQueryClientCompanyListNoScope(_),t.riskTipsList=r.riskTipsList||[],t.uploadFileList=r.contractFileList&&r.contractFileList.map((function(t){return Object(o["a"])({},t.contractFile)})),t.uploadFileList.forEach((function(t){t.relationIds=t.relationIds.split(","),t.uploadTime=t.uploadTime&&t.uploadTime.slice(0,t.uploadTime.indexOf("T"))})),e.next=52;break;case 50:return t.currentAdd=!0,e.abrupt("return","");case 52:case"end":return e.stop()}}),e)})))()},clientInputChange:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$route.query.id,n=JSON.parse(JSON.stringify(e.formData)),r={},r.endDate=n.startEndDate&&n.startEndDate[1],r.startDate=n.startEndDate&&n.startEndDate[0],r.contractName=n.contractName,r.contractContentType=n.contractContentType,r.clientCompanyId=n.clientCompanyId,r.contractType="IT_CTTP_002",a&&(r.contractId=a),t.next=12,Object(N["a"])(r);case 12:if(i=t.sent,i){t.next=18;break}if(!a){t.next=16;break}return t.abrupt("return");case 16:t.next=18;break;case 18:case"end":return t.stop()}}),t)})))()},validateForm:function(){var t="",e="",a="",n="",r="",i="",s="";return this.$refs["firstForm"].validate((function(t){e=!!t})),this.$refs["secondForm"].validate((function(t){a=!!t})),this.$refs["thirdForm"].validate((function(t){n=!!t})),this.$refs["fourthForm"].validate((function(t){r=!!t})),this.$refs["fivethForm"].validate((function(t){i=!!t})),s=this.uploadFileList.length>0,t=!!(this.noContract&&e&&a&&n&&r&&i&&s),t},remoteMethod:function(t){var e=this,a={input:{keyword:t,clientType:"IT_CLTP_001"}};Object(p["l"])(a).then((function(t){var a=t.result&&t.result.map((function(t){return{text:t.clientCompany&&t.clientCompany.clientCompanyName,value:t.clientCompany&&t.clientCompany.clientCompanyId,clientCompany:t.clientCompany}}));e.selectOptionList=a,"IT_CTCT_001"!=e.formData.contractContentType?e.formConfig=e.initBasicForm(!1):e.formConfig=e.initBasicForm(!0)}))},getRemoteSelectList:function(){this.remoteMethod(""),this.companyRemoteMethod("")},contractSelectChange:function(t){"IT_CTCT_001"!=t?this.formConfig=this.initBasicForm(!1):(this.formConfig=this.initBasicForm(!0),this.$set(this.formData,"contractPrice",0),this.$set(this.formData,"projectName","")),this.isValidContractPrice="IT_CTCT_003"!==t,this.validateContractInfo()},validateContractInfo:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n,r,i,s,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.formData,n=a.contractContentType,r=a.startEndDate,i=a.clientCompanyId,s=a.contractName,!(n&&r&&i&&s)){e.next=10;break}return o={contractContentType:n,startEndDate:r,clientCompanyId:i,contractName:s},o.endDate=o.startEndDate[1],o.startDate=o.startEndDate[0],delete o.startEndDate,e.next=8,Object(N["j"])(o);case 8:c=e.sent,c&&c.length>0?(t.$message.warning("后台有数据不能新增"),t.noContract=!1):t.noContract=!0;case 10:case"end":return e.stop()}}),e)})))()},handleContractStatusSelect:function(t){"IT_CTST_002"===t?(this.contractStatusFlag=!0,"IT_CTOV_002"!==this.contractStatusFormData.contractOverStatus&&"IT_CTOV_003"!==this.contractStatusFormData.contractOverStatus||(this.contractOverStatusFlag=!0)):(this.contractStatusFlag=!1,this.contractOverStatusFlag=!1)},handleContractStatusOverSelect:function(t){this.contractOverStatusFlag="IT_CTOV_002"==t||"IT_CTOV_003"==t},navChange:function(t){this.navFlag=t;var e=document.querySelector("#nav".concat(t));e&&e.scrollIntoView()},companyRemoteMethod:function(t){var e=this,a={clientCompanyName:t,clientType:"IT_CLTP_001"};Object(N["c"])(a).then((function(t){var a=t&&t.map((function(t){return{text:t.clientCompanyName,value:t.clientCompanyId}}));e.disabledSelect(a)}))},companySelectChange:function(t,e){JSON.parse(JSON.stringify(this.companyOptionListAll)),this.companyOptionList,this.contractCompanyRelationList;var a=this.companyOptionList.filter((function(e){return-1!=e.value.indexOf(t)}));if(a&&0===a.length)e.documentStatus="未建档",e.companyName=t;else{e.documentStatus="已建档";var n=this.companyOptionList.filter((function(e){return t===e.value}));e.companyName=n[0]&&n[0].text}},handleFocus:function(){this.disabledSelect(this.companyOptionListAll)},disabledSelect:function(t){var e=this,a=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(this.contractCompanyRelationList)),i=r.filter((function(t){return"未建档"==t.documentStatus}));i=i.map((function(t){return{text:t.companyName,value:t.clientCompanyId,disabled:!0}})),r=r.filter((function(t){return"已建档"==t.documentStatus}));r.map((function(t){return t.clientCompanyId}));var o=r.map((function(t){return{text:t.companyName,value:t.clientCompanyId,disabled:!0}})),c=[].concat(o);function l(t){if(0!=c.length){var e=c.shift();u(e,(function(e){n=e,l(t)}))}else t&&t(n)}function u(t,e){0==a.some((function(e){return e.value==t.value}))?Object(N["c"])({clientCompanyId:t.value}).then((function(t){var a=t.map((function(t){return{text:t.clientCompanyName,value:t.clientCompanyId,disabled:!0}}));n=[].concat(Object(s["a"])(n),Object(s["a"])(a)),e(n)})):(n=n.map((function(e){return t.value==e.value?t:e})),e(n))}l((function(t){var a;e.companyOptionList=t,(a=e.companyOptionList).push.apply(a,Object(s["a"])(i))}))},addCompany:function(){var t={companyName:""};this.contractCompanyRelationList.push(t),this.companyOptionList&&(this.companyOptionList=this.companyOptionList.concat(this.changeClientCompanyId)),this.contractCompanyRelationList&&2==this.contractCompanyRelationList.length&&"已建档"==this.contractCompanyRelationList[0].documentStatus&&this.disabledSelect(this.companyOptionListAll)},delCompany:function(t){var e=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t.$index;e.contractCompanyRelationList.splice(a,1);var n=t.row;e.companyOptionList.forEach((function(t){t.value==n.clientCompanyId&&(t.disabled=!1)}))}))},addTerm:function(){var t={title:"",content:""};this.AgreeProvision.push(t)},delTerm:function(t){var e=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t.$index;e.AgreeProvision.splice(a,1)}))},addRisk:function(){var t={title:"",content:""};this.riskTipsList.push(t)},delRisk:function(t){var e=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t.$index;e.riskTipsList.splice(a,1)}))},previewContract:function(t){var e=t.row.fileId,a="https://www.tobowork.com//api/tobosoft-toms/cos/file/view/"+e;window.open(a)},delFileContract:function(t){var e=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t.$index;e.uploadFileList.splice(a,1)}))},remoteSelectChange:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n,r,i,s,o,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=e.selectOptionList,r=Object(v["i"])("cityTree"),[],[],i=n&&n.filter((function(e){return e.value===t})),s=i[0]&&i[0].clientCompany,i[0]&&(e.curCustomer=i[0]),e.previewData.clientAInfo.registerAddressLabel=s.registerArea+s.registerAddress,e.clientCompanyId=s.clientCompanyId,e.getContractSelect(),e.formData2.clientCompanyName=s.clientCompanyName,o=[],c=[],s.registerArea&&(o=s.registerArea.split(","),o.length>0&&o.forEach((function(t){var e=Object(v["f"])(r,t);c.push(e)}))),e.formData2.clientCompanyRegisterArea=c,e.formData2.clientCompanyRegisterAddress=s.registerAddress;case 16:case"end":return a.stop()}}),a)})))()},partBSelectChange:function(t){var e=Object(v["i"])("cityTree"),a=this.clienBSelectList,n=a&&a.filter((function(e){return e.value===t})),r=n[0]||{};this.formData3.registerAddress=r.registerAddress;var i=[],s=[];r.registerAreaCode&&(i=r.registerAreaCode.split(","),i.length>0&&i.forEach((function(t){var a=Object(v["f"])(e,t);s.push(a)}))),this.formData3.registerAreaCode=s},getContractSelect:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(N["j"])({clientCompanyId:t.clientCompanyId});case 2:if(a=e.sent,n="",r="",0!==a){e.next=8;break}return t.$message.warning("当前客户没有合同"),e.abrupt("return");case 8:r=a.filter((function(t){return"IT_CTTP_001"===t.contractType})),t.previousContractList=r.map((function(t){var e=t.startDate&&t.startDate.slice(0,t.startDate.indexOf("T")),a=t.endDate&&t.endDate.slice(0,t.endDate.indexOf("T"));return{text:t.contractName+"-"+e+"-"+a,value:t.contractId}})),n=a.filter((function(t){return"IT_CTTP_002"===t.contractType})),t.virtualContractList=n.map((function(t){var e=t.startDate&&t.startDate.slice(0,t.startDate.indexOf("T")),a=t.endDate&&t.endDate.slice(0,t.endDate.indexOf("T"));return{text:t.contractName+"-"+e+"-"+a,value:t.contractId}}));case 12:case"end":return e.stop()}}),e)})))()},getBaseData:function(){this.contractTypeList=this.$store.state.baseData.baseDataOptionList.IT_CTFT},contractFileTypeChange:function(t,e){var a=this.uploadFileList||[];if(a.forEach((function(t){"IT_CTFT_001"===t.contractFileType&&!0})),"IT_CTFT_001"===t){var n=[];this.contractCompanyList=this.contractCompanyRelationList.map((function(t){return n.push(t.clientCompanyId),Object(o["a"])({text:t.companyName,value:t.clientCompanyId},t)})),this.contractCompanyList.push(this.curCustomer),n.push(this.curCustomer.value),e.relationIds=n}else{var r=[];this.contractCompanyList=this.contractCompanyRelationList.map((function(t){return r.push(t.clientCompanyId),Object(o["a"])({text:t.companyName,value:t.clientCompanyId},t)})),this.contractCompanyList.push(this.curCustomer)}},closePage:function(){var t=this,e=this.$route;this.$confirm("内容未保存, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$store.dispatch("tagsView/delView",e).then((function(e){e.visitedViews;t.$router.push("/contract/virtualContract")}))}))},saveDraft:function(){var t=this,e={formData:this.formData,formData2:this.formData2,formData4:this.formData4,contractStatusFormData:this.contractStatusFormData,contractCompanyRelationList:this.contractCompanyRelationList,AgreeProvision:this.AgreeProvision,riskTipsList:this.riskTipsList,uploadFileList:this.uploadFileList},a=JSON.stringify(e);Object(N["B"])({stagingTotail:a,stagingType:"contractId"}).then((function(e){t.$message({message:"暂存成功！",type:"success"})}))},getStorageDataShow:function(){this.getStorageDataList(),this.dialogTableVisible=!0},getStorageDataList:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(N["v"])({stagingType:"contractId"});case 2:a=e.sent,n=Object(i["a"])(a);try{for(n.s();!(r=n.n()).done;)s=r.value,s.itemObj=JSON.parse(s.stagingTotail)}catch(o){n.e(o)}finally{n.f()}t.storageListData=a;case 6:case"end":return e.stop()}}),e)})))()},handleSelectionChange:function(t){t.length>1?(this.$refs.Table.clearSelection(),this.$refs.Table.toggleRowSelection(t.pop())):this.showMessage=t},selectmessage:function(){if(null!=this.showMessage&&this.showMessage.length>0){this.dialogTableVisible=!1;var t=this.showMessage[0].itemObj;this.AgreeProvision=t.AgreeProvision,this.contractCompanyRelationList=t.contractCompanyRelationList,this.contractStatusFormData=t.contractStatusFormData,this.formData=t.formData,this.formData2=t.formData2,this.formData4=t.formData4,this.riskTipsList=t.riskTipsList,this.uploadFileList=t.uploadFileList}},getqueryLabelById:function(t,e){return Object(v["k"])(t,e)||"--"},previewPage:function(){var t=this,e=Object(v["i"])("cityTree"),a=this.clienBSelectList,n=(this.$route.query.id,[]),r=this.formData2.clientCompanyRegisterArea?this.formData2.clientCompanyRegisterArea:[];r.forEach((function(t){n.push(Object(v["b"])(e,t))})),this.previewData.clientAInfo.registerAddressLabel=n.join(",");var s=[],o=this.formData2.clientCompanyContactArea?this.formData2.clientCompanyContactArea:[];o.forEach((function(t){s.push(Object(v["b"])(e,t))})),this.previewData.clientAInfo.clientCompanyContactAddressLabel=s.join(",");var c={},l=a.filter((function(e){return e.value==t.formData3.tbCompanyId}));c.tbCompanyName=l[0]?l[0].text:"",c.contactName=this.formData3.contactName,c.contactPhone=this.formData3.contactPhone,c.contactEmail=this.formData3.contactEmail;var u=[],p=this.formData3.registerAreaCode?this.formData3.registerAreaCode:[];p.forEach((function(t){u.push(Object(v["b"])(e,t))})),c.registerAreaCode=u.join(",");var d=[],m=this.formData3.contactArea?this.formData3.contactArea:[];m.forEach((function(t){d.push(Object(v["b"])(e,t))})),c.contactArea=d.join(","),c.registerAddress=void 0==this.formData3.registerAddress?"":this.formData3.registerAddress,c.contactAddress=this.formData3.contactAddress,this.previewData.clientBInfo=c,this.previewData.selectOptionList=this.selectOptionList;var f,C=Object(i["a"])(this.uploadFileList);try{for(C.s();!(f=C.n()).done;){var b=f.value;b.names=[];var h,y=Object(i["a"])(b.relationIds);try{for(y.s();!(h=y.n()).done;){var g=h.value;/.*[\u4e00-\u9fa5]+.*$/.test(g)&&b.names.push(g)}}catch(w){y.e(w)}finally{y.f()}}}catch(w){C.e(w)}finally{C.f()}this._queryRelationCompanies(this.uploadFileList,(function(){var e=t.contractStatusFormData;"IT_CTST_001"==e.contractStatus&&(e.contractOverDate="",e.contractOverRemark="",e.contractOverStatus=""),"IT_CTOV_001"===e.contractOverStatus&&(e.contractOverDate="",e.contractOverRemark=""),t.previewData.signInfo=t.formData4,t.previewData.contractStatus=e,t.previewData.contractCompanyRelationList=t.contractCompanyRelationList,t.previewData.AgreeProvision=t.AgreeProvision,t.previewData.riskTipsList=t.riskTipsList,t.previewData.uploadFileList=t.uploadFileList;var a=t.recalc(t.uploadFileList),n=a.mainContract,r=a.additionalContract;t.previewData.mainContract=n,t.previewData.additionalContract=r,t.openPreviewModal=!0,t.previewData.basicInfo=t.formData,t.previewData.clientAInfo=Object.assign({},t.previewData.clientAInfo,t.formData2)}));var _=[],D=this.formData4.signingAddress?this.formData4.signingAddress:[];D.forEach((function(t){_.push(Object(v["b"])(e,t))})),this.previewData.signInfo.signingAddressLabel=_.join(","),this.previewData.selectOptionList=this.selectOptionList,this.previewData.curCustomer=this.curCustomer,this.selectOptionList&&this.selectOptionList.forEach((function(e){t.previewData.basicInfo.clientCompanyId==e.value&&(t.previewData.clientCompanyName=e.text)})),this.$refs.preview&&this.$refs.preview.setTableData()},_queryRelationCompanies:function(t,e){var a=this;t=t||[],t.forEach(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r,s,o,c,l,u,p,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.relationIds||[],r=[],n.forEach((function(t){t&&""!=t&&r.push(t)})),s=[],t.next=6,Object(N["k"])(r);case 6:o=t.sent,o&&o.forEach((function(t){s.push(t.clientCompany.clientSimpleName)})),a.$set(e,"relationCompanies",o),a.$set(e,"relationCompanyNames",s.join(",")),c=Object(i["a"])(a.uploadFileList);try{for(c.s();!(l=c.n()).done;)u=l.value,p=[],void 0!=u.relationCompanyNames&&(-1!=u.relationCompanyNames.indexOf(",")?p=u.relationCompanyNames.split(","):p.push(u.relationCompanyNames),p=u.names.concat(p),d=[],d=a.uniqueArr(p),u.relationCompanyNames=d.join(","))}catch(m){c.e(m)}finally{c.f()}case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e&&e()},uniqueArr:function(t){return Array.from(new Set(t))},recalc:function(t){var e=0,a=0;return t.forEach((function(t){t.uploadTime=(t.uploadTime||"").split("T")[0],"IT_CTFT_001"===t.contractFileType?e++:a++})),{mainContract:e,additionalContract:a}},initClientBInfo:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(N["l"])({condition:{}});case 2:a=e.sent,n=a&&a.result.map((function(t){return Object(o["a"])({text:t.tbCompanyName,value:t.tbCompanyId},t)})),t.clienBSelectList=n,t.formConfig3=[{span:12,list:[{type:"select",label:"公司名称",prop:"tbCompanyId",placeholder:"请选择",optionList:n,changeFn:"partBSelectChange"}]},{span:12,list:[{type:"text",label:"联系人",prop:"contactName",placeholder:"请输入联系人"}]},{span:12,list:[{type:"text",label:"联系电话",prop:"contactPhone",maxlength:"16",placeholder:"请输入联系电话"}]},{span:12,list:[{type:"text",prop:"contactEmail",label:"联系邮箱",minRows:4,placeholder:"请输入联系邮箱"}]},{span:12,list:[{type:"addressCascader",optionList:Object(v["i"])("cityTree"),label:"公司注册地址",prop:"registerAreaCode",placeholder:"请选择",disabled:!0}]},{span:12,list:[{type:"text",labelWidth:"0px",label:"",prop:"registerAddress",placeholder:"请输入详细地址",disabled:!0}]},{span:12,list:[{type:"addressCascader",optionList:Object(v["i"])("cityTree"),label:"联系地址",prop:"contactArea",placeholder:"请选择"}]},{span:12,list:[{type:"text",labelWidth:"0px",label:"",prop:"contactAddress",placeholder:"请输入详细地址"}]}],t.partBSelectChange("AB6D9EB193BC000");case 6:case"end":return e.stop()}}),e)})))()}}),computed:{fileCompany:function(){return this.contractCompanyRelationList},rules:function(){return M(this)}},watch:{contractCompanyRelationList:{deep:!0,handler:function(t,e){this.contractCompanyList=t.map((function(t){return Object(o["a"])({text:t.companyName,value:t.clientCompanyId},t)}))}},curCustomer:{deep:!0,handler:function(t){var e=this.contractCompanyList.filter((function(e){return e.value===t.value}));0===e.length&&this.contractCompanyList.push(t)}},$route:function(){},"formData.startEndDate":{deep:!0,handler:function(t){t&&(this.pickerOptions.disabledDate=function(e){var a=new Date(t[0]).valueOf(),n=new Date(t[1]).valueOf();return e.getTime()<a||e.getTime()>n})}}}},K=Q,G=(a("9a54"),Object($["a"])(K,n,r,!1,null,"36bbc6b7",null));e["default"]=G.exports},bb2f:function(t,e,a){var n=a("d039");t.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},f183:function(t,e,a){var n=a("d012"),r=a("861d"),i=a("5135"),s=a("9bf2").f,o=a("90e3"),c=a("bb2f"),l=o("meta"),u=0,p=Object.isExtensible||function(){return!0},d=function(t){s(t,l,{value:{objectID:"O"+ ++u,weakData:{}}})},m=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,l)){if(!p(t))return"F";if(!e)return"E";d(t)}return t[l].objectID},f=function(t,e){if(!i(t,l)){if(!p(t))return!0;if(!e)return!1;d(t)}return t[l].weakData},v=function(t){return c&&C.REQUIRED&&p(t)&&!i(t,l)&&d(t),t},C=t.exports={REQUIRED:!1,fastKey:m,getWeakData:f,onFreeze:v};n[l]=!0},f6b0:function(t,e,a){"use strict";a.d(e,"l",(function(){return r})),a.d(e,"k",(function(){return i})),a.d(e,"a",(function(){return s})),a.d(e,"g",(function(){return o})),a.d(e,"m",(function(){return c})),a.d(e,"n",(function(){return l})),a.d(e,"b",(function(){return u})),a.d(e,"o",(function(){return p})),a.d(e,"p",(function(){return d})),a.d(e,"d",(function(){return m})),a.d(e,"w",(function(){return f})),a.d(e,"e",(function(){return v})),a.d(e,"t",(function(){return C})),a.d(e,"c",(function(){return b})),a.d(e,"h",(function(){return h})),a.d(e,"f",(function(){return y})),a.d(e,"s",(function(){return g})),a.d(e,"r",(function(){return _})),a.d(e,"v",(function(){return D})),a.d(e,"x",(function(){return w})),a.d(e,"j",(function(){return O})),a.d(e,"u",(function(){return T})),a.d(e,"q",(function(){return I}));var n=a("b775");function r(t){return Object(n["a"])({url:"/business/client/queryClientCompanyList",method:"post",data:t})}function i(t){return Object(n["a"])({url:"/business/client/queryClientCompanyInfo",method:"post",params:t})}function s(t){return Object(n["a"])({url:"/business/client/saveOrUpdateClientCompany",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/business/client/removeClientCompany",method:"post",params:t})}function c(t){return Object(n["a"])({url:"/business/contract/queryContractListByClientId",method:"post",params:t})}function l(t){return Object(n["a"])({url:"/business/contract/queryContractCompanyListByClientId",method:"post",params:t})}function u(t){return Object(n["a"])({url:"/business/client/checkReClientCompanyInfo",method:"post",data:t})}function p(t){return Object(n["a"])({url:"/business/client/queryClientCompanyWorkplaceListByClientCompanyId",method:"post",params:t})}function d(t){return Object(n["a"])({url:"/business/scope/queryClientOrgList",method:"post",data:t})}function m(t){return Object(n["a"])({url:"/business/scope/createClientOrg",method:"post",data:t})}function f(t){return Object(n["a"])({url:"/business/scope/updateClientOrg",method:"post",data:t})}function v(t){return Object(n["a"])({url:"/business/scope/createContractOrg",method:"post",data:t})}function C(t){return Object(n["a"])({url:"/business/scope/queryContractOrgListById",method:"post",params:t})}function b(t){return Object(n["a"])({url:"/business/scope/closeClientOrg",method:"post",params:t})}function h(t){return Object(n["a"])({url:"/business/scope/deleteContractOrg",method:"post",params:t})}function y(t){return Object(n["a"])({url:"/business/scope/deleteClientOrg",method:"post",params:t})}function g(t){return Object(n["a"])({url:"/business/scope/queryContractOrgList",method:"post",data:t})}function _(t){return Object(n["a"])({url:"/business/clientlevel/queryClientTwoLevelList",method:"post",data:t})}function D(t){return Object(n["a"])({url:"/business/clientlevel/save",method:"post",data:t})}function w(t){return Object(n["a"])({url:"/business/clientlevel/update",method:"post",data:t})}function O(t){return Object(n["a"])({url:"/business/clientlevel/detail",method:"post",data:t})}function T(t){return Object(n["a"])({url:"/business/clientlevel/remove",method:"post",data:t})}function I(t){return Object(n["a"])({url:"/business/clientlevel/queryClientTwoLevelBySelect",method:"post",data:t})}}}]);