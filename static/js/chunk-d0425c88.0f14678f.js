(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d0425c88"],{"03e6":function(t,e,n){"use strict";n("210b")},"131e":function(t,e,n){},"210b":function(t,e,n){},"2a67":function(t,e,n){"use strict";n("9418")},"306c":function(t,e,n){"use strict";n("9be2")},"35ad":function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"k",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"y",(function(){return s})),n.d(e,"A",(function(){return l})),n.d(e,"d",(function(){return c})),n.d(e,"j",(function(){return u})),n.d(e,"l",(function(){return d})),n.d(e,"c",(function(){return m})),n.d(e,"p",(function(){return p})),n.d(e,"z",(function(){return f})),n.d(e,"x",(function(){return g})),n.d(e,"e",(function(){return h})),n.d(e,"h",(function(){return b})),n.d(e,"w",(function(){return y})),n.d(e,"a",(function(){return v})),n.d(e,"v",(function(){return C})),n.d(e,"B",(function(){return I})),n.d(e,"r",(function(){return O})),n.d(e,"q",(function(){return w})),n.d(e,"s",(function(){return S})),n.d(e,"i",(function(){return D})),n.d(e,"u",(function(){return _})),n.d(e,"o",(function(){return L})),n.d(e,"n",(function(){return k})),n.d(e,"t",(function(){return x})),n.d(e,"g",(function(){return j})),n.d(e,"m",(function(){return T}));var a=n("b775");function r(t){return Object(a["a"])({url:"/business/contract/queryContractList",method:"post",data:t})}function i(t){return Object(a["a"])({url:"/business/client/queryClientCompanyInfos",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/business/contract/deleteContract",method:"post",params:t})}function s(t){return Object(a["a"])({url:"/business/contract/saveOrUpdate",method:"post",data:t})}function l(t){return Object(a["a"])({url:"/business/contract/saveOrUpdateRelation",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/business/contract/queryContractInfo",method:"post",params:t})}function u(t){return Object(a["a"])({url:"/business/contract/queryContractSelectList",method:"post",data:t})}function d(t){return Object(a["a"])({url:"/commons/basedata/queryCompanyList",method:"post",data:t})}function m(t){return Object(a["a"])({url:"/business/client/queryAllClientCompanySelectList",method:"post",data:t})}function p(t){return Object(a["a"])({url:"/business/client/queryClientCompanyListNoScope",method:"post",data:t})}function f(t){return Object(a["a"])({url:"/business/contract/saveContractPrice",method:"post",data:t})}function g(t){return Object(a["a"])({url:"/business/contract/addContractAndVirtualRelation",method:"post",data:t})}function h(t){return Object(a["a"])({url:"/business/contract/queryContractFileList",method:"post",params:t})}function b(t){return Object(a["a"])({url:"/business/contract/queryContractPrice",method:"post",params:t})}function y(t){return Object(a["a"])({url:"/business/contract/queryTMContractPrice",method:"post",params:t})}function v(t){return Object(a["a"])({url:"/business/contract/checkContractInfo",method:"post",data:t})}function C(t){return Object(a["a"])({url:"/business/contract/queryStagingList",method:"post",data:t})}function I(t){return Object(a["a"])({url:"/business/contract/saveOrupdateStaging",method:"post",data:t})}function O(t){return Object(a["a"])({url:"/business/contract/queryContractPriceDimension",method:"post",params:t})}function w(t){return Object(a["a"])({url:"/business/contract/queryContractSelectListByLike",method:"post",params:t})}function S(t){return Object(a["a"])({url:"/business/contract/queryContractPriceResult",method:"post",params:t})}function D(t){return Object(a["a"])({url:"/salary/salaryLineSet/queryForStation",method:"post",data:t})}function _(t){return Object(a["a"])({url:"/salary/salaryLineSet/queryForLevel",method:"post",data:t})}function L(t){return Object(a["a"])({url:"/salary/salaryLineSet/querForPirce",method:"post",data:t})}function k(t){return Object(a["a"])({url:"/salary/salaryLineSet/querForDetail",method:"post",data:t})}function x(t){return Object(a["a"])({url:"/business/contract/queryContractSelectByOrgIdANDClientCompanyId",method:"post",params:t})}function j(t){return Object(a["a"])({url:"/business/contract/getContractPrice",method:"post",params:t})}function T(t){return Object(a["a"])({url:"/business/contract/queryContractPriceVersionList/".concat(t),method:"post"})}},"5e0c":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.queryClientListData,"label-width":"120px"},on:{close:t.closeRest}},[n("el-form-item",{attrs:{label:"客户简称"}},[n("el-input",{attrs:{clearable:"",placeholder:"客户简称"},model:{value:t.queryClientListData.clientOrg.clientCompanyName,callback:function(e){t.$set(t.queryClientListData.clientOrg,"clientCompanyName",e)},expression:"queryClientListData.clientOrg.clientCompanyName"}})],1),n("el-form-item",{attrs:{label:"所属交付组织"}},[n("el-cascader",{attrs:{options:t.orgTreeData[0].children,props:{expandTrigger:"hover",checkStrictly:!0,label:"orgName",value:"orgId"},clearable:"",placeholder:"请选择"},model:{value:t.orgIdArr,callback:function(e){t.orgIdArr=e},expression:"orgIdArr"}})],1),n("el-form-item",{attrs:{label:"客户商务人员"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入工号或姓名","remote-method":t.remoteMethod},model:{value:t.queryClientListData.clientOrg.businessUserIds,callback:function(e){t.$set(t.queryClientListData.clientOrg,"businessUserIds",e)},expression:"queryClientListData.clientOrg.businessUserIds"}},t._l(t.optionList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)],1),n("el-form-item",{attrs:{label:"交付管理人员"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入工号或姓名","remote-method":t.remoteMethod},model:{value:t.queryClientListData.clientOrg.deliverUserIds,callback:function(e){t.$set(t.queryClientListData.clientOrg,"deliverUserIds",e)},expression:"queryClientListData.clientOrg.deliverUserIds"}},t._l(t.optionList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)],1),n("el-form-item",{attrs:{label:"是否已授权"}},[n("el-select",{attrs:{clearable:""},model:{value:t.queryClientListData.clientOrg.isAuth,callback:function(e){t.$set(t.queryClientListData.clientOrg,"isAuth",e)},expression:"queryClientListData.clientOrg.isAuth"}},t._l(t.yesOrNoList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)],1),n("div",{staticClass:"right-btn"},[n("el-button",{directives:[{name:"has",rawName:"v-has",value:"client.belong.add",expression:"'client.belong.add'"}],staticClass:"but-91",on:{click:t.newlyAdded}},[t._v("新增")]),n("el-button",{staticClass:"but-91",on:{click:t.emptyBtn}},[t._v("重置")]),n("el-button",{directives:[{name:"has",rawName:"v-has",value:"client.belong.list",expression:"'client.belong.list'"}],staticClass:"but-91",on:{click:t.baseList}},[t._v("查询")])],1)],1),n("div",{staticClass:"tableContent"},[n("el-table",{ref:"tableRef",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:t.listData,size:"medium","header-cell-style":{background:"#fff",textAlign:"center",color:"#333"}},on:{"sort-change":t.onSortChange}},[n("el-table-column",{attrs:{type:"index",label:"序号",width:"80",align:"center",index:t.indexMethod}}),n("el-table-column",{attrs:{label:"客户简称",width:"190",align:"left"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("zm-tooltip",{attrs:{content:t.row.clientOrg.clientSimpleName,refName:"supplierName"}})]}}])}),n("el-table-column",{attrs:{label:"所属交付组织",sortable:"custom",prop:"orgName",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.clientOrg.orgName))])]}}])}),n("el-table-column",{attrs:{label:"客户商务人员",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("zm-tooltip",{attrs:{content:t.getBusinessName(e.row.businessUserList),refName:"supplierName"}})]}}])}),n("el-table-column",{attrs:{label:"交付管理人员",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("zm-tooltip",{attrs:{content:t.getBusinessName(e.row.deliverUserList),refName:"supplierName"}})]}}])}),n("el-table-column",{attrs:{label:"是否已授权",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s("TRUE"==e.row.clientOrg.isAuth?"是":"否"))])]}}])}),n("el-table-column",{attrs:{label:"操作",fixed:"right",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{directives:[{name:"has",rawName:"v-has",value:"client.belong.edit",expression:"'client.belong.edit'"}],staticClass:"customBtn",attrs:{size:"medium"},on:{click:function(n){return t.editBtn(e.row)}}},[t._v("编辑")]),n("el-dropdown",{attrs:{vhas:"'authorization.client.auth,authorization.client.delete'"},on:{command:t.handleCommand}},[n("span",{directives:[{name:"has",rawName:"v-has",value:"client.belong.auth,client.belong.infoauth,client.belong.delete",expression:"'client.belong.auth,client.belong.infoauth,client.belong.delete'"}],staticClass:"customBtn",staticStyle:{"margin-left":"10px"},attrs:{size:"medium",type:"primary"}},[t._v(" 更多 "),n("i",{staticClass:"el-icon-caret-bottom"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{directives:[{name:"has",rawName:"v-has",value:"client.belong.auth",expression:"'client.belong.auth'"}],attrs:{command:t.beforeHandleCommand(e.row,"a")}},[t._v("授权")]),n("el-dropdown-item",{directives:[{name:"has",rawName:"v-has",value:"client.belong.infoauth",expression:"'client.belong.infoauth'"}],attrs:{command:t.beforeHandleCommand(e.row,"b")}},[t._v("查看授权")]),n("el-dropdown-item",{directives:[{name:"has",rawName:"v-has",value:"client.belong.delete",expression:"'client.belong.delete'"}],attrs:{command:t.beforeHandleCommand(e.row,"c")}},[t._v("删除")])],1)],1)]}}])})],1)],1),n("div",{staticClass:"pagination-min"},[n("el-pagination",{attrs:{"current-page":t.pagePa.pageIndex,"page-sizes":[15,30,50],"page-size":t.pagePa.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.pagePa.rowCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pagePa,"pageIndex",e)},"update:current-page":function(e){return t.$set(t.pagePa,"pageIndex",e)},"update:pageSize":function(e){return t.$set(t.pagePa,"pageSize",e)},"update:page-size":function(e){return t.$set(t.pagePa,"pageSize",e)}}})],1),n("submit-modal",{ref:"submitModal",attrs:{relationList:t.orgTreeData[0].children,isShowSubmitModal:t.dialogVisible,title:t.dialogTitle,submitInfo:t.formData,rules:t.rulesDialog,debounceFlag:t.debounceFlag},on:{"update:isShowSubmitModal":function(e){t.dialogVisible=e},"update:is-show-submit-modal":function(e){t.dialogVisible=e},customEventName:t.preserveBtn}}),n("empower-modal",{attrs:{isShowEmpowerModal:t.empowerVisible,submitInfo:t.empowerFormData,cityListData:t.cityListData,contractOrgList:t.contractOrgListData,clientCompanyId:t.clientCompanyId},on:{"update:isShowEmpowerModal":function(e){t.empowerVisible=e},"update:is-show-empower-modal":function(e){t.empowerVisible=e},"update:contractOrgList":function(e){t.contractOrgListData=e},"update:contract-org-list":function(e){t.contractOrgListData=e},initialEmpowerList:t.initialEmpowerListData,empowerUpdate:t.empowerUpdate}}),n("details-modal",{attrs:{isShowDetailsEmpowerModal:t.detailsModalVisible,contractOrgList:t.contractOrgListData,clientCompanyName:t.empowerClientCompanyName},on:{"update:isShowDetailsEmpowerModal":function(e){t.detailsModalVisible=e},"update:is-show-details-empower-modal":function(e){t.detailsModalVisible=e}}}),n("zm-message",{attrs:{isShowMessage:t.messageVisible,messageBtn:t.messageBtnTwo,content:t.messageContent},on:{"update:isShowMessage":function(e){t.messageVisible=e},"update:is-show-message":function(e){t.messageVisible=e},click:t.determineClick}})],1)},r=[],i=n("1da1"),o=n("5530"),s=(n("96cf"),n("a434"),n("d81d"),n("99af"),n("159b"),n("a15b"),n("d3b7"),n("4de4"),n("25f0"),n("fb6a"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"submitModal"},[n("el-dialog",{staticStyle:{"margin-top":"100px"},attrs:{title:t.title,visible:t.isShowSubmitModal,width:"50%","close-on-click-modal":!1},on:{close:function(e){return t.handleCancel("submitInfo")}}},[n("div",{staticClass:"submit-container"},[n("el-form",{ref:"submitInfo",staticClass:"dialogForm",attrs:{model:t.submitInfo,"label-width":"110px",rules:t.rulesNewForm}},[n("div",{staticClass:"top-content"},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"客户名称",prop:"clientCompanyId"}},[n("el-select",{staticClass:"inpWidth",attrs:{filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":t.remoteMethod},on:{change:t.getClientSimpleName},model:{value:t.submitInfo.clientCompanyId,callback:function(e){t.$set(t.submitInfo,"clientCompanyId",e)},expression:"submitInfo.clientCompanyId"}},t._l(t.clientCompanySelectList,(function(t){return n("el-option",{key:t.clientCompanyId,attrs:{label:t.clientCompanyName,value:t.clientCompanyId}})})),1)],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"所属交付组织",prop:"orgId"}},[n("el-cascader",{staticClass:"inpWidth",attrs:{options:t.orgTreeData[0].children,"show-all-levels":!0,props:{expandTrigger:"hover",checkStrictly:!0,label:"orgName",value:"orgId"},placeholder:"请选择"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data;return[n("span",[t._v(t._s(a.orgName))])]}}]),model:{value:t.submitInfo.orgId,callback:function(e){t.$set(t.submitInfo,"orgId",e)},expression:"submitInfo.orgId"}})],1)],1)],1),n("div",{staticClass:"bottom-content"},[n("el-row",[n("el-col",{attrs:{span:12}},[n("div",{staticClass:"item"},[n("div",{staticClass:"label"},[n("div",{staticClass:"title"},[n("span",{staticStyle:{color:"#F56C6C"}},[t._v("* ")]),t._v("客户商务人员 ")])]),n("div",{staticClass:"value",staticStyle:{overflow:"auto",height:"100px"}},[0===t.submitInfo.businessUserIds.length?n("div",{staticClass:"tip",staticStyle:{"font-size":"12px",color:"#ccc"}}):t._e(),t._l(t.submitInfo.businessUserIds,(function(e,a){return n("el-tag",{key:e.assignName,staticStyle:{"margin-right":"10px","margin-bottom":"10px"},attrs:{closable:""},on:{close:function(e){return t.closeApproval(a)}}},[t._v(" "+t._s(e.assignName)+" ")])}))],2),n("div",{staticClass:"operation"},[n("div",{staticClass:"first"},[n("i",{staticClass:"iconfont icon-B",on:{click:t.openApprovalModal}})]),n("div",{staticClass:"last"},[n("i",{staticClass:"iconfont icon-shanchurenyuan",on:{click:t.deleteAllApproval}})])])])]),n("el-col",{attrs:{span:12}},[n("div",{staticClass:"item",staticStyle:{"border-top":"none"}},[n("div",{staticClass:"label"},[n("div",{staticClass:"title"},[t._v("交付管理人员")])]),n("div",{staticClass:"value",staticStyle:{overflow:"auto",height:"100px"}},[0===t.submitInfo.deliverUserIds.length?n("div",{staticClass:"tip",staticStyle:{"font-size":"12px",color:"#ccc"}}):t._l(t.submitInfo.deliverUserIds,(function(e,a){return n("el-tag",{key:e.assignName,staticStyle:{"margin-right":"10px","margin-bottom":"10px"},attrs:{closable:""},on:{close:function(e){return t.closeCcPeople(a)}}},[t._v(" "+t._s(e.assignName)+" ")])}))],2),n("div",{staticClass:"operation"},[n("div",{staticClass:"first"},[n("i",{staticClass:"iconfont icon-B",on:{click:t.openCcPeopleModal}})]),n("div",{staticClass:"last"},[n("i",{staticClass:"iconfont icon-shanchurenyuan",on:{click:t.deleteAllCcPeople}})])])])])],1)],1)])],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.handleCancel}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.handleSubmit("submitInfo")}}},[t._v("确 定")])],1),n("cc-people-modal",{key:t.addApproveModalKeyFlag,attrs:{isShowCcModal:t.isShowAddModal,"append-to-body":"",isQueryUser:!0},on:{"update:isShowCcModal":function(e){t.isShowAddModal=e},"update:is-show-cc-modal":function(e){t.isShowAddModal=e},handleConfirm:t.addApproval}}),n("cc-people-modal",{key:t.addCcPeopleModalKeyFlag,attrs:{isShowCcModal:t.isShowCcModal,"append-to-body":"",isQueryUser:!0},on:{"update:isShowCcModal":function(e){t.isShowCcModal=e},"update:is-show-cc-modal":function(e){t.isShowCcModal=e},handleConfirm:t.addCcPeople}})],1)],1)}),l=[],c=n("ade3"),u=n("b85c"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ccContainer"},[n("el-dialog",t._b({attrs:{title:"选择人员",visible:t.isShowCcModal,width:"25%","destroy-on-close":!0,"close-on-click-modal":!1},on:{close:t.handleCancel}},"el-dialog",t.$attrs,!1),[n("el-form",{ref:"ruleForm",attrs:{model:t.employForm,rules:t.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"姓名",prop:"employId"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",clearable:"","reserve-keyword":"",placeholder:"请输入工号或姓名","remote-method":t.remoteMethod},on:{change:t.handleSelectChange},model:{value:t.employForm.employId,callback:function(e){t.$set(t.employForm,"employId",e)},expression:"employForm.employId"}},t._l(t.optionList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)],1),n("el-form-item",{attrs:{label:"所属组织"}},[n("el-input",{attrs:{placeholder:"请选择",disabled:""},model:{value:t.currentOrg,callback:function(e){t.currentOrg=e},expression:"currentOrg"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.handleCancel}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确 定")])],1)],1)],1)},m=[],p=n("a417"),f=n("ed08"),g=n("2f62"),h={name:"CcPeopleModal",props:{isShowCcModal:{type:Boolean,default:!1},customEventName:{type:String,default:"handleConfirm"},isQueryUser:{type:Boolean,default:!1}},data:function(){return{optionList:[],rules:{employId:{message:"请输入员工姓名",required:!0,trriger:"change"}},employForm:{employId:""},orgTreeData:[],currentOrg:"",selectedItemData:{},oneDimensionArr:[]}},computed:{},watch:{},mounted:function(){this.registerCloseEvent(),this.getOrgTreeList(),this.queryUser({keyword:""}),this.queryOrgListData()},methods:{queryOrgListData:function(){var t=this;Object(p["z"])({}).then((function(e){e&&(t.orgTreeData=e)}))},handleSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(e){e&&(t.$emit(t.customEventName,t.selectedItemData),t.$emit("update:isShowCcModal",!1))}))},handleCancel:function(){this.$refs.ruleForm.resetFields(),this.$refs.ruleForm.clearValidate(),this.$emit("update:isShowCcModal",!1)},remoteMethod:function(t){if(this.isQueryUser){var e={keyword:t};this.queryUser(e)}else;},queryUser:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(p["L"])(t);case 2:a=n.sent,e.optionList=Array.isArray(a)&&a.map((function(t){var e={};return e=Object.assign(e,t,t.userInfo),Object(o["a"])({text:"[".concat(t.userInfo.loginName,"] ").concat(t.userInfo.userName),value:t.userInfo.userId},e)}));case 4:case"end":return n.stop()}}),n)})))()},handleSelectChange:function(t){var e=this;this.optionList.forEach((function(n){if(n.value===t)if(e.selectedItemData=n,console.log("this.selectedItemData",e.selectedItemData),e.isQueryUser){var a=e.queryItemById(n.orgId,e.orgTreeData);if(a.parentId){var r=e.getAllParentOrgId(a.parentId,e.oneDimensionArr).reverse();r.push(a.orgName),e.currentOrg=r.join("/"),e.selectedItemData.orgFullName=e.currentOrg}else e.currentOrg=a.orgName}else e.currentOrg=n.orgCn}))},registerCloseEvent:function(){var t=this,e=document.querySelector(".ccContainer .el-dialog__close");e&&e.addEventListener("click",(function(){t.handleCancel()}))},getOrgTreeList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.oneDimensionArr=t.toOneDimensionArr(Object(f["a"])(t.orgTreeData));case 1:case"end":return e.stop()}}),e)})))()},queryItemById:function(t,e){var n=null;function a(e){e.forEach((function(e){if(t===e.orgId)return n=e;e.children&&e.children.length>0&&a(e.children)}))}return a(e),n},toOneDimensionArr:function(t){var e=[];Object(f["a"])(t);function n(t){t.forEach((function(t){e.push(t),t.children&&t.children.length>0&&(n(t.children),delete t.children)}))}return n(t),e},getAllParentOrgId:function(t,e){var n=[];function a(t,e){e.forEach((function(r){t===r.orgId&&t===r.orgId&&(n.push(r.orgName),a(r.parentId,e))}))}return a(t,e),n}}},b=h,y=n("2877"),v=Object(y["a"])(b,d,m,!1,null,"053c044e",null),C=v.exports,I=Object(c["a"])({name:"SubmitModal",components:{ccPeopleModal:C},props:{isShowSubmitModal:{type:Boolean,default:!1},title:{type:String,default:"默认标题"},rules:{type:Object,default:function(){return{}}},relationList:{type:Array,default:[]},submitInfo:{type:Object,default:function(){return{}}},debounceFlag:{type:Boolean,default:!0}},data:function(){return{isShowAddModal:!1,isShowCcModal:!1,addApproveModalKeyFlag:0,addCcPeopleModalKeyFlag:100,clientCompanySelectList:[],rulesNewForm:{clientCompanyId:[{required:!0,message:"请选择客户名称",trigger:"change"}],orgId:[{required:!0,message:"请选择所属交付组织",trigger:"change"}]}}},computed:Object(o["a"])({},Object(g["e"])("baseData",["orgTreeData"])),watch:{},mounted:function(){var t=this;Object(p["m"])({clientType:"IT_CLTP_001"}).then((function(e){e&&e.length>0&&(t.clientCompanySelectList=e,console.log(t.clientCompanySelectList))})),this.registerCloseEvent()},methods:{remoteMethod:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a={clientCompanyName:t,clientType:"IT_CLTP_001"},n.next=3,Object(p["m"])(a).then((function(t){e.clientCompanySelectList=t||[]}));case 3:case"end":return n.stop()}}),n)})))()},getClientSimpleName:function(){var t=this;this.clientCompanySelectList.forEach((function(e){e.clientCompanyId==t.submitInfo.clientCompanyId&&(t.submitInfo.clientCompanyName=e.clientCompanyName,t.submitInfo.clientSimpleName=e.clientSimpleName)}))},handleSubmit:function(t){var e=this;this.debounceFlag&&this.$refs[t].validate((function(t){t&&(console.log(e.submitInfo.businessUserIds),e.submitInfo.businessUserIds.length>0?e.$emit("customEventName"):e.$message.error("客户商务人员不能为空"))}))},openApprovalModal:function(){this.isShowAddModal=!0,this.addApproveModalKeyFlag+=1},openCcPeopleModal:function(){this.isShowCcModal=!0,this.addCcPeopleModalKeyFlag+=1},addApproval:function(t){var e=this.submitInfo.businessUserIds.filter((function(e){return e.assignName===t.text}));if(e.length>0)this.$message.warning("客户商务人已添加，请勿重复提交！");else{var n={assignId:t.value,assignName:t.text,assignType:this.submitInfo.assignType,runType:"IT_RUNX_003"};this.submitInfo.businessUserIds.push(n)}},addCcPeople:function(t){var e=this.submitInfo.deliverUserIds.filter((function(e){return e.assignName===t.text}));if(e.length>0)this.$message.warning("交付管理人已添加，请勿重复提交！");else{var n={assignId:t.value,assignName:t.text,assignType:this.submitInfo.assignType,runType:"IT_RUNX_002"};this.submitInfo.deliverUserIds.push(n)}},closeApproval:function(t){this.submitInfo.businessUserIds.splice(t,1)},closeCcPeople:function(t){this.submitInfo.deliverUserIds.splice(t,1)},deleteAllApproval:function(){var t=this;this.$confirm("请确认是否要清除全部客户商务人员?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.submitInfo.businessUserIds=[]}))},deleteAllCcPeople:function(){var t=this;this.$confirm("请确认是否要清除全部交付管理人员?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.submitInfo.deliverUserIds=[]}))},handleCancel:function(){this.$emit("update:isShowSubmitModal",!1)},registerCloseEvent:function(){var t=this,e=document.querySelector(".submitModal .el-dialog__close");e&&e.addEventListener("click",(function(){t.handleCancel()}))}}},"watch",{submitInfo:{handler:function(t,e){var n,a=!1,r=Object(u["a"])(this.clientCompanySelectList);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.clientCompanyId==t.clientCompanyId){a=!1;break}a=!0}}catch(o){r.e(o)}finally{r.f()}a&&""!=this.submitInfo.clientCompanyId&&this.clientCompanySelectList.push({clientCompanyId:this.submitInfo.clientCompanyId,clientCompanyName:this.submitInfo.clientCompanyName})},deep:!0}}),O=I,w=(n("75b2"),Object(y["a"])(O,s,l,!1,null,"eb2843d4",null)),S=w.exports,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"empowerModal"},[n("el-dialog",{staticStyle:{"margin-top":"0px"},attrs:{title:"客户合同授权",visible:t.isShowEmpowerModal,width:"60%","close-on-click-modal":!1},on:{close:t.handleCancel}},[n("div",{staticClass:"submit-container"},[n("el-form",{ref:"submitInfo",staticClass:"demo-submitInfo",attrs:{model:t.submitInfo,rules:t.rulesInfo,"label-width":"130px"}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"所属客户"}},[n("el-input",{staticClass:"inpWidth",attrs:{value:t.submitInfo.clientCompanyName,disabled:!0}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"所属客户合同",prop:"contractId"}},[n("el-select",{staticClass:"inpWidth",attrs:{filterable:"",remote:"","remote-method":t.remoteMethod,clearable:"",placeholder:"请输入搜索关键字"},on:{change:t.getContractType},model:{value:t.submitInfo.contractId,callback:function(e){t.$set(t.submitInfo,"contractId",e)},expression:"submitInfo.contractId"}},t._l(t.contractListSelect,(function(t){return n("el-option",{key:t.contractId,attrs:{label:t.contractName,value:t.contractId}})})),1)],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"合同类型"}},[n("el-input",{staticClass:"inpWidth",attrs:{value:t.submitInfo.contractContentType,disabled:!0}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"合同有效期"}},[n("el-input",{staticClass:"inpWidth",attrs:{value:t.contractValidMonthDate,disabled:!0}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"被授权组织",prop:"orgId"}},[n("el-cascader",{staticClass:"inpWidth",attrs:{options:t.orgTreeData[0].children,props:{expandTrigger:"hover",label:"orgName",value:"orgId"},clearable:"",placeholder:"请选择"},model:{value:t.submitInfo.orgId,callback:function(e){t.$set(t.submitInfo,"orgId",e)},expression:"submitInfo.orgId"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"授权范围",prop:"scope"}},[n("el-radio-group",{model:{value:t.submitInfo.scope,callback:function(e){t.$set(t.submitInfo,"scope",e)},expression:"submitInfo.scope"}},[n("el-radio",{attrs:{label:"TRUE"}},[t._v("合同")]),n("el-radio",{attrs:{label:"FALSE"}},[t._v("仅合同报价")])],1),n("el-tooltip",{staticClass:"item",staticStyle:{"margin-left":"10px"},attrs:{effect:"dark",placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[t._v("1、合同，被授权组织可以查询授权合同的所有信息。"),n("br"),t._v("2、仅合同报价，被授权组织仅和查看被授权城市的合同报价信息。")]),n("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"16px"}})])],1)],1),"FALSE"==t.submitInfo.scope?n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"是否按城市授权",prop:"isCity"}},[n("el-select",{staticClass:"inpWidth",attrs:{clearable:"",placeholder:"请选择"},model:{value:t.submitInfo.isCity,callback:function(e){t.$set(t.submitInfo,"isCity",e)},expression:"submitInfo.isCity"}},[n("el-option",{attrs:{label:"是",value:"TRUE"}}),n("el-option",{attrs:{label:"否",value:"FALSE"}})],1)],1)],1):t._e(),"FALSE"==t.submitInfo.scope&&"TRUE"==t.submitInfo.isCity?n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"授权城市",prop:"region"}},[n("el-select",{staticClass:"inpWidth",attrs:{filterable:"",multiple:"",placeholder:"请选择"},model:{value:t.submitInfo.citys,callback:function(e){t.$set(t.submitInfo,"citys",e)},expression:"submitInfo.citys"}},t._l(t.cityListData,(function(t){return n("el-option",{key:t.regionId,attrs:{label:t.regionName,value:t.regionId}})})),1)],1)],1):t._e()],1)],1),n("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subBtn("submitInfo")}}},[t._v("确 定")])],1),n("div",{staticClass:"tables"},[n("h3",{staticStyle:{"font-size":"16px",color:"#333"}},[t._v("已授权信息")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contractOrgList,"header-cell-style":{background:"#f3f9ff",color:"#333"},border:""}},[n("el-table-column",{attrs:{label:"序号",type:"index",align:"center",width:"50"}}),n("el-table-column",{attrs:{align:"center",label:"所属客户合同"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.contractName))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"授权开始日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.validStartDate?e.row.contractOrg.validStartDate.split("T")[0]:"--"))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"授权终止日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.validEndDate?e.row.contractOrg.validEndDate.split("T")[0]:"--"))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"被授权组织"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.orgCn))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"授权范围"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.scope?"TRUE"==e.row.contractOrg.scope?"合同":"仅合同报价":"--"))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"授权城市"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.citys||"--"))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"取消授权原因"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.remark||"--"))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return["IT_SQZT_001"==e.row.contractOrg.status?n("span",{staticStyle:{color:"#078bfd",cursor:"pointer"},on:{click:function(n){return t.openEmpowerTip(e.row)}}},[t._v("取消授权")]):n("span",{staticStyle:{color:"#078bfd",cursor:"pointer"},on:{click:function(n){return t.deleteEmpowerTip(e.row)}}},[t._v("删除")])]}}])})],1),n("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.handleCancel}},[t._v("关 闭")])],1)],1)],1)]),n("el-dialog",{attrs:{title:"取消授权",visible:t.dialogFormVisible,width:"26%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("div",{staticClass:"dialogFormBox"},[n("h3",[n("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"24px","margin-right":"10px",color:"#fe9400"}}),n("span",[t._v(" 是否取消此合同的授权信息？")])]),n("div",{staticClass:"item-min"},[n("div",{staticClass:"item"},[n("div",{staticClass:"label"},[t._v("授权合同")]),n("div",{staticClass:"value"},[t._v(" "+t._s(t.currentEmpowerObj.contractName||"--")+" ")])]),n("div",{staticClass:"item"},[n("div",{staticClass:"label"},[t._v("被授权组织")]),n("div",{staticClass:"value"},[t._v(t._s(t.currentEmpowerObj.orgCn))])])]),n("el-form",{ref:"fefForm",staticStyle:{"margin-top":"8px"},attrs:{model:t.formTermination,rules:t.formTerminationRules,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"授权终止日期",prop:"validEndDate"}},[n("el-date-picker",{staticClass:"inpWidth",attrs:{type:"date","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,placeholder:"选择日期"},model:{value:t.formTermination.validEndDate,callback:function(e){t.$set(t.formTermination,"validEndDate",e)},expression:"formTermination.validEndDate"}})],1),n("el-form-item",{attrs:{label:"授权终止原因",prop:"remark"}},[n("el-input",{staticClass:"inpWidth",attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.formTermination.remark,callback:function(e){t.$set(t.formTermination,"remark",e)},expression:"formTermination.remark"}})],1)],1),n("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitTerminationBtn("fefForm")}}},[t._v("确 定")])],1)],1)])],1)},_=[],L=(n("ac1f"),n("1276"),n("f6b0")),k=n("35ad"),x=n("e55b"),j=n("4360"),T=j["a"].state.baseData.baseDataOptionList.IT_CTCT,N=(j["a"].state.baseData.baseDataOptionList.IT_SQZT,j["a"].state.baseData.orgTreeData[0].children),M={components:{},props:{isShowEmpowerModal:{type:Boolean,default:!1},contractOrgList:{type:Array,default:[]},cityListData:{type:Array,default:[]},submitInfo:{type:Object,default:function(){return{}}},clientCompanyId:{type:String,default:function(){return""}}},data:function(){return{formTermination:{relationId:"",validEndDate:"",remark:""},pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},rulesInfo:{contractId:[{required:!0,message:"请选择客户合同",trigger:"change"}],orgId:[{required:!0,message:"请选择被授权组织",trigger:"change"}],scope:[{required:!0,message:"请选择授权范围",trigger:"change"}],isCity:[{required:!0,message:"请选择城市授权",trigger:"change"}]},formTerminationRules:{validEndDate:[{required:!0,message:"请选择授权终止日期",trigger:"change"}],remark:[{required:!0,message:"请输入授权终止原因",trigger:"change"}]},currentEmpowerObj:{},dialogFormVisible:!1,isShowAddModal:!1,isShowCcModal:!1,addApproveModalKeyFlag:0,addCcPeopleModalKeyFlag:100,clientCompanySelectList:[],contractListSelect:[],contractValidMonthDate:""}},computed:Object(o["a"])({},Object(g["e"])("baseData",["orgTreeData"])),watch:{isShowEmpowerModal:function(t,e){var n=this;t&&this.getContractSelectData(),this.$nextTick((function(){n.contractValidMonthDate="",n.$refs.submitInfo.resetFields()}))}},mounted:function(){},methods:{getOrgName:function(t){if(!t)return"--";var e=Object(x["c"])(t),n=[];return e.forEach((function(t){n.push(Object(f["m"])(N,t,"orgId","orgName"))})),n=this.trimSpace(n),n=n.join("/"),n},trimSpace:function(t){for(var e=0;e<t.length;e++)""!=t[e]&&null!=t[e]&&"undefined"!=typeof t[e]||(t.splice(e,1),e-=1);return t},remoteMethod:function(t){this.getContractSelectData(t)},getContractSelectData:function(){var t=arguments,e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t.length>0&&void 0!==t[0]?t[0]:"",r={like:a,clientCompanyId:e.submitInfo.clientCompanyId},n.next=4,Object(k["q"])(r);case 4:i=n.sent,e.contractListSelect=i||[];case 6:case"end":return n.stop()}}),n)})))()},getContractType:function(t){if(void 0!=t&&""!=t){var e=this.getName(t,this.contractListSelect),n=null==e.contractContentType?"":e.contractContentType,a=Object(f["k"])(T,n);this.submitInfo.contractContentType=a;var r=(e.startDate?e.startDate:"--").split("T")[0],i=(e.endDate?e.endDate:"--").split("T")[0];this.submitInfo.contractName=e.contractName,this.contractValidMonthDate=r+" — "+i,this.submitInfo.contractStartDate=r,this.submitInfo.contractEndDate=i}},getName:function(t,e){return e.filter((function(e){return e.contractId==t}))[0]},subBtn:function(t){var e=this;this.$refs[t].validate((function(t){if(t){var n=JSON.parse(JSON.stringify(e.submitInfo));e.$emit("empowerUpdate",n)}}))},openEmpowerTip:function(t){this.currentEmpowerObj=t.contractOrg,this.formTermination={relationId:t.contractOrg.relationId,validEndDate:"",remark:""},this.dialogFormVisible=!0,this.$refs.fefForm&&this.$refs.fefForm.resetFields()},handleCancel:function(){this.$emit("update:isShowEmpowerModal",!1)},submitTerminationBtn:function(t){var e=this;this.$refs[t].validate((function(t){t&&Object(L["c"])(e.formTermination).then((function(t){e.$message({message:"提交成功",type:"success"}),e.dialogFormVisible=!1,e.$emit("initialEmpowerList",e.submitInfo.clientCompanyId)}))}))},deleteEmpowerTip:function(t){var e=this;e.$confirm("删除此授权信息可能会影响到被授权组织的员工入职定薪的成本计算，以及与薪酬、结算和绩效统计的数据且将记录此次删除人和操作和信息，请谨慎操作","确认提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(L["h"])({id:t.contractOrg.relationId}).then((function(t){e.$message({type:"success",message:"删除成功!"}),e.$emit("initialEmpowerList",e.submitInfo.clientCompanyId)}),(function(t){e.$message({type:"error",message:"删除失败!"})}))}))}}},E=M,q=(n("306c"),Object(y["a"])(E,D,_,!1,null,"8fdaeef6",null)),U=q.exports,A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"detailsModal"},[n("el-dialog",{staticStyle:{"margin-top":"0px"},attrs:{title:"已授权信息",visible:t.isShowDetailsEmpowerModal,width:"60%","close-on-click-modal":!1},on:{close:t.handleCancel}},[n("div",{staticClass:"tables"},[n("div",{staticClass:"detailsModalTitle"},[n("div",{staticClass:"label"},[t._v("所属客户")]),n("div",{staticClass:"text"},[t._v(t._s(t.clientCompanyName))])]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contractOrgList,"header-cell-style":{background:"#f3f9ff",textAlign:"center",color:"#333"},border:""}},[n("el-table-column",{attrs:{label:"序号",type:"index",align:"center",width:"50"}}),n("el-table-column",{attrs:{label:"所属客户合同"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.contractName))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"授权开始日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.validStartDate?e.row.contractOrg.validStartDate.split("T")[0]:"--"))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"授权终止日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.validEndDate?e.row.contractOrg.validEndDate.split("T")[0]:"--"))])]}}])}),n("el-table-column",{attrs:{label:"被授权组织"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t.getOrgName(e.row.contractOrg.orgId)))])]}}])}),n("el-table-column",{attrs:{label:"授权范围"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.scope?"TRUE"==e.row.contractOrg.scope?"合同":"仅合同报价":"--"))])]}}])}),n("el-table-column",{attrs:{label:"授权城市"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.citys||"--"))])]}}])}),n("el-table-column",{attrs:{label:"取消授权原因"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.contractOrg.remark||"--"))])]}}])})],1),n("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.handleCancel}},[t._v("关 闭")])],1)],1)])],1)},$=[],F=j["a"].state.baseData.orgTreeData[0].children,B={components:{},props:{isShowDetailsEmpowerModal:{type:Boolean,default:!1},contractOrgList:{type:Array,default:[]},clientCompanyName:{type:String,default:""}},data:function(){return{}},watch:{},mounted:function(){},methods:{getOrgName:function(t){if(!t)return"--";var e=Object(x["c"])(t),n=[];return e.forEach((function(t){n.push(Object(f["m"])(F,t,"orgId","orgName"))})),n=this.trimSpace(n),n=n.join("/"),n},trimSpace:function(t){for(var e=0;e<t.length;e++)""!=t[e]&&null!=t[e]&&"undefined"!=typeof t[e]||(t.splice(e,1),e-=1);return t},handleCancel:function(){this.$emit("update:isShowDetailsEmpowerModal",!1)}}},R=B,P=(n("03e6"),Object(y["a"])(R,A,$,!1,null,"f41a9e88",null)),V=P.exports,z=n("8952"),W=n("99f2"),K=(n("61f7"),n("5f98"),j["a"].state.baseData.orgTreeData[0].children,{name:"CustomerEmpower",components:{submitModal:S,empowerModal:U,detailsModal:V,zmTooltip:z["a"],zmMessage:W["a"]},props:{},data:function(){return{yesOrNoList:[{text:"全部",value:""},{text:"是",value:"true"},{text:"否",value:"false"}],messageBtnTwo:!0,messageContent:{subTitle:"确认提示",mainTitle:"是否确定删除此客户授权数据吗？",contentText:"删除此授权客户可能会影响关于此客户的所有的人事流程和信息以及薪酬和结算计算等所有的数据，且将记录此次删除人和操作和信息，请谨慎操作。"},rulesDialog:{clientCompanyId:[{equired:!0,message:"请选择客户名称",trigger:"change"}],name:[{required:!0,message:"请输入活动名称",trigger:"change"}]},queryClientListData:{clientOrg:{businessUserIds:"",clientCompanyId:"",clientCompanyName:"",clientOrgRelationId:"",deliverUserIds:"",isAuth:"",mdeUpdatedBy:"",mdeUpdatedDate:"",orgId:"",orgName:""},displayVos:[]},orgIdArr:[],dialogTitle:"新增客户所属",dialogVisible:!1,empowerVisible:!1,detailsModalVisible:!1,messageVisible:!1,empowerClientCompanyName:"",clientOrgRelationId:"",cityListData:[],listData:[],optionList:[],contractOrgListData:[],formData:{businessUserIds:[],deliverUserIds:[],clientCompanyId:"",clientCompanyName:"",clientOrgRelationId:"",isAuth:"",mdeUpdatedBy:"",mdeUpdatedDate:"",orgId:[],orgName:""},currentListObj:{},empowerFormData:{citys:"",clientCompanyId:"",clientCompanyName:"",clientOrgRelationId:"",contractContentType:"",contractEndDate:"",contractId:"",contractName:"",contractStartDate:"",isCity:"",orgCn:"",orgId:"",relationId:"",remark:"",scope:"",status:"",validEndDate:"",validStartDate:""},pagePa:{pageIndex:1,pageSize:15,rowCount:0},clientCompanyId:"",debounceFlag:!0,isEdit:!1}},computed:Object(o["a"])({},Object(g["e"])("baseData",["orgTreeData"])),created:function(){this.baseList(),this.queryOrgListData()},activated:function(){var t=this;this.$nextTick((function(){console.log("重新渲染了吗"),t.$refs.tableRef.doLayout()}))},methods:{trimSpace:function(t){for(var e=0;e<t.length;e++)""!=t[e]&&null!=t[e]&&"undefined"!=typeof t[e]||(t.splice(e,1),e-=1);return t},queryOrgListData:function(){var t=this;Object(p["B"])({regionLevel:2}).then((function(e){t.cityListData=e}))},queryUser:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(p["L"])(t);case 2:a=n.sent,console.log(a,"res"),e.optionList=Array.isArray(a)&&a.map((function(t){var e={};return e=Object.assign(e,t,t.userInfo),Object(o["a"])({text:"[".concat(t.userInfo.loginName,"] ").concat(t.userInfo.userName),value:t.userInfo.userId},e)}));case 5:case"end":return n.stop()}}),n)})))()},remoteMethod:function(t){t=encodeURI(t);var e={keyword:t};this.queryUser(e)},handleSelectChange:function(t){var e=this;this.optionList.forEach((function(n){if(n.value===t)if(e.selectedItemData=n,console.log("this.selectedItemData",e.selectedItemData),e.isQueryUser){var a=e.queryItemById(n.orgId,e.orgTreeData);if(a.parentId){var r=e.getAllParentOrgId(a.parentId,e.oneDimensionArr).reverse();r.push(a.orgName),e.currentOrg=r.join("/"),e.selectedItemData.orgFullName=e.currentOrg}else e.currentOrg=a.orgName}else e.currentOrg=n.orgCn}))},indexMethod:function(t){return this.pagePa.pageSize*this.pagePa.pageIndex+t-this.pagePa.pageSize+1},closeRest:function(){void 0!==this.$refs["formData"]&&this.$refs["formData"].resetFields()},preserveBtn:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.debounceFlag=!1,n=t.formData.orgId[t.formData.orgId.length-1],console.log("编辑客户所属时的orgId",n),a=[],t.formData.businessUserIds.forEach((function(t){a.push(t.assignId)})),r=a.join(","),i=[],t.formData.deliverUserIds.forEach((function(t){i.push(t.assignId)})),o=i.join(","),s={businessUserIds:r,deliverUserIds:o,clientCompanyId:t.formData.clientCompanyId,clientCompanyName:t.formData.clientCompanyName,clientOrgRelationId:t.formData.clientOrgRelationId,isAuth:"FALSE",mdeUpdatedBy:"",mdeUpdatedDate:"",orgId:n,orgName:""},!t.isEdit){e.next=16;break}return s.clientOrgRelationId=t.clientOrgRelationId,e.next=14,Object(L["w"])(s).then((function(e){200==e.code&&(t.$message({message:"编辑成功",type:"success"}),t.baseList(),t.dialogVisible=!1)})).finally((function(){t.debounceFlag=!0}));case 14:e.next=18;break;case 16:return e.next=18,Object(L["d"])(s).then((function(e){200==e.code?(t.$message({message:"添加成功",type:"success"}),t.baseList(),t.dialogVisible=!1):t.$message.error(e.code)})).finally((function(){t.debounceFlag=!0}));case 18:case"end":return e.stop()}}),e)})))()},empowerUpdate:function(t){var e=this;console.log("data",t);var n=this.cityListData.map((function(e){var n=[];for(var a in t.citys)e.regionId==t.citys[a]&&n.push(e.regionName);return n})),a=[];n.filter((function(t){t.length>0&&a.push(t)})),t.citys=a.join(",");var r="";if(r=t.orgId.length>0||null!=t.orgId?t.orgId.slice(-1).toString():"",t.orgId=r,t.clientOrgRelationId=this.clientOrgRelationId,t.orgId==this.currentListObj.orgId)return this.$message.error("您的部门已经具有此客户的授权了，请勿再次授权给自己部门！"),!1;Object(L["e"])(t).then((function(t){t&&(e.$message({message:"提交成功",type:"success"}),e.empowerVisible=!1)}))},getBusinessName:function(t){if(t){var e=t.map((function(t){return t.userName})).join(",");return e}return"--"},baseList:function(){var t=this;Object(L["p"])({input:this.queryClientListData,nextToken:"",pageEnd:0,pageIndex:this.pagePa.pageIndex,pageSize:this.pagePa.pageSize,pageStart:0}).then((function(e){t.pagePa.pageIndex=e.pageIndex,t.pagePa.rowCount=e.rowCount,console.log(e,"客户所属列表返沪i数据u"),t.listData=e.result}))},emptyBtn:function(){this.pagePa.pageIndex=1,this.orgIdArr=[],this.queryClientListData={clientOrg:{businessUserIds:"",clientCompanyId:"",clientCompanyName:"",clientOrgRelationId:"",deliverUserIds:"",isAuth:"",mdeUpdatedBy:"",mdeUpdatedDate:"",orgId:"",orgName:""},displayVos:[]},this.baseList()},beforeHandleCommand:function(t,e){return{item:t,command:e}},handleCommand:function(t){console.log("command",t),this.clientCompanyId=t.item.clientOrg.clientCompanyId,"a"==t.command?(this.currentListObj=t.item,this.clientOrgRelationId=t.item.clientOrg.clientOrgRelationId,this.empowerFormData={citys:"",clientCompanyId:t.item.clientOrg.clientCompanyId,clientCompanyName:t.item.clientOrg.clientCompanyName,clientOrgRelationId:t.item.clientOrg.clientOrgRelationId,contractContentType:"",contractEndDate:"",contractId:"",contractName:"",contractStartDate:"",isCity:"",orgCn:"",orgId:"",relationId:"",remark:"",scope:"",status:"",validEndDate:"",validStartDate:""},this.getEmpowerListData(t.item.clientOrg.clientCompanyId,"empower")):"b"==t.command?(this.getEmpowerListData(t.item.clientOrg.clientCompanyId,"details"),this.empowerClientCompanyName=t.item.clientOrg.clientCompanyName):"c"==t.command&&(this.currentListObj=t.item,"TRUE"==t.item.clientOrg.isAuth&&(this.messageBtnTwo=!1,this.messageContent={subTitle:"删除提示",mainTitle:"已有授权的客户所属不能删除？",contentText:"此所属交付组织已经将此客户的合同授权给另外的组织，不允许直接删除数据，请先取消授权并确认删除不会造成影响的情况下在进行删除。"}),this.clientOrgRelationId=t.item.clientOrg.clientOrgRelationId,this.messageVisible=!0)},determineClick:function(){var t=this;Object(L["f"])({id:this.clientOrgRelationId}).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.messageVisible=!1,t.baseList()}))},getEmpowerListData:function(t,e){var n=this;console.log(t),Object(L["t"])({clientCompanyId:t}).then((function(t){t&&(n.contractOrgListData=t,"details"==e?n.detailsModalVisible=!0:"empower"==e&&(n.empowerVisible=!0))}))},initialEmpowerListData:function(t){var e=this;Object(L["t"])({clientCompanyId:t}).then((function(t){t&&(e.contractOrgListData=t)}))},newlyAdded:function(){this.isEdit=!1,this.debounceFlag=!0,this.dialogTitle="新增客户所属",this.dialogVisible=!0,this.formData={clientCompanyName:"",businessUserIds:[],deliverUserIds:[],clientCompanyId:"",orgId:[]},this.$refs.submitModal.$refs.submitInfo&&this.$refs.submitModal.$refs.submitInfo.resetFields()},editBtn:function(t){this.isEdit=!0,this.debounceFlag=!0,this.clientOrgRelationId=t.clientOrg.clientOrgRelationId,this.formData.clientCompanyId=t.clientOrg.clientCompanyId,this.formData.clientCompanyName=t.clientOrg.clientCompanyName,this.formData.orgId=Object(x["c"])(t.clientOrg.orgId,!1),this.formData.businessUserIds=this.handleApprover(t.businessUserList),this.formData.deliverUserIds=this.handleApprover(t.deliverUserList),this.dialogTitle="编辑客户所属",this.dialogVisible=!0},onSortChange:function(t){var e=this;this.sortData=[];var n="";n="ascending"===t.order?"asc":"desc";var a={display:n,field:t.prop};0===this.sortData.length?this.sortData.push(a):this.sortData.forEach((function(t,n){if(t.field===a.field){if(t.display===a.display)return void e.sortData.splice(n,1);e.sortData.splice(n,1),e.sortData.push(a)}else e.sortData.push(a)})),this.queryClientListData.displayVos=this.sortData,this.baseList()},handleApprover:function(t){var e=[];if(t&&t.length)for(var n in t)e.push({assignId:t[n].userId,assignName:t[n].userName});return e},handleSizeChange:function(t){this.pagePa.pageSize=t,this.baseList()},handleCurrentChange:function(t){this.pagePa.pageIndex=t,this.baseList()}},watch:{empowerVisible:function(t,e){e&&this.baseList()},orgIdArr:{deep:!0,immediate:!0,handler:function(t){t&&t.length?this.queryClientListData.clientOrg.orgId=t[t.length-1]:this.queryClientListData.clientOrg.orgId=""}}}}),Q=K,H=(n("2a67"),Object(y["a"])(Q,a,r,!1,null,"4c6cf876",null));e["default"]=H.exports},"6f4d":function(t,e,n){"use strict";n("131e")},"75b2":function(t,e,n){"use strict";n("a51f")},9418:function(t,e,n){},"99f2":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"messagebox"},[n("el-dialog",{attrs:{title:t.content.subTitle,visible:t.isShowMessage,width:"24%","close-on-click-modal":!1},on:{close:t.handleCancel}},[n("div",{staticClass:"titles"},[n("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"26px","margin-right":"10px",color:"#fe9400"}}),n("span",[t._v(t._s(t.content.mainTitle))])]),n("div",{staticClass:"content"},[t._v(" "+t._s(t.content.contentText)+" ")]),t.messageBtn?n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.handleCancel}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.onClick}},[t._v("确 定")])],1):n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.handleCancel}},[t._v("确 定")])],1)])],1)},r=[],i={name:"textMessage",props:{isShowMessage:{type:Boolean,default:!1},messageBtn:{type:Boolean,default:!0},content:{type:Object,default:function(){return{}}}},data:function(){return{dialogVisible:!1}},methods:{onClick:function(){this.$emit("click")},handleCancel:function(){this.$emit("update:isShowMessage",!1)}}},o=i,s=(n("6f4d"),n("2877")),l=Object(s["a"])(o,a,r,!1,null,"79a40cff",null);e["a"]=l.exports},"9be2":function(t,e,n){},a51f:function(t,e,n){},e55b:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return c}));n("7db0"),n("99af"),n("fb6a"),n("159b");var a=n("ed08"),r=n("4360"),i=r["a"].state.baseData.orgTreeData,o=r["a"].state.baseData.jobTreeDate;function s(t,e){var n=[],a=function e(a,r){for(var i=0;i<a.length;i++){var o=a[i];if(o.value===r){n.push(o.extra1),n.push(r),e(t,o.parentId);break}o.children&&e(o.children,r)}};return a(t,e),n}function l(t){if(t){var e="",n=o.find((function(e){return e.value===t[0]})),a=n.children.find((function(e){return e.value===t[1]}));return e=a.extra2,e}}function c(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=d(t,i),r=m(Object(a["a"])(i));if(n){if(n.parentId){var o=u(n.parentId,r).reverse().concat([n.orgId]);return e?o:o.slice(1,o.length+1)}return[n.orgId]}}function u(t,e){var n=[];function a(t,e){e.forEach((function(r){t===r.orgId&&t===r.orgId&&(n.push(r.orgId),a(r.parentId,e))}))}return a(t,e),n}function d(t,e){var n=null;function a(e){e.forEach((function(e){if(t===e.orgId)return n=e;e.children&&e.children.length>0&&a(e.children)}))}return a(e),n}function m(t){var e=[];Object(a["a"])(t);function n(t){t.forEach((function(t){e.push(t),t.children&&t.children.length>0&&(n(t.children),delete t.children)}))}return n(t),e}},f6b0:function(t,e,n){"use strict";n.d(e,"l",(function(){return r})),n.d(e,"k",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"g",(function(){return s})),n.d(e,"m",(function(){return l})),n.d(e,"n",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"o",(function(){return d})),n.d(e,"p",(function(){return m})),n.d(e,"d",(function(){return p})),n.d(e,"w",(function(){return f})),n.d(e,"e",(function(){return g})),n.d(e,"t",(function(){return h})),n.d(e,"c",(function(){return b})),n.d(e,"h",(function(){return y})),n.d(e,"f",(function(){return v})),n.d(e,"s",(function(){return C})),n.d(e,"r",(function(){return I})),n.d(e,"v",(function(){return O})),n.d(e,"x",(function(){return w})),n.d(e,"j",(function(){return S})),n.d(e,"u",(function(){return D})),n.d(e,"q",(function(){return _}));var a=n("b775");function r(t){return Object(a["a"])({url:"/business/client/queryClientCompanyList",method:"post",data:t})}function i(t){return Object(a["a"])({url:"/business/client/queryClientCompanyInfo",method:"post",params:t})}function o(t){return Object(a["a"])({url:"/business/client/saveOrUpdateClientCompany",method:"post",data:t})}function s(t){return Object(a["a"])({url:"/business/client/removeClientCompany",method:"post",params:t})}function l(t){return Object(a["a"])({url:"/business/contract/queryContractListByClientId",method:"post",params:t})}function c(t){return Object(a["a"])({url:"/business/contract/queryContractCompanyListByClientId",method:"post",params:t})}function u(t){return Object(a["a"])({url:"/business/client/checkReClientCompanyInfo",method:"post",data:t})}function d(t){return Object(a["a"])({url:"/business/client/queryClientCompanyWorkplaceListByClientCompanyId",method:"post",params:t})}function m(t){return Object(a["a"])({url:"/business/scope/queryClientOrgList",method:"post",data:t})}function p(t){return Object(a["a"])({url:"/business/scope/createClientOrg",method:"post",data:t})}function f(t){return Object(a["a"])({url:"/business/scope/updateClientOrg",method:"post",data:t})}function g(t){return Object(a["a"])({url:"/business/scope/createContractOrg",method:"post",data:t})}function h(t){return Object(a["a"])({url:"/business/scope/queryContractOrgListById",method:"post",params:t})}function b(t){return Object(a["a"])({url:"/business/scope/closeClientOrg",method:"post",params:t})}function y(t){return Object(a["a"])({url:"/business/scope/deleteContractOrg",method:"post",params:t})}function v(t){return Object(a["a"])({url:"/business/scope/deleteClientOrg",method:"post",params:t})}function C(t){return Object(a["a"])({url:"/business/scope/queryContractOrgList",method:"post",data:t})}function I(t){return Object(a["a"])({url:"/business/clientlevel/queryClientTwoLevelList",method:"post",data:t})}function O(t){return Object(a["a"])({url:"/business/clientlevel/save",method:"post",data:t})}function w(t){return Object(a["a"])({url:"/business/clientlevel/update",method:"post",data:t})}function S(t){return Object(a["a"])({url:"/business/clientlevel/detail",method:"post",data:t})}function D(t){return Object(a["a"])({url:"/business/clientlevel/remove",method:"post",data:t})}function _(t){return Object(a["a"])({url:"/business/clientlevel/queryClientTwoLevelBySelect",method:"post",data:t})}}}]);