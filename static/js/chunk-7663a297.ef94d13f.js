(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7663a297"],{"04f0":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"toms-container"},[r("div",{staticClass:"toms-list-searchWrap"},[r("zm-Search",{ref:"search",attrs:{inputList:e.inputList,btnConfig:e.btnConfig},on:{handleAddProcess:e.handleAddProcess,search:e.search,reset:e.resetTable}})],1),r("div",{staticClass:"toms-list-tableWrap"},[r("zm-table",{ref:"tableRef",staticStyle:{width:"100%"},attrs:{tableData:e.tableData,columns:e.columns,height:"527px",currentPage:e.pageData.pageIndex,pageSize:e.pageData.pageSize,total:e.pageData.pageCount,sizeList:e.sizeList,isCheckboxGroup:!0},on:{handleCurrentChange:e.handleCurrentChange,sortChange:e.sortChange,handleSizeChange:e.handleSizeChange,setConfig:e.setConfig,editFn:e.editFn,deleteFn:e.deleteFn}})],1),r("cc-people-modal",{attrs:{customEventName:"handleStaffInfo",isShowCcModal:e.isShowCcModal,isQueryUser:!0},on:{"update:isShowCcModal":function(t){e.isShowCcModal=t},"update:is-show-cc-modal":function(t){e.isShowCcModal=t},handleStaffInfo:e.handleStaffInfo}}),r("el-dialog",{staticClass:"processNode",attrs:{title:e.modalTitle,visible:e.openAddModal,width:"70%","before-close":e.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.openAddModal=t}}},[1===e.modalContentFlag?r("zm-form",{ref:"addProcessNode",attrs:{formData:e.addProcessNodeForm,formConfig:e.addProcessFormConfig,rules:e.addProcessRules,labelWidth:"140px"}}):r("div",{staticClass:"ApproverConfig"},[r("div",{staticClass:"top"},[r("zm-form",{ref:"approverConfig",attrs:{formData:e.approverFormData,formConfig:e.approverFormConfig,rules:e.approverRules,labelWidth:"120px"}}),!e.isUniformConfig||e.isNominator?r("div",{staticStyle:{"text-align":"right"}},[e.isUpdateBtn?r("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:e.updateContentToTable}},[e._v("更新")]):r("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:e.addContentToTable}},[e._v("添加")])],1):e._e()],1),!e.isUniformConfig||e.isNominator?r("zm-table",{staticStyle:{width:"100%"},attrs:{border:"",tableData:e.approverTableData,columns:e.approverColumns,isShowPagenation:!1}}):e._e()],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),r("Debounce",{attrs:{time:500,events:"click"}},[r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitAddProcess(t)}}},[e._v("确 定")])],1)],1)],1)],1)},a=[],o=r("1da1"),i=(r("96cf"),r("d81d"),r("159b"),r("a15b"),r("a434"),r("4de4"),r("caad"),r("2532"),r("8cc7")),s=r("c91b"),u=r("a937"),l=(r("ac1f"),r("1276"),r("ed08")),c=r("5f98"),d=function(e){var t=e.$store.state.baseData.baseDataOptionList,r=t.IS_ISEF.map((function(e){return{text:"是"===e.text?"有效":"无效",value:e.value}}));return[{type:"text-input",bind_key:"flowName",labelWidth:"60px",inputWidth:240,label:"流程名称",placeholder:"请输入",span:6},{type:"select-input",bind_key:"configType",label:"配置类型",span:6,optionList:t.IT_PZLX},{type:"select-input",bind_key:"flowType",label:"流程类型",span:6,optionList:t.IT_PTYP},{type:"select-input",bind_key:"isValid",label:"是否有效",span:6,optionList:r}]},p={span:24,customList:[{role:"flow.node.add",customBtnText:"新增",changeFn:"handleAddProcess"}],leftBtnHidden:!Object(c["a"])("flow.node.list")},f=function(e){return[{label:"序号",width:"50px",kind:"render",render:function(t,r){var n=r.$index+1,a=(e.pageData.pageIndex-1)*e.pageData.pageSize;return t("span",n+a)}},{label:"流程类型",prop:"flowType",sortable:"custom",kind:"render",render:function(e,t){return e("span",t.row.flowTypeCn)}},{label:"流程名称",prop:"flowName",sortable:"custom",kind:"render",render:function(e,t){return e("span",t.row.flowNo+" "+t.row.flowName)}},{label:"节点名称",align:"left",prop:"nodeName"},{label:"配置类型",prop:"configTypeCn"},{label:"是否有效",prop:"isValidCn"},{label:"审批人",prop:"auditUser",align:"left"},{label:"操作",fixed:"right",kind:"formatBtn",moreBtnRoles:"flow.node.edit,flow.node.delete",firstBtn:{text:"审批人配置",role:"flow.node.config",fn:"setConfig"},btnList:[{text:"编辑",fn:"editFn",role:"flow.node.edit"},{text:"删除",fn:"deleteFn",role:"flow.node.delete"}]}]},m=function(e){var t=e.$store.state.baseData.baseDataOptionList;return[{span:12,list:[{type:"select",label:"流程类型",prop:"flowType",placeholder:"请选择",optionList:t.IT_PTYP,disabled:e.isEditOp}]},{span:12,list:[{type:"select",prop:"flowId",label:"流程名称",placeholder:"请选择",optionList:e.processNameList,disabled:e.isEditOp}]},{span:12,list:[{type:"text",label:"节点名称",prop:"nodeName"}]},{span:12,list:[{type:"select",prop:"configType",label:"配置类型",placeholder:"请选择",optionList:t.IT_PZLX}]},{span:12,list:[{type:"radioGroup",label:"是否有效",prop:"isValid",optionList:t.IS_ISEF}]}]},g={flowType:{required:!0,message:"请选择流程类型",trigger:"change"},flowId:{required:!0,message:"请选择流程名称",trigger:"change"},nodeName:{required:!0,message:"请输入节点名称",trigger:"blur"},configType:{required:!0,message:"请选择配置类型",trigger:"change"},isValid:{required:!0,message:"请选择是否有效",trigger:"change"}},h=function(e){var t=e.$store.state.baseData.baseDataOptionList;return[{span:12,list:[{type:"cascader",label:"部门名称",hidden:e.isUniformConfig,prop:"orgId",optionList:e.orgNameTreeData,propLabel:"orgName",propValue:"orgId",checkStrictly:!0}]},{span:12,list:[{type:"radioGroup",label:"审批人设置",prop:"auditUserSetting",optionList:t.IT_SPSZ}]},{span:12,list:[{type:"select",label:"审批类型",prop:"auditType",placeholder:"请选择",hidden:!e.isNominator,optionList:t.IT_SPLX}]},{span:12,list:[{type:"radioGroup",label:"是否按城市区分",prop:"isCity",optionList:t.IS_CITY,hidden:!e.isNominator,changeFn:"divisionByCityChange"}]},{span:12,list:[{type:"select",prop:"city",label:"选择城市",placeholder:"请选择",optionList:t.IT_CITY,hidden:!e.isNominator||!e.isShowCity}]},{span:12,list:[{type:"text",label:"工号/姓名",prop:"userName",disabled:!0,placeholder:"请点击搜索按钮添加人员",searchBtn:{icon:"el-icon-search",searchBtnCanClick:!0,changeFn:function(){e.isShowCcModal=!0}},hidden:!e.isNominator}]}]},y={orgId:{required:!0,message:"请选择部门名称",trigger:"change"},auditType:{required:!0,message:"请选择审批类型",trigger:"change"},auditUserSetting:{required:!0,message:"请选择审批人设置",trigger:"change"},isCity:{required:!0,message:"请选择是否按城市区分",trigger:"change"},city:{required:!0,message:"请选择城市",trigger:"change"},userName:{required:!0,message:"请选择姓名",trigger:"change"},orgLeaderRole:{required:!0,message:"请选择部门负责人",trigger:"change"}},v=function(e){var t=e.$store.state.baseData.baseDataOptionList;return[{label:"序号",type:"index",fixed:"left",width:"50px"},{label:"部门名称",prop:"orgId",minWidth:"140px",kind:"render",render:function(t,r){if(r.row.orgId){var n=[];return r.row.orgFullName.split(",").forEach((function(t){n.push(Object(l["m"])(e.orgNameTreeData,t,"orgId","orgName"))})),t("span",n.join("/"))}},hidden:e.isUniformConfig},{label:"审批人设置",prop:"auditUserSetting",minWidth:"140px",kind:"render",render:function(e,r){var n=Object(l["k"])(t.IT_SPSZ,r.row.auditUserSetting);return e("span",n)}},{label:"审批类型",prop:"auditType",kind:"render",render:function(e,r){var n=Object(l["k"])(t.IT_SPLX,r.row.auditType);return e("span",n)}},{label:"是否按城市区分",prop:"isCity",kind:"render",render:function(e,r){var n=Object(l["k"])(t.IS_CITY,r.row.isCity);return e("span",n)},hidden:!e.isNominator},{label:"城市",prop:"city",kind:"render",render:function(e,r){var n=Object(l["k"])(t.IT_CITY,r.row.city);return e("span",n)},hidden:!e.isNominator||!e.isShowCity},{label:"工号/姓名",prop:"userName",hidden:!e.isNominator},{label:"操作",fixed:"right",kind:"render",render:function(t,r){return t("div",[t("span",{class:["renderOperation"],on:{click:function(){console.log(r.$index,"编辑操作"),e.isUpdateBtn=!0,e.approverFormData=Object(l["a"])(r.row),e.updateDataIndex=r.$index}}},"编辑"),t("span",{class:["renderOperation"],on:{click:function(){e.$confirm("请确认是否要删除此项","确认提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.approverTableData.splice(r.$index,1),e.$message.success("删除成功");case 2:case"end":return t.stop()}}),t)}))))}}},"删除")])}}]},b=r("fa38"),C=r("a417"),w=r("470f"),O={name:"ProcessNodeConfig",components:{zmTable:i["a"],zmSearch:u["a"],zmForm:s["a"],ccPeopleModal:w["a"]},data:function(){var e=d(this),t=f(this);return{btnConfig:p,inputList:e,tableData:[],columns:t,pageData:{pageIndex:1,pageSize:15,pageCount:0},searchData:{},sortData:[],sizeList:[15,30,50],openAddModal:!1,modalTitle:"默认标题",addProcessRules:g,modalContentFlag:1,addProcessNodeForm:{flowType:"",flowId:"",nodeName:"",configType:"",isValid:""},approverFormData:{orgId:"",assignType:"",auditUserSetting:"",isCity:"",city:"",userName:"",orgLeaderRole:""},approverRules:y,isNominator:!1,isPrincipal:!1,isUniformConfig:!1,approverTableData:[],isEditOp:!1,processNameList:[],orgNameTreeData:[],isShowCity:!1,isShowCcModal:!1,isUpdateBtn:!1,updateDataIndex:"",processNodeRowData:{},isDisabledEvents:!1}},computed:{approverColumns:function(){return v(this)},approverFormConfig:function(){return h(this)},addProcessFormConfig:function(){return m(this)}},activated:function(){var e=this;this.$nextTick((function(){e.$refs.tableRef.doLayoutTable()}))},mounted:function(){this.getProcessNodeData(),this.getAllProcessName()},methods:{getAllProcessName:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(b["p"])({input:{},pageIndex:1,pageSize:9999});case 2:return r=t.sent,e.processNameList=Array.isArray(r.result)&&r.result.map((function(e){return{text:e.flowNo+" "+e.flowName,value:e.flowId}})),t.next=6,Object(C["z"])({});case 6:n=t.sent,e.orgNameTreeData=e.deleteChildren(n);case 8:case"end":return t.stop()}}),t)})))()},setConfig:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.isUpdateBtn=!1,e.configType.indexOf("IT_PZLX_001")>-1?(t.isUniformConfig=!0,t.modalTitle="审批人配置——统一配置"):(t.isUniformConfig=!1,t.modalTitle="审批人配置——按部门配置"),t.modalContentFlag=2,t.isDisabledEvents=!1,t.openAddModal=!0,t.processNodeRowData=e,r.next=8,Object(b["g"])({nodeId:e.nodeId});case 8:n=r.sent,t.approverTableData=n.assignConfigs||[],t.approverFormData.auditUserSetting=n.auditUserSetting,console.log("流程审批人详情",n);case 12:case"end":return r.stop()}}),r)})))()},editFn:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.isDisabledEvents=!1,t.openAddModal=!0,t.modalTitle="流程节点编辑",t.modalContentFlag=1,r.next=6,Object(b["h"])({nodeId:e.nodeId});case 6:n=r.sent,t.addProcessNodeForm=n;case 8:case"end":return r.stop()}}),r)})))()},getProcessNodeData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e||{},a={input:n},o=Object.assign({},t.pageData,a),o.input.displays=t.sortData,o.input.vagueQuery=!0,r.next=7,Object(b["i"])(o);case 7:i=r.sent,t.pageData.pageIndex=i.pageIndex,t.pageData.pageCount=i.rowCount,t.tableData=i.result||[];case 11:case"end":return r.stop()}}),r)})))()},handleAddProcess:function(){this.isDisabledEvents=!1,this.modalContentFlag=1,this.openAddModal=!0,this.modalTitle="流程节点新增",this.addProcessNodeForm={flowType:"",flowId:"",nodeName:"",configType:"",isValid:""}},handleClose:function(){this.openAddModal=!1,1===this.modalContentFlag?(this.$refs.addProcessNode.resetFields(),this.$refs.addProcessNode.clearValidate()):(this.$refs.approverConfig.clearValidate(),this.$refs.approverConfig.resetFields())},submitAddProcess:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isDisabledEvents){t.next=2;break}return t.abrupt("return");case 2:if(1!==e.modalContentFlag){t.next=6;break}e.$refs.addProcessNode.validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=6;break}return console.log(r,"jiaoyanchenggong"),t.next=4,Object(b["r"])(r);case 4:n=t.sent,"200"===n.code&&(e.isDisabledEvents=!0,e.$message.success("操作成功"),e.openAddModal=!1,e.$refs.addProcessNode.resetFields(),e.$refs.addProcessNode.clearValidate(),e.getProcessNodeData());case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=26;break;case 6:if(!e.isNominator){t.next=12;break}if(0!==e.approverTableData.length){t.next=10;break}return e.$message.warning("请添加审批人"),t.abrupt("return");case 10:t.next=15;break;case 12:if(e.approverFormData.auditUserSetting){t.next=15;break}return e.$message.warning("请选择审批人设置"),t.abrupt("return");case 15:return r={},r.nodeId=e.processNodeRowData.nodeId,r.flowType=e.processNodeRowData.flowType,r.isValid=e.processNodeRowData.isValid,r.configType=e.processNodeRowData.configType,r.auditUserSetting=e.approverFormData.auditUserSetting,e.isUniformConfig?e.isNominator&&(r.assignConfigs=e.approverTableData,r=Object.assign(r,e.approverTableData[0])):(n=Object(l["a"])(e.approverTableData),n.forEach((function(e){Array.isArray(e.orgId)&&(e.orgFullName=e.orgId.join(","))})),n.forEach((function(e){Array.isArray(e.orgId)&&(e.orgId=e.orgId[e.orgId.length-1]||"")})),r.assignConfigs=n),t.next=24,Object(b["s"])(r);case 24:a=t.sent,"200"===a.code&&(e.isDisabledEvents=!0,e.$message.success("操作成功"),e.$refs.approverConfig.clearValidate(),e.$refs.approverConfig.resetFields(),e.approverTableData=[],e.openAddModal=!1,e.getProcessNodeData());case 26:case"end":return t.stop()}}),t)})))()},search:function(e){this.pageData.pageIndex=1;var t=JSON.parse(JSON.stringify(e));this.searchData=t,this.getProcessNodeData(t)},handleSizeChange:function(e){this.pageData.pageIndex=1,this.pageData.pageSize=e,this.getProcessNodeData(this.searchData)},resetTable:function(){this.pageData.pageIndex=1,this.searchData={},this.getProcessNodeData(this.searchData)},deleteFn:function(e){var t=this,r={flowId:e.flowId};this.$confirm("是否确定删除此流程节点的信息? \n删除此流程节点的配置可能会导致审批流异常或者 \n报错,且将记录此次删除人的操作和信息","确认提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(b["b"])(r);case 2:n=e.sent,"200"===n.code?t.$message.success("删除成功"):t.$message.warning(n.msg||"未知错误，请联系管理员"),t.getProcessNodeData();case 5:case"end":return e.stop()}}),e)}))))},handleCurrentChange:function(e){this.pageData.pageIndex=e,this.getProcessNodeData(this.searchData)},sortChange:function(e){var t=this,r="";r="ascending"===e.order?"asc":"desc";var n={display:r,field:e.prop};0===this.sortData.length?this.sortData.push(n):this.sortData.forEach((function(e,r){if(e.field===n.field){if(e.display===n.display)return void t.sortData.splice(r,1);t.sortData.splice(r,1),t.sortData.push(n)}else t.sortData.push(n)})),this.getProcessNodeData()},deleteChildren:l["c"],handleStaffInfo:function(e){this.approverFormData.userName=e.text,this.approverFormData.userId=e.value},addContentToTable:function(){var e=this;this.$refs.approverConfig.validate((function(t){if(t){console.log(t,"新增");var r=t.auditUserSetting,n=t.isCity;if(e.isUniformConfig){if(e.approverTableData.length>0){var a=e.approverTableData.filter((function(e){return e.auditType===t.auditType})),o=e.approverTableData.filter((function(e){return e.city===t.city}));if(a.length>0){console.log("执行耳来吗",t,e.approverTableData);var i=e.approverTableData.filter((function(e){return e.userId===t.userId}));if(o.length>0){var s=o.map((function(e){return e.auditType}));if(s.includes("IT_SPLX_002"))return void e.$message.warning("单签审批类型只允许添加一条数据");if(i.length>0)return void e.$message.warning("当前审批类型下不能重复添加相同人员")}}else if(1===o.length){if(o[0].auditType!==t.auditType)return void e.$message.warning("单个城市只允许配置一种审批类型")}else if(console.log(o.every((function(e){return e.auditType!==t.auditType})),"shifouyouduotiaoshenpileixing"),!o.every((function(e){return e.auditType===t.auditType})))return void e.$message.warning("单个城市只允许配置一种审批类型")}}else if(e.approverTableData.length>0){var u=e.approverTableData.filter((function(e){if(Array.isArray(t.orgId)&&t.orgId.length>0&&e.orgFullName&&e.orgFullName===t.orgId.join(","))return!0}));if(u.length>0){var c=u.filter((function(e){return e.auditUserSetting!==t.auditUserSetting}));if(c.length>0)return void e.$message.warning("同一个部门下只能设置一种审批人设置");var d="IT_SPSZ_003"===t.auditUserSetting;if(!d)return t.auditUserSetting===u[0].auditUserSetting?void e.$message.warning("同一个部门下的同种审批人设置只能添加一条数据"):void e.$message.warning("同一个部门必须添加相同的审批人设置类型");var p=u.filter((function(e){return e.isCity!==t.isCity}));if(p.length>0)return void e.$message.warning("请选择相同的 是否按城市区分");var f="IS_CITY_001"===t.isCity;if(f){var m=u.filter((function(e){return e.city===t.city}));if(m.length>0){var g=m.some((function(e){return e.auditType===t.auditType}));if(!g)return void e.$message.warning("同一个城市下只能够配置一种审批类型");var h=m.map((function(e){return e.auditType}));if(h.includes("IT_SPLX_002"))return void e.$message.warning("单签审批类型只允许添加一条数据")}}else{var y=u.filter((function(e){return e.auditType!==t.auditType}));if(y.length>0)return void e.$message.warning("同部门不按照城市配置不能够配置不同审批类型");var v="IT_SPLX_002"===t.auditType;if(v){var b=u.filter((function(e){return"IT_SPLX_002"==e.auditType}));if(b.length>0)return void e.$message.warning("单签数据只能够添加一条数据")}}var C=u.filter((function(e){return e.city===t.city}));C.length}console.log(u,"表单中的org"),console.log(t,"表单中的数据")}e.approverFormData.orgId&&(e.approverFormData.orgFullName=e.approverFormData.orgId.join(",")),e.approverTableData.push(Object(l["a"])(e.approverFormData)),e.$refs.approverConfig.clearValidate(),e.$refs.approverConfig.resetFields(),e.approverFormData.auditUserSetting=r,e.approverFormData.isCity=n}}))},updateContentToTable:function(){var e=this;this.$refs.approverConfig.validate((function(t){if(t){var r=t.isCity,n=t.auditUserSetting;if(console.log("编辑",t),e.isUniformConfig){var a=Object(l["a"])(e.approverTableData);if(a.splice(e.updateDataIndex,1),a.length>0){var o=e.approverTableData.filter((function(e){return e.auditType===t.auditType})),i=e.approverTableData.filter((function(e){return e.city===t.city}));if(o.length>0){if(i.length>0){var s=i.map((function(e){return e.auditType}));if(s.includes("IT_SPLX_002"))return void e.$message.warning("单签审批类型只允许添加一条数据")}}else if(1===i.length){if(i[0].auditType!==t.auditType)return void e.$message.warning("单个城市只允许配置一种审批类型")}else if(!i.every((function(e){return e.auditType===t.auditType})))return void e.$message.warning("单个城市只允许配置一种审批类型")}}else{var u=Object(l["a"])(e.approverTableData);if(u.splice(e.updateDataIndex,1),u.length>0){var c=e.approverTableData.filter((function(e){if(t.orgFullName&&e.orgFullName&&e.orgFullName===t.orgFullName)return!0}));if(console.log(c,"相同组织数据"),c.length>0){var d=c.filter((function(e){return e.auditUserSetting!==t.auditUserSetting}));if(d.length>0)return void e.$message.warning("同一个部门下只能设置一种审批人设置");var p="IT_SPSZ_003"===t.auditUserSetting;if(p){var f=c.filter((function(e){return e.isCity!==t.isCity}));if(f.length>0)return void e.$message.warning("请选择相同的 是否按城市区分");var m="IS_CITY_001"===t.isCity;if(m){var g=c.filter((function(e){return e.city===t.city}));if(g.length>0){var h=g.some((function(e){return e.auditType===t.auditType}));if(!h)return void e.$message.warning("同一个城市下只能够配置一种审批类型");var y=g.map((function(e){return e.auditType}));if(y.includes("IT_SPLX_002"))return void e.$message.warning("单签审批类型只允许添加一条数据")}}else{var v=c.filter((function(e){return e.auditType!==t.auditType}));if(v.length>0)return void e.$message.warning("同部门不按照城市配置不能够配置不同审批类型");var b="IT_SPLX_002"===t.auditType;if(b){var C=c.filter((function(e){return"IT_SPLX_002"==e.auditType}));if(C.length>0)return void e.$message.warning("单签数据只能够添加一条数据")}}var w=c.filter((function(e){return e.city===t.city}));w.length}else if(!e.isUpdateBtn)return t.auditUserSetting===c[0].auditUserSetting?void e.$message.warning("同一个部门下的同种审批人设置只能添加一条数据"):void e.$message.warning("同一个部门必须添加相同的审批人设置类型")}}}t.orgId&&Array.isArray(t.orgId)&&(t.orgFullName=t.orgId.join(",")),e.approverTableData.splice(e.updateDataIndex,1,Object(l["a"])(t)),e.$message.success("更新成功"),e.$refs.approverConfig.clearValidate(),e.$refs.approverConfig.resetFields(),e.approverFormData.auditUserSetting=n,e.approverFormData.isCity=r,e.isUpdateBtn=!1}else e.$message.warning("请填写表单必填项")}))}},watch:{"approverFormData.auditUserSetting":{handler:function(e){"IT_SPSZ_003"===e?(this.isNominator=!0,this.isPrincipal=!1):"IT_SPSZ_002"===e?(this.isNominator=!1,this.isPrincipal=!0):(this.isNominator=!1,this.isPrincipal=!1)}},"approverFormData.isCity":{handler:function(e){"IS_CITY_001"===e?this.isShowCity=!0:(this.isShowCity=!1,this.approverFormData.city="")}}}},T=O,I=(r("40ac"),r("2877")),D=Object(I["a"])(T,n,a,!1,null,"1ccf1bed",null);t["default"]=D.exports},"2ead":function(e,t,r){},"40ac":function(e,t,r){"use strict";r("2ead")},"470f":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ccContainer"},[r("el-dialog",e._b({attrs:{title:"选择人员",visible:e.isShowCcModal,width:"25%","destroy-on-close":!0,"close-on-click-modal":!1},on:{close:e.handleCancel}},"el-dialog",e.$attrs,!1),[r("el-form",{ref:"ruleForm",attrs:{model:e.employForm,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"姓名",prop:"employId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","reserve-keyword":"",clearable:"",placeholder:"请输入工号或姓名","remote-method":e.remoteMethod,loading:e.loading},on:{change:e.handleSelectChange,keyup:e.handleInput},model:{value:e.employForm.employId,callback:function(t){e.$set(e.employForm,"employId",t)},expression:"employForm.employId"}},e._l(e.optionList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"所属组织"}},[r("el-input",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.currentOrg,callback:function(t){e.currentOrg=t},expression:"currentOrg"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},a=[],o=r("1da1"),i=r("5530"),s=(r("96cf"),r("d81d"),r("99af"),r("159b"),r("a15b"),r("a417")),u=r("ed08"),l=r("dc27"),c=r("2f62"),d={name:"CcPeopleModal",props:{isShowCcModal:{type:Boolean,default:!1},customEventName:{type:String,default:"handleConfirm"},isQueryUser:{type:Boolean,default:!1},isLeave:{type:Boolean,default:!1},isQueryJfOrZp:{type:Boolean,default:!1},roleType:{type:String,default:""},employType:{type:String,default:""}},data:function(){return{loading:!1,optionList:[],rules:{employId:{message:"请输入员工姓名",required:!0,trriger:"change"}},employForm:{employId:""},currentOrg:"",selectedItemData:{},oneDimensionArr:[]}},computed:Object(i["a"])({},Object(c["e"])("baseData",["orgTreeData"])),watch:{},mounted:function(){this.registerCloseEvent(),this.getOrgTreeList()},methods:{handleInput:function(e){},handleSubmit:function(){var e=this;this.$refs.ruleForm.validate((function(t){t&&(e.$emit(e.customEventName,e.selectedItemData),e.$emit("update:isShowCcModal",!1))}))},handleCancel:function(){this.$refs.ruleForm.resetFields(),this.$refs.ruleForm.clearValidate(),this.$emit("update:isShowCcModal",!1)},remoteMethod:function(e){if(this.loading=!0,""!==e)if(e=encodeURI(e),this.isQueryUser)if(this.isQueryJfOrZp){var t={keyword:e,roleType:this.roleType};this.queryJfOrZp(t)}else{var r={keyword:e};this.queryUser(r)}else{var n={keyWord:e,isLeave:this.isLeave,employType:this.employType||""};this.queryEmployee(n)}else this.optionList=[]},queryJfOrZp:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(l["Z"])(e);case 2:n=r.sent,t.loading=!1,t.optionList=Array.isArray(n)&&n.map((function(e){var t={};return t=Object.assign(t,e,e.userInfo),Object(i["a"])({text:"[".concat(e.userInfo.loginName,"] ").concat(e.userInfo.userName," | ").concat(e.orgName),value:e.userInfo.userId},t)}));case 5:case"end":return r.stop()}}),r)})))()},queryUser:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(s["L"])(e);case 2:n=r.sent,t.loading=!1,t.optionList=Array.isArray(n)&&n.map((function(e){var t={};return t=Object.assign(t,e,e.userInfo),Object(i["a"])({text:"[".concat(e.userInfo.loginName,"] ").concat(e.userInfo.userName," | ").concat(e.orgName),value:e.userInfo.userId},t)}));case 5:case"end":return r.stop()}}),r)})))()},getUserSelectListByOrg:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(s["M"])(e);case 2:n=r.sent,t.loading=!1,t.optionList=Array.isArray(n)&&n.map((function(e){var t={};return t=Object.assign(t,e,e.userInfo),Object(i["a"])({text:"[".concat(e.userInfo.loginName,"] ").concat(e.userInfo.userName," | ").concat(e.orgName),value:e.userInfo.userId},t)}));case 5:case"end":return r.stop()}}),r)})))()},queryEmployee:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(l["R"])(e);case 2:n=r.sent,t.loading=!1,t.optionList=Array.isArray(n)&&n.map((function(e){return Object(i["a"])({text:"[".concat(e.employNo,"] ").concat(e.employName," | ").concat(e.orgCn),value:e.employId},e)}));case 5:case"end":return r.stop()}}),r)})))()},handleSelectChange:function(e){var t=this;this.optionList.forEach((function(r){if(r.value===e)if(t.selectedItemData=r,t.isQueryUser){var n=t.queryItemById(r.orgId,t.orgTreeData);if(n.parentId){var a=t.getAllParentOrgId(n.parentId,t.oneDimensionArr).reverse();a.push(n.orgName),t.currentOrg=a.join("/"),t.selectedItemData.orgFullName=t.currentOrg}else t.currentOrg=n.orgName}else t.currentOrg=r.orgCn}))},registerCloseEvent:function(){var e=this,t=document.querySelector(".ccContainer .el-dialog__close");t&&t.addEventListener("click",(function(){e.handleCancel()}))},getOrgTreeList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.oneDimensionArr=e.toOneDimensionArr(Object(u["a"])(e.orgTreeData));case 1:case"end":return t.stop()}}),t)})))()},queryItemById:function(e,t){var r=null;function n(t){t.forEach((function(t){if(e===t.orgId)return r=t;t.children&&t.children.length>0&&n(t.children)}))}return n(t),r},toOneDimensionArr:function(e){var t=[];Object(u["a"])(e);function r(e){e.forEach((function(e){t.push(e),e.children&&e.children.length>0&&(r(e.children),delete e.children)}))}return r(e),t},getAllParentOrgId:function(e,t){var r=[];function n(e,t){t.forEach((function(a){e===a.orgId&&e===a.orgId&&(r.push(a.orgName),n(a.parentId,t))}))}return n(e,t),r}}},p=d,f=r("2877"),m=Object(f["a"])(p,n,a,!1,null,"c8833b38",null);t["a"]=m.exports},"5d12":function(e,t,r){"use strict";var n={ONLY_NUMBER_NO_ZERO:/[^1-9]/g,ONLY_NUMBER:/[\D]/g,ONLY_NUMBER_LETTER:/[\W]/g,NO_CN:/[\u0391-\uFFE5]+/,EMAIL:/\{|\}|\（|\)|\=|\%|\~|\!|\^|\&|\+|\#|\￥|\）|\{|\}|\！|[\u0391-\uFFE5]/g,NUMBER_WITH_POINT:/[^\d\.]/g};t["a"]=n},dc27:function(e,t,r){"use strict";r.d(t,"t",(function(){return a})),r.d(t,"R",(function(){return o})),r.d(t,"db",(function(){return i})),r.d(t,"E",(function(){return s})),r.d(t,"a",(function(){return u})),r.d(t,"x",(function(){return l})),r.d(t,"J",(function(){return c})),r.d(t,"K",(function(){return d})),r.d(t,"G",(function(){return p})),r.d(t,"cb",(function(){return f})),r.d(t,"P",(function(){return m})),r.d(t,"bb",(function(){return g})),r.d(t,"N",(function(){return h})),r.d(t,"eb",(function(){return y})),r.d(t,"hb",(function(){return v})),r.d(t,"ab",(function(){return b})),r.d(t,"gb",(function(){return C})),r.d(t,"H",(function(){return w})),r.d(t,"I",(function(){return O})),r.d(t,"F",(function(){return T})),r.d(t,"L",(function(){return I})),r.d(t,"O",(function(){return D})),r.d(t,"fb",(function(){return j})),r.d(t,"jb",(function(){return N})),r.d(t,"w",(function(){return x})),r.d(t,"C",(function(){return S})),r.d(t,"s",(function(){return F})),r.d(t,"U",(function(){return E})),r.d(t,"V",(function(){return L})),r.d(t,"M",(function(){return _})),r.d(t,"v",(function(){return k})),r.d(t,"ib",(function(){return P})),r.d(t,"p",(function(){return $})),r.d(t,"h",(function(){return U})),r.d(t,"W",(function(){return R})),r.d(t,"g",(function(){return A})),r.d(t,"n",(function(){return q})),r.d(t,"X",(function(){return B})),r.d(t,"B",(function(){return M})),r.d(t,"Q",(function(){return z})),r.d(t,"D",(function(){return V})),r.d(t,"l",(function(){return Z})),r.d(t,"i",(function(){return W})),r.d(t,"m",(function(){return X})),r.d(t,"y",(function(){return Y})),r.d(t,"A",(function(){return J})),r.d(t,"z",(function(){return Q})),r.d(t,"S",(function(){return G})),r.d(t,"c",(function(){return H})),r.d(t,"e",(function(){return K})),r.d(t,"b",(function(){return ee})),r.d(t,"d",(function(){return te})),r.d(t,"j",(function(){return re})),r.d(t,"f",(function(){return ne})),r.d(t,"Z",(function(){return ae})),r.d(t,"T",(function(){return oe})),r.d(t,"q",(function(){return ie})),r.d(t,"Y",(function(){return se})),r.d(t,"r",(function(){return ue})),r.d(t,"o",(function(){return le})),r.d(t,"u",(function(){return ce})),r.d(t,"k",(function(){return de}));var n=r("b775");function a(e){return Object(n["a"])({url:"/employ/attr/queryEmployAttrList",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/employ/archives/queryEmployList",method:"post",params:e})}function i(e){return Object(n["a"])({url:"/employ/attr/saveOrUpdateEmployAttr",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/employ/attr/queryEmployAttr",method:"post",params:e})}function u(e){return Object(n["a"])({url:"/employ/attr/addOrCancelAttr",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/employ/attr/queryEmployAttrHistory",method:"post",data:e})}function c(e){return Object(n["a"])({url:"/employ/free/queryEmployFreeList",method:"post",data:e})}function d(e){return Object(n["a"])({url:"/employ/free/queryEmployFreePoolList",method:"post",data:e})}function p(e){return Object(n["a"])({url:"/employ/free/queryEmployFree",method:"post",params:e})}function f(e){return Object(n["a"])({url:"/employ/archives/saveOrUpdateEmploy",method:"post",data:e})}function m(e){return Object(n["a"])({url:"/employ/archives/queryEmployInfoList",method:"post",data:e})}function g(e){return Object(n["a"])({url:"/employ/archives/removeEmployInfo",method:"post",params:e})}function h(e){return Object(n["a"])({url:"/employ/archives/queryEmployInfoDetail",method:"post",params:e})}function y(e){return Object(n["a"])({url:"/employ/free/saveOrUpdateEmployFree",method:"post",data:e})}function v(e){return Object(n["a"])({url:"/employ/free/updateEmployFreeEntry",method:"post",data:e})}function b(e){return Object(n["a"])({url:"/employ/free/removeEmployFree",method:"post",params:e})}function C(e){return Object(n["a"])({url:"/employ/free/updateCancelEmployFree",method:"post",data:e})}function w(e){return Object(n["a"])({url:"/employ/free/queryEmployFreeDetail",method:"post",params:e})}function O(e){return Object(n["a"])({url:"/employ/free/queryEmployFreeHistory",method:"post",data:e})}function T(e){return Object(n["a"])({url:"/employ/archives/queryEmployFormalList",method:"post",data:e})}function I(e){return Object(n["a"])({url:"/employ/archives/queryEmployHistoryList",method:"post",params:e})}function D(e){return Object(n["a"])({url:"/employ/archives/queryEmployInfo",method:"post",params:e})}function j(e){return Object(n["a"])({url:"/employ/archives/updateBatchFormal",method:"post",data:e})}function N(e){return Object(n["a"])({url:"/employ/archives/updateFormalDelay",method:"post",data:e})}function x(){return Object(n["a"])({url:"/employ/archives/queryAppointCount",method:"post"})}function S(e){return Object(n["a"])({url:"/employ/archives/queryEmployBaseDetail?employId=".concat(e.employId),method:"post"})}function F(e){return Object(n["a"])({url:"/employ/archives/getEmployBaseDetail",method:"post",params:e})}function E(e){return Object(n["a"])({url:"/employ/archives/queryEmployWorkCount",method:"post",params:e})}function L(e){return Object(n["a"])({url:"/employ/archives/queryLastEmployChangeRecord",method:"post",params:e})}function _(e){return Object(n["a"])({url:"/employ/archives/queryEmployInfoContractPage",method:"post",data:e})}function k(e){return Object(n["a"])({url:"/employ/archives/operateEmployInfoContract",method:"post",data:e})}function P(e){return Object(n["a"])({url:"/employ/archives/updateEmployInfoContract",method:"post",data:e})}function $(e){return Object(n["a"])({url:"/employ/archives/exportEmployInfoContract",method:"post",data:e})}function U(e){return Object(n["a"])({url:"/employ/archives/checkSpecialDate",method:"post",data:e})}function R(e){return Object(n["a"])({url:"/employ/free/queryNewEmployFreeDetail",method:"post",params:e})}function A(e){return Object(n["a"])({url:"/employ/archives/checkFlow",method:"post",params:e})}function q(e){return Object(n["a"])({url:"/employ/archives/exportEmploy",method:"post",data:e})}function B(e){return Object(n["a"])({url:"/system/org/queryOrgMoney?employType=".concat(e.employType),method:"post"})}function M(e){return Object(n["a"])({url:"/employ/activity/getNewEmployList",method:"post",data:e})}function z(e){return Object(n["a"])({url:"/employ/activity/getReductionEmployList",method:"post",data:e})}function V(e){return Object(n["a"])({url:"/employ/activity/getPositiveEmployList",method:"post",data:e})}function Z(e){return Object(n["a"])({url:"/employ/activity/exportPositiveEmployExcel",method:"post",data:e})}function W(e){return Object(n["a"])({url:"/employ/activity/exportNewEmployExcel",method:"post",data:e})}function X(e){return Object(n["a"])({url:"/employ/activity/exportReductionEmployExcel",method:"post",data:e})}function Y(e){return Object(n["a"])({url:"/business/client/queryClientCompanySelectListByLike",method:"post",params:e})}function J(e){return Object(n["a"])({url:"/business/contract/queryContractSelectByOrgIdANDClientCompanyIdOnEmploy",method:"post",params:e})}function Q(e){return Object(n["a"])({url:"/business/client/queryClientCompanyWorkplaceListByLike",method:"post",params:e})}function G(e){return Object(n["a"])({url:"/employ/activity/getaddOrLeaveEmployList",method:"post",data:e})}function H(e){return Object(n["a"])({url:"/employ/two/updChangeLeave",method:"post",data:e})}function K(e){return Object(n["a"])({url:"/employ/two/updChangeEmployType",method:"post",data:e})}function ee(e){return Object(n["a"])({url:"/employ/two/updChangeZhuanOrg",method:"post",data:e})}function te(e){return Object(n["a"])({url:"/employ/two/updChangeTiaoGang",method:"post",data:e})}function re(e){return Object(n["a"])({url:"/employ/two/exportUnFormalEmployChangeFinanceList",method:"post",data:e})}function ne(e){return Object(n["a"])({url:"/employ/two/getTwoDetail",method:"get",params:e})}function ae(e){return Object(n["a"])({url:"/system/user/queryUserSelectListByCondition",method:"post",params:e})}function oe(e){return Object(n["a"])({url:"/employ/archives/queryEmployRosterList",method:"post",data:e})}function ie(e){return Object(n["a"])({url:"/employ/archives/exportEmployRoster",method:"post",data:e})}function se(e){return Object(n["a"])({url:"/employ/archives/queryRosterList",method:"post",data:e})}function ue(e){return Object(n["a"])({url:"/employ/archives/exportRoster",method:"post",data:e})}function le(e){return Object(n["a"])({url:"/employ/free/exportEmployFree",method:"post",data:e})}function ce(e){return Object(n["a"])({url:"/employ/rosterrealtime/getLastContrastInfo",method:"get",data:e})}function de(e){return Object(n["a"])({url:"/employ/rosterrealtime/exportContrastExcel",method:"get",data:e})}}}]);