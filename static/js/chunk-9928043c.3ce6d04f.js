(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9928043c"],{"011d":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("el-form",{ref:"formInline",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formInline}},[n("el-form-item",{attrs:{label:"集团名称"}},[n("el-input",{attrs:{maxlength:"50",placeholder:"请输入集团名称/编号",clearable:""},model:{value:t.formInline.keyword,callback:function(e){t.$set(t.formInline,"keyword",e)},expression:"formInline.keyword"}})],1),n("el-form-item",{attrs:{label:"集团与公司的关系"}},[n("el-select",{attrs:{clearable:""},model:{value:t.formInline.clientRelationType[0],callback:function(e){t.$set(t.formInline.clientRelationType,0,e)},expression:"formInline.clientRelationType[0]"}},t._l(t.clientRelationType,(function(t){return n("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)],1),n("el-form-item",{attrs:{label:"是否签订框架协议"}},[n("el-select",{attrs:{clearable:""},model:{value:t.formInline.isFrameContract,callback:function(e){t.$set(t.formInline,"isFrameContract",e)},expression:"formInline.isFrameContract"}},t._l(t.YesOrNo,(function(t){return n("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})})),1)],1),n("div",{staticClass:"right-btn"},[n("el-button",{directives:[{name:"has",rawName:"v-has",value:"client.group.add",expression:"'client.group.add'"}],staticClass:"but-91",on:{click:t.toNewGroup}},[t._v("新增")]),n("el-button",{staticClass:"but-91",on:{click:t.emptyBtn}},[t._v("重置")]),n("el-button",{directives:[{name:"has",rawName:"v-has",value:"client.group.list",expression:"'client.group.list'"}],staticClass:"but-91",on:{click:function(e){return t.queryGroupList("formInline")}}},[t._v("查询")])],1)],1),n("div",{staticClass:"table-min"},[n("el-table",{ref:"tableRef",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:t.groupListData,size:"medium",height:"550px","header-cell-style":{background:"#fff",color:"#333","text-align":"center"}},on:{"sort-change":t.onSortChange}},[n("el-table-column",{attrs:{type:"index",label:"序号",fixed:"",width:"140",align:"center",index:t.indexMethod}}),n("el-table-column",{attrs:{prop:"clientGroup.clientGroupId",label:"集团编号",width:"180",align:"left"}}),n("el-table-column",{attrs:{label:"集团名称",width:"200",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("zm-tooltip",{staticClass:"wid190",attrs:{id:e.row.clientGroup.clientGroupId,content:e.row.clientGroup.clientGroupName,refName:"supplierName"},on:{click:t.toDetails}})]}}])}),n("el-table-column",{attrs:{sortable:"custom",label:"集团与下属公司的关系",width:"240",align:"left",prop:"client_relation_type"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("relationClass")(e.row.clientGroup.clientRelationType,t.clientRelationType)))])]}}])}),n("el-table-column",{attrs:{label:"是否签订框架协议",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("relationClass")(e.row.clientGroup.isFrameContract,t.YesOrNo)))])]}}])}),n("el-table-column",{attrs:{sortable:"custom",label:"下属公司",width:"140",prop:"clientCompanyCount",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.seeSubsidiary(e.row.clientGroup.clientGroupId,1)}}},[t._v(t._s(t.groupListData[e.$index].clientCompanyCount)+"家")])]}}])}),n("el-table-column",{attrs:{sortable:"custom",label:"执行中合同",width:"160",prop:"contractRunCount",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:null==e.row.contractRunNameTips||""==e.row.contractRunNameTips,placement:"top"}},[n("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.toArr(e.row.contractRunNameTips))},slot:"content"}),n("span",{staticClass:"adorn"},[t._v(t._s(e.row.contractRunCount)+"份")])])]}}])}),n("el-table-column",{attrs:{sortable:"custom",label:"累计合同",width:"160",prop:"contractTotalCount",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:null==e.row.contractTotalNameTips||""==e.row.contractTotalNameTips,placement:"top"}},[n("span",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.toArr(e.row.contractTotalNameTips))},slot:"content"}),n("span",{staticClass:"adorn"},[t._v(t._s(e.row.contractTotalCount)+"份")])])]}}])}),n("el-table-column",{attrs:{label:"操作",fixed:"right",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{directives:[{name:"has",rawName:"v-has",value:"client.group.info",expression:"'client.group.info'"}],staticClass:"customBtn",staticStyle:{"margin-right":"10px"},on:{click:function(n){return t.toEditPage(e.row)}}},[t._v("详情")]),n("el-dropdown",{directives:[{name:"has",rawName:"v-has",value:"client.group.info",expression:"'client.group.info'"}],on:{command:t.handleCommand}},[n("span",{directives:[{name:"has",rawName:"v-has",value:"client.group.edit,client.group.delete",expression:"'client.group.edit,client.group.delete'"}],staticClass:"customBtn",attrs:{size:"medium",type:"primary"}},[t._v(" 更多 "),n("i",{staticClass:"el-icon-caret-bottom"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{directives:[{name:"has",rawName:"v-has",value:"client.group.edit",expression:"'client.group.edit'"}],attrs:{command:t.beforeHandleCommand(e.row,"a")}},[t._v(" 编辑 ")]),n("el-dropdown-item",{directives:[{name:"has",rawName:"v-has",value:"client.group.delete",expression:"'client.group.delete'"}],attrs:{command:t.beforeHandleCommand(e.row,"b")}},[t._v(" 删除 ")])],1)],1)]}}])})],1),n("el-dialog",{attrs:{title:"查看下属公司","close-on-click-modal":!1,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.handleClose}},[n("el-table",{attrs:{data:t.subsidiaryListData,border:""}},[n("el-table-column",{attrs:{type:"index",label:"序号",fixed:"",width:"60",align:"center",index:t.indexMethoddialog}}),n("el-table-column",{attrs:{prop:"clientCompany.clientCompanyName",label:"公司名称",width:"250"}}),n("el-table-column",{attrs:{label:"执行中合同",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:null==e.row.contractRunNameTips||""==e.row.contractRunNameTips,placement:"top"}},[n("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.toArr(e.row.contractRunNameTips))},slot:"content"}),n("span",{staticClass:"adorn"},[t._v(t._s(e.row.contractRunCount)+"份")])])]}}])}),n("el-table-column",{attrs:{label:"累计合同",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:null==e.row.contractTotalNameTips||""==e.row.contractTotalNameTips,placement:"top"}},[n("span",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.toArr(e.row.contractTotalNameTips))},slot:"content"}),n("span",{staticClass:"adorn"},[t._v(t._s(e.row.contractTotalCount)+"份")])])]}}])})],1),n("div",{staticClass:"pagination-min"},[n("el-pagination",{attrs:{"current-page":t.modalCurrentPage,"page-sizes":[15,30,50],"page-size":t.modalPageSize,layout:"total,sizes,prev,pager,next,jumper",total:t.dialogPaginationData.rowCount},on:{"size-change":t.dialogHandleSizeChange,"current-change":t.dialogHandleCurrentChange,"update:currentPage":function(e){t.modalCurrentPage=e},"update:current-page":function(e){t.modalCurrentPage=e},"update:pageSize":function(e){t.modalPageSize=e},"update:page-size":function(e){t.modalPageSize=e}}})],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("关 闭")])],1)],1)],1),n("div",{staticClass:"pagination-min"},[n("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[15,30,50],"page-size":t.pageSize,layout:"total,sizes,prev,pager,next,jumper",total:t.paginationData.rowCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e}}})],1)],1)},i=[],o=n("b85c"),r=n("5530"),l=(n("fb6a"),n("159b"),n("a434"),n("ac1f"),n("1276"),n("a15b"),n("23ba")),s=n("5f98"),c=(n("ed08"),n("8952")),u=n("2f62"),p={name:"GroupList",components:{zmTooltip:c["a"]},data:function(){return{modalCurrentPage:1,modalPageSize:15,formInline:{clientRelationType:[],displays:[],isFrameContract:"",keyword:""},sortData:[],currentClientGroupId:"",groupListData:[],dialogFormVisible:!1,formLabelWidth:"120px",subsidiaryListData:[],paginationData:{},dialogPaginationData:{},currentPage:1,pageSize:15,pageIndex:1}},computed:Object(r["a"])(Object(r["a"])({},Object(u["e"])("listCacheFlag",["isReloadGPLT"])),{},{clientRelationType:function(){return this.$store.state.baseData.baseDataOptionList.IT_CRET},YesOrNo:function(){return this.$store.state.baseData.baseDataOptionList.IS_AGRE}}),beforeRouteEnter:function(t,e,n){n((function(t){console.log(t.isReloadGPLT,"是否是新增或是编辑页面"),t.isReloadGPLT&&(t.pageIndex=1,t.groupList(t.pageIndex),t.CHANGE_GPLT_STATUS(!1))}))},activated:function(){var t=this;this.$nextTick((function(){t.$refs.tableRef.doLayout()}))},mounted:function(){this.groupList(this.pageIndex)},filters:{relationClass:function(t,e){var n,a=Object(o["a"])(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.value==t)return i.text}}catch(r){a.e(r)}finally{a.f()}},ellipsis:function(t){return t?t.length>6?t.slice(0,6)+"...":t:""}},methods:Object(r["a"])(Object(r["a"])({},Object(u["d"])("listCacheFlag",["CHANGE_GPLT_STATUS"])),{},{indexMethod:function(t){return this.pageSize*this.paginationData.pageIndex+t-this.pageSize+1},indexMethoddialog:function(t){return this.modalPageSize*this.dialogPaginationData.pageIndex+t-this.modalPageSize+1},handleClose:function(){this.modalCurrentPage=1,this.modalPageSize=15},groupList:function(t){var e=this;""==this.formInline.clientRelationType[0]&&(this.formInline.clientRelationType=[]),Object(l["h"])({input:this.formInline,nextToken:"",pageEnd:0,pageIndex:t,pageSize:this.pageSize,pageStart:0}).then((function(t){e.paginationData=t,e.groupListData=t.result}))},queryGroupList:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;e.groupList()}))},emptyBtn:function(){this.formInline.keyword="",this.formInline.clientRelationType=[],this.formInline.isFrameContract="",this.formInline.displays=[],this.groupList()},toNewGroup:function(){this.$router.push({path:"saveUpdateGroup",query:{}})},toDetails:function(t,e){Object(s["a"])("client.group.info")&&this.$router.push({path:"groupDetails",query:{clientGroupId:t}})},seeSubsidiary:function(t){var e=this;this.currentClientGroupId=t,Object(s["a"])("client.group.info")&&Object(l["c"])({input:{clientGroupId:t},nextToken:"",pageEnd:0,pageIndex:this.modalCurrentPage,pageSize:this.modalPageSize,pageStart:0}).then((function(t){e.dialogPaginationData=t,e.subsidiaryListData=t.result,e.dialogFormVisible=!0}))},toEditPage:function(t){this.$router.push({path:"groupDetails",query:{clientGroupId:t.clientGroup.clientGroupId}})},beforeHandleCommand:function(t,e){return{item:t,command:e}},handleCommand:function(t){var e=this;"a"==t.command?this.$router.push({path:"/customer/editGroup",query:{clientGroupId:t.item.clientGroup.clientGroupId}}):"b"==t.command&&this.$confirm("此操作将永久删除该数据，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["j"])({clientGroupId:t.item.clientGroup.clientGroupId}).then((function(t){e.groupList(),e.$message({type:"success",message:"删除成功!"})}))})).catch((function(t){}))},onSortChange:function(t){var e=this;this.sortData=[];var n="";n="ascending"===t.order?"asc":"desc";var a={display:n,field:t.prop};0===this.sortData.length?this.sortData.push(a):this.sortData.forEach((function(t,n){if(t.field===a.field){if(t.display===a.display)return void e.sortData.splice(n,1);e.sortData.splice(n,1),e.sortData.push(a)}else e.sortData.push(a)})),this.formInline.displays=this.sortData,this.groupList()},dialogHandleSizeChange:function(){this.seeSubsidiary(this.currentClientGroupId)},dialogHandleCurrentChange:function(){this.seeSubsidiary(this.currentClientGroupId)},handleSizeChange:function(){this.groupList()},handleCurrentChange:function(t){this.groupList(t)},toArr:function(t){var e=(t||"").split(","),n=e.join("<br/>");return n}})},d=p,m=(n("0f19"),n("2877")),f=Object(m["a"])(d,a,i,!1,null,"5b19dcfe",null);e["default"]=f.exports},"0f19":function(t,e,n){"use strict";n("d1af")},1:function(t,e){},2:function(t,e){},"23ba":function(t,e,n){"use strict";n.d(e,"h",(function(){return i})),n.d(e,"l",(function(){return o})),n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return s})),n.d(e,"g",(function(){return c})),n.d(e,"j",(function(){return u})),n.d(e,"e",(function(){return p})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return m})),n.d(e,"k",(function(){return f})),n.d(e,"b",(function(){return g}));var a=n("b775");n("ba0f");function i(t){return Object(a["a"])({url:"/business/client/queryClientGroupList",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/business/client/saveOrUpdateClientGroup",method:"post",data:t})}function r(t){return Object(a["a"])({url:"/business/client/queryClientCompanySelectList",method:"post",params:t})}function l(t){return Object(a["a"])({url:"/business/client/queryClientCompanyRelationListByGroupId",method:"post",data:t})}function s(t){return Object(a["a"])({url:"/business/client/checkReClientGroupName",method:"post",params:t})}function c(t){return Object(a["a"])({url:"/business/client/queryClientGroupInfo",method:"post",params:t})}function u(t){return Object(a["a"])({url:"/business/client/removeClientGroup",method:"post",params:t})}function p(t){return Object(a["a"])({url:"/business/client/queryClientCompanyWorkplaceInfo",method:"post",params:t})}function d(t){return Object(a["a"])({url:"/business/client/queryClientCompanyWorkplaceList",method:"post",data:t})}function m(t){return Object(a["a"])({url:"/business/client/removeClientCompanyWorkplace",method:"post",params:t})}function f(t){return Object(a["a"])({url:"/business/client/saveOrUpdateClientCompanyWorkplace",method:"post",data:t})}function g(t){return Object(a["a"])({url:"/business/client/queryAllClientCompanySelectList",method:"post",data:t})}},3:function(t,e){},4:function(t,e){},5:function(t,e){},d1af:function(t,e,n){}}]);