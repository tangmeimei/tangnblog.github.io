(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e9b9e"],{"8f82":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"toms-container"},[a("div",{staticClass:"toms-list-searchWrap"},[a("zm-Search",{ref:"search",attrs:{inputList:t.inputListConfig,btnConfig:t.btnConfig},on:{groupRemoteMethod:t.groupRemoteMethod,search:t.search,reset:t.resetTable,exportFileFn:t.exportFileFn}})],1),a("div",{staticClass:"toms-list-tableWrap"},[a("zm-table",{staticStyle:{width:"100%","margin-top":"-20px"},attrs:{tableData:t.tableData,columns:t.columns,height:"542px",currentPage:t.pageData.pageIndex,pageSize:t.pageData.pageSize,total:t.pageData.pageCount,sizeList:t.sizeList,paginationData:t.paginationData},on:{renewFn:t.renewFn,editFn:t.editFn,stopOrRecoverFn:t.stopOrRecoverFn,handleCurrentChange:t.handleCurrentChange,sortChange:t.sortChange,handleSizeChange:t.handleSizeChange}})],1),a("renew-modal",{attrs:{openRenewModal:t.openRenewModal,formData:t.formData,changeRenewOpenStatus:t.changeRenewOpenStatus}}),a("edit-modal",{attrs:{openEditModal:t.openEditModal,formData:t.formData,changeEditOpenStatus:t.changeEditOpenStatus}}),a("stop-modal",{attrs:{openStopModal:t.openStopModal,formData:t.formData,changeStopOpenStatus:t.changeStopOpenStatus}}),a("recover-modal",{attrs:{openRecoverModal:t.openRecoverModal,formData:t.formData,changeRecoverOpenStatus:t.changeRecoverOpenStatus}})],1)},r=[],i=a("1da1"),o=a("5530"),s=(a("96cf"),a("ac1f"),a("841c"),a("d81d"),a("159b"),a("a434"),a("4db4")),c=a("8418a"),l=a("c5be"),p=a("c728"),d=a("20e2"),h=a("a937"),u=(a("fb6a"),a("ed08")),g=a("5f98"),m=a("4360"),f=m["a"].state.baseData.baseDataOptionList,b=function(t){return[{type:"cascader-input",bind_key:"orgId",label:"所属部门",optionList:m["a"].state.baseData.orgTreeData[0].children,span:6,inputWidth:280,checkStrictly:!0,propLabel:"orgName",propValue:"orgId"},{type:"select-input",bind_key:"employType",label:"员工类型",optionList:f.IT_EMTY,inputWidth:280,span:6},{type:"select-input",bind_key:"contractType",label:"合同类型",optionList:f.IT_HRCO,inputWidth:280,span:6},{type:"select-input",bind_key:"contractStatus",label:"合同状态",optionList:f.IT_HTZT,inputWidth:280,span:6},{type:"text-input",bind_key:"keyWord",label:"工号/姓名",placeholder:"请输入",inputWidth:280,span:6},{type:"text-input",bind_key:"clientCompanyId",label:"所属客户方",labelWidth:60,inputWidth:280,span:6},{type:"date-input",inputWidth:280,span:6,label:"合同日期",bind_key:"startDate",datePickerType:"daterange"},{type:"select-input",bind_key:"employStateList",label:"员工状态",inputWidth:280,span:6,optionList:f.IT_EPLY,multiple:!0,vModel:["IT_EPLY_001","IT_EPLY_002","IT_EPLY_004"]},{type:"radio-input",bind_key:"isChecked",inputLabel:"最近一个月到期的合同",span:15,inputWidth:"auto",labelWidth:"0"}]},y={span:24,customList:[{role:"employ.contract.export",customBtnText:"导出",changeFn:"exportFileFn"}],leftBtnHidden:!Object(g["a"])("employ.contract.list")},D=function(t){return[{label:"序号",type:"index",fixed:"left",width:"50px"},{label:"工号",fixed:"left",prop:"employNo",minWidth:"100px"},{label:"姓名",fixed:"left",prop:"employName",minWidth:"100px",headerAlign:"center",align:"left"},{label:"所属部门",prop:"orgCn",sortable:"custom",minWidth:"200px",headerAlign:"center",align:"left"},{label:"所属客户方",prop:"clientCompanyIdCn",sortable:"custom",minWidth:"200px",headerAlign:"center",align:"left"},{label:"员工类型",prop:"employTypeCn",sortable:"custom",minWidth:"110px",headerAlign:"center",align:"left"},{label:"公司岗位",prop:"companyJobCn",sortable:"custom",minWidth:"150px",headerAlign:"center",align:"left"},{label:"合同类型",prop:"contractTypeCn",sortable:"custom",minWidth:"100px",headerAlign:"center",align:"left"},{label:"第几次签订",prop:"employContractNum",sortable:"custom",minWidth:"120px",headerAlign:"center",align:"left"},{label:"合同开始日期",prop:"contractBeginTime",sortable:"custom",minWidth:"130px",kind:"render",render:function(t,e){var a=e.row.contractBeginTime||"",n=a.slice(0,a.indexOf("T"));return t("span",n)},headerAlign:"center",align:"left"},{label:"合同结束日期",prop:"contractEndTime",sortable:"custom",minWidth:"130px",kind:"render",render:function(t,e){var a=e.row.contractEndTime||"",n=a.slice(0,a.indexOf("T"));return t("span",n)},headerAlign:"center",align:"left"},{label:"合同期限",prop:"contractTimeCn",minWidth:"100px",sortable:"custom",headerAlign:"center",align:"center"},{label:"入职日期",prop:"contractStartTime",minWidth:"110px",kind:"render",render:function(t,e){var a=e.row.contractStartTime||"",n=a.slice(0,a.indexOf("T"));return t("span",n)},headerAlign:"center",align:"left"},{label:"员工状态",prop:"employStateCn",minWidth:"100px",sortable:"custom",headerAlign:"center",align:"left"},{label:"合同状态",prop:"contractStatusCn",minWidth:"110px",sortable:"custom",headerAlign:"center",align:"left"},{label:"续签开始日期",prop:"contractDelayBeginTime",minWidth:"110px",kind:"render",render:function(t,e){var a=e.row.contractDelayBeginTime||"",n=a.slice(0,a.indexOf("T"));return t("span",n)},headerAlign:"center",align:"left"},{label:"续签结束日期",prop:"contractDelayEndTime",minWidth:"110px",kind:"render",render:function(t,e){var a=e.row.contractDelayEndTime||"",n=a.slice(0,a.indexOf("T"));return t("span",n)},headerAlign:"center",align:"left"},{label:"续期年限",prop:"contractDelayTimeCn",minWidth:"80px",headerAlign:"center",align:"left"},{label:"操作",fixed:"right",kind:"formatBtn",width:"120px",moreBtnRoles:"employ.contract.edit,employ.contract.operation",firstBtn:{text:"续签",role:"employ.contract.renew",fn:"renewFn"},btnList:[{text:"编辑",fn:"editFn",role:"employ.contract.edit"},{text:"中止",fn:"stopOrRecoverFn",role:"employ.contract.operation",textFn:function(t){return t.contractStatus&&"IT_HTZT_003"===t.contractStatus?"恢复":"中止"}}]}]},x=a("a417"),T=a("dc27"),S=a("2f62"),L={name:"staffContract",components:{zmTable:d["a"],zmSearch:h["a"],renewModal:s["a"],editModal:c["a"],stopModal:l["a"],recoverModal:p["a"]},data:function(){return{openRenewModal:!1,openEditModal:!1,openStopModal:!1,openRecoverModal:!1,formData:{},btnConfig:y,tableData:[],columns:D(this),pageData:{pageIndex:1,pageSize:15,pageCount:0},searchData2:{employStateList:["IT_EPLY_001","IT_EPLY_002","IT_EPLY_004"]},downloadCondition:{},paginationData:{pageIndex:1},sortData:[],sizeList:[15,30,50],cityOptionList:[],groupList:[],industryTreeData:[],orgList:[]}},computed:Object(o["a"])({inputListConfig:function(){return b(this)}},Object(S["e"])({staffContractSearchData:function(t){return t.hr.staffContractSearchData}})),watch:{$route:function(){this.$refs.search.modifySearchData([{key:"employStateList",value:["IT_EPLY_001","IT_EPLY_002","IT_EPLY_004"]}]),this.getEmployList(this.searchData2)}},mounted:function(){this.$refs.search.modifySearchData([{key:"employStateList",value:["IT_EPLY_001","IT_EPLY_002","IT_EPLY_004"]}]);var t={employStateList:["IT_EPLY_001","IT_EPLY_002","IT_EPLY_004"]};this.getEmployList(t),this.getIndustryData(),this.queryOrgData()},methods:{getIndustryData:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(x["u"])();case 2:a=e.sent,t.industryTreeData=a,t.inputList=b(t);case 5:case"end":return e.stop()}}),e)})))()},groupRemoteMethod:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n={keyword:t},Object(x["t"])(n).then((function(t){var a=t&&t.map((function(t){return{text:t.clientGroupName,value:t.clientGroupId}}));e.groupList=a,e.inputList=b(e)}));case 2:case"end":return a.stop()}}),a)})))()},getEmployList:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t||{},r={input:n},i=Object.assign({},e.pageData,r),i.input.displays=e.sortData,i.input.employTypeFlag="emp_type_001",e.downloadCondition=Object(u["a"])(i),m["a"].commit("hr/SetStaffContractSearchData",i),a.next=9,Object(T["M"])(e.staffContractSearchData);case 9:o=a.sent,e.paginationData.pageIndex=o.pageIndex,e.pageData.pageIndex=o.pageIndex,e.pageData.pageCount=o.rowCount,e.pageData.pageSize=o.pageSize,e.tableData=o.result;case 15:case"end":return a.stop()}}),a)})))()},search:function(t){var e=JSON.parse(JSON.stringify(t));e.orgId&&e.orgId.length?e.orgId=e.orgId[e.orgId.length-1]:e.orgId="",e.isChecked&&(e.isChecked="TRUE"),t.startDate&&t.startDate.length&&(e.startTime=t.startDate[0],e.endTime=t.startDate[1],delete e.startDate),this.searchData2=Object(u["a"])(e),console.log("this.searchData2",this.searchData2),this.getEmployList(e)},handleSizeChange:function(t){this.pageData.pageSize=t,this.getEmployList(this.searchData2)},changeRenewOpenStatus:function(t){this.openRenewModal=t,t||this.getEmployList(this.searchData2)},changeEditOpenStatus:function(t){this.openEditModal=t,t||this.getEmployList(this.searchData2)},changeStopOpenStatus:function(t){this.openStopModal=t,t||this.getEmployList(this.searchData2)},changeRecoverOpenStatus:function(t){this.openRecoverModal=t,t||this.getEmployList(this.searchData2)},editFn:function(t){this.openEditModal=!0,this.formData=t},renewFn:function(t){this.openRenewModal=!0,this.formData=t},stopFn:function(t){this.openStopModal=!0,this.formData=t},recoverFn:function(t){this.openRecoverModal=!0,this.formData=t},stopOrRecoverFn:function(t){t.contractStatus&&"IT_HTZT_003"===t.contractStatus?this.recoverFn(t):this.stopFn(t)},exportFileFn:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("准备导出文件",t.downloadCondition),e.next=3,Object(T["p"])(t.downloadCondition);case 3:a=e.sent,200==a.code&&(n=a.msg,console.log(n),r="https://www.tobowork.com//api/tobosoft-toms/commons/exportfile/download?delete=false&fileName="+n,i=document.createElement("a"),i.setAttribute("download",n),i.href=r,document.body.appendChild(i),i.click(),i.remove());case 5:case"end":return e.stop()}}),e)})))()},resetTable:function(){this.pageData.pageIndex=1,this.searchData2={},this.getEmployList(this.searchData2)},handleCurrentChange:function(t){this.pageData.pageIndex=t,this.getEmployList(this.searchData2)},sortChange:function(t){var e=this,a="";a="ascending"===t.order?"asc":"desc";var n={display:a,field:t.prop};0===this.sortData.length?this.sortData.push(n):this.sortData.forEach((function(t,a){if(t.field===n.field){if(t.display===n.display)return void e.sortData.splice(a,1);e.sortData.splice(a,1),e.sortData.push(n)}else e.sortData.push(n)})),this.getEmployList()},queryOrgData:function(){var t=this;Object(x["z"])({}).then((function(e){t.treeSelectArr(e),t.orgList=e}))},treeSelectArr:function(t){var e=this;t.forEach((function(t){0==t.children.length?delete t.children:e.treeSelectArr(t.children)}))}}},w=L,v=a("2877"),_=Object(v["a"])(w,n,r,!1,null,null,null);e["default"]=_.exports}}]);