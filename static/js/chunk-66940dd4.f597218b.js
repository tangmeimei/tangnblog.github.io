(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66940dd4"],{"342a":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.containerLoading,expression:"containerLoading"}],staticClass:"customer-container"},[a("div",{staticClass:"search-wrap"},[a("zm-Search",{ref:"search",attrs:{inputList:e.inputConfig,btnConfig:e.btnConfig},on:{reset:e.resetTable,search:e.searchconvers,employRemote:e.employRemote,clientRemote:e.clientRemote,exportChangeEmploy:e.exportChangeEmploy,exportFin:e.exportFin}})],1),a("div",{staticClass:"tableContent"},[a("zm-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"tableRef",staticStyle:{width:"100%"},attrs:{"header-cell-style":{"text-align":"center"},tableData:e.tableData,columns:e.columnsList,height:"542px",currentPage:e.pageData.pageIndex,pageSize:e.pageData.pageSize,total:e.pageData.pageCount,sizeList:e.sizeList},on:{viewFn:e.viewFn,handleCurrentChange:e.handleCurrentChange,sortChange:e.sortChange,handleSizeChange:e.handleSizeChange}})],1),a("el-dialog",{attrs:{title:"员工变动详情","close-on-click-modal":!1,visible:e.employChange.detailVisible,width:"750px","destroy-on-close":!0,"custom-class":"employChangeClass"},on:{"update:visible":function(t){return e.$set(e.employChange,"detailVisible",t)}}},[a("detailSearch",{attrs:{detailData:e.detailData}}),a("div",{staticClass:"employChangeInfo"},[a("div"),a("div",[e._v(" 员工变动前信息 ")])]),a("detailInfo",{attrs:{detailData:e.detailData}}),a("div",{staticClass:"employChangeInfo"},[a("div"),a("div",[e._v(" 变动后员工信息 ")])]),a(e.changeDetail,{tag:"component",attrs:{detailData:e.detailData}}),a("div",{staticClass:"employChangeInfo"},[a("div"),a("div",[e._v(" 操作人信息 ")])]),a("detailUpdate",{attrs:{detailData:e.detailData}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.employChange.detailVisible=!1}}},[e._v("关闭")])],1)],1)],1)},i=[],r=a("5530"),o=a("1da1"),l=(a("159b"),a("a434"),a("d81d"),a("99af"),a("96cf"),a("8cc7")),s=a("a937"),c=(a("ac1f"),a("1276"),a("498a"),a("ed08"),a("5f98")),p=function(e){e.$store.state.baseData.baseDataOptionList.IT_EMTY;var t=e.$store.state.baseData.jobTreeDate;return[{type:"cascader-input",bind_key:"orgId",label:"所属部门",optionList:e.$store.state.baseData.orgTreeData[0].children,span:6,checkStrictly:!0,propLabel:"orgName",propValue:"orgId",inputWidth:230},{type:"remote-loading-input",bind_key:"employClientId",label:"所属客户",span:6,inputWidth:230,optionList:e.clientOptions,loading:e.clientLoading,remoteMethod:"clientRemote"},{type:"cascader-input",bind_key:"employJob",label:"公司岗位",span:6,optionList:t,checkStrictly:!0,inputWidth:230,propLabel:"text",propValue:"value"},{type:"text-input",bind_key:"employKeyword",label:"工号/姓名",placeholder:"工号或姓名",span:6,inputWidth:230,labelWidth:90},{type:"date-input",span:6,label:"生效日期",inputWidth:230,bind_key:"updateDt",datePickerType:"daterange",placeholder:"请选择",formatShow:"yyyy-MM-dd"},{type:"select-input",bind_key:"oneType",label:"一线变动",inputWidth:230,span:6,optionList:e.firstLineList}]},d=function(e){return{span:24,customList:[{customBtnText:"导出",changeFn:"exportChangeEmploy",role:"employ.two.export",loading:e.exportLoading},{customBtnText:"财务导出",changeFn:"exportFin",role:"employ.two.exportf",loading:e.exportFinLoading}],leftBtnHidden:!Object(c["a"])("employ.two.list")}},u=function(e){return[{label:"序号",type:"index",fixed:"left",width:"50px",kind:"render",render:function(t,a){var n=a.$index+1,i=(e.pageData.pageIndex-1)*e.pageData.pageSize;return t("span",n+i)}},{label:"入职时间",prop:"employEnterDate",minWidth:120},{label:"变动生效日期",minWidth:120,prop:"updDate"},{label:"变动类型",prop:"typeCn",minWidth:120,align:"left"},{label:"流程主题",prop:"taskName",sortable:"custom",minWidth:120,align:"left"},{label:"变动详情",minWidth:150,align:"left",kind:"render",render:function(e,t){var a=t.row.diffFields?t.row.diffFields.split(";:;"):[],n="",i=a.length;return a.forEach((function(e,t){e&&e.trim()&&(n+=e,t<i-1&&(n+="\n"))})),e("el-tooltip",{props:{placement:"top",effect:"light"}},[e("div",{slot:"content",style:{whiteSpace:"pre-wrap",lineHeight:"25px"}},n),e("el-tooltip",{props:{placement:"top",disabled:!0}},[e("div",{style:{width:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},n)])])},showOverflowTooltip:!1},{label:"工号",sortable:"custom",fixed:"left",minWidth:100,prop:"employNo"},{label:"姓名",sortable:"custom",align:"left",fixed:"left",minWidth:100,prop:"employName"},{label:"原公司部门",minWidth:150,prop:"oldOrg",align:"left"},{label:"新公司部门",prop:"newOrg",align:"left",minWidth:150},{label:"原公司岗位",prop:"oldCompanyJob",align:"left",minWidth:120},{label:"新公司岗位",prop:"newCompanyJob",align:"left",minWidth:120},{label:"原公司岗位级别",minWidth:150,prop:"oldLeave",align:"left"},{label:"新公司岗位级别",minWidth:150,prop:"newLeave",align:"left"},{label:"原客户方",prop:"oldClient",minWidth:100,align:"left"},{label:"新客户方",prop:"newClient",minWidth:100,align:"left"},{label:"原客户方岗位",prop:"oldJob",minWidth:120,align:"left"},{label:"新客户方岗位",prop:"newJob",minWidth:120,align:"left"},{label:"原客户方级别",prop:"oldPayLeave",minWidth:150,align:"left"},{label:"新客户方级别",prop:"newPayLeave",minWidth:150,align:"left"},{label:"原员工类型",prop:"oldEmployType",minWidth:120,align:"left"},{label:"新员工类型",prop:"newEmployType",minWidth:120,align:"left"},{label:"备注",prop:"remark",minWidth:120,align:"left"},{label:"操作",fixed:"right",width:"120px",kind:"formatBtn",firstBtn:{text:"详情",role:"employ.flow.info",fn:"viewFn"}}]},h=a("dc27"),g=a("a417"),m=a("f6b0"),f=(a("61f7"),a("2f62")),b=a("8285"),y=a("6967"),v=a("596c"),w=a("f9cd"),x=a("f8af"),D={name:"employChangeList",components:{zmTable:l["a"],zmSearch:s["a"],detailSearch:b["a"],detailInfo:y["a"],detailUpdate:v["a"],detailType:w["a"]},data:function(){return{tableData:[],optionList:[],pageData:{pageIndex:1,pageSize:15,pageCount:0},sortData:[],searchData:{},sizeList:[15,30,50],employOptions:[],employLoading:!1,clientOptions:[],clientLoading:!1,tableLoading:!1,conversionsList:[],exportLoading:!1,employChange:{employChangeVisible:!1,detailVisible:!1},changeEndInfo:"",userKey:"",orgId:"",firstLineList:[],secLineList:[],levelOptionsList:[],containerLoading:!1,jobLevelCode:"",isShow:!0,exportFinLoading:!1,detailData:{},changeDetail:""}},computed:{columnsList:function(){return u(this)},inputConfig:function(){return p(this)},btnConfig:function(){return d(this)}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getEmployAddList();case 2:return t.next=4,e.getLevelData();case 4:e.getFirst(),e.getSec();case 6:case"end":return t.stop()}}),t)})))()},mounted:function(){},activated:function(){var e=this;this.$nextTick((function(){e.$refs.tableRef.doLayoutTable()}))},watch:{changeEndInfo:{handler:function(){console.log("当前是查看详情")}}},methods:Object(r["a"])(Object(r["a"])({},Object(f["d"])("entryCfmSalary",["CHANGE_EDIT_PROCESS_STATUS","CHANGE_LIST_PAGE_STAUTS"])),{},{getEmployAddList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,i,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e||{},i={input:n},t.tableLoading=!0,r=Object.assign({},t.pageData,i),r.input.displays=t.sortData,a.prev=5,a.next=8,Object(x["h"])(r);case 8:o=a.sent,t.pageData.pageIndex=o.pageIndex,t.pageData.pageCount=o.rowCount,t.tableData=o.result,a.next=16;break;case 14:a.prev=14,a.t0=a["catch"](5);case 16:return a.prev=16,t.tableLoading=!1,a.finish(16);case 19:case"end":return a.stop()}}),a,null,[[5,14,16,19]])})))()},searchconvers:function(e){var t=JSON.parse(JSON.stringify(e));console.log("请求查询的参数对象：",t),t.orgId&&t.orgId.length?t.orgId=t.orgId[t.orgId.length-1]:delete t.orgId,t.employJob&&t.employJob.length?t.employJob=t.employJob[t.employJob.length-1]:delete t.employJob,t.updateDt&&t.updateDt.length?(t.startDt=new Date(t.updateDt[0]),t.endDt=new Date(t.updateDt[1])):(delete t.updateDt,delete t.endDt,delete t.startDt),t.oneType||delete t.oneType,t.twoType||delete t.twoType,this.pageData.pageIndex=1,this.searchData=t,this.getEmployAddList(t)},handleSizeChange:function(e){this.pageData.pageIndex=1,this.pageData.pageSize=e,this.getEmployAddList(this.searchData)},resetTable:function(){this.pageData.pageIndex=1,this.searchData={},this.getEmployAddList(this.searchData)},handleCurrentChange:function(e){this.pageData.pageIndex=e,this.getEmployAddList(this.searchData)},sortChange:function(e){var t=this;this.sortData=[];var a="";a="ascending"===e.order?"asc":"desc";var n={display:a,field:e.prop};0===this.sortData.length?this.sortData.push(n):this.sortData.forEach((function(e,a){if(e.field===n.field){if(e.display===n.display)return void t.sortData.splice(a,1);t.sortData.splice(a,1),t.sortData.push(n)}else t.sortData.push(n)})),this.getEmployAddList(this.searchData)},employRemote:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("拿到的数据：",e),t.employLoading=!0,a.prev=2,a.next=5,Object(g["L"])({keyword:e});case 5:n=a.sent,console.log("查询用户结果",n),t.employOptions=Array.isArray(n)&&n.map((function(e){var t={};return t=Object.assign(t,e,e.userInfo),Object(r["a"])({text:"[".concat(e.userInfo.loginName,"] ").concat(e.userInfo.userName),value:e.userInfo.userId},t)})),a.next=12;break;case 10:a.prev=10,a.t0=a["catch"](2);case 12:return a.prev=12,t.employLoading=!1,a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[2,10,12,15]])})))()},clientRemote:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("拿到的数据：",e),t.clientLoading=!0,a.prev=2,a.next=5,Object(m["l"])({input:{keyword:e,clientType:"IT_CLTP_001"}});case 5:n=a.sent,console.log("查询所属客户",n),t.clientOptions=Array.isArray(n.result)&&n.result.map((function(e){return{text:"".concat(e.clientCompany.clientCompanyName),value:e.clientCompany.clientCompanyId}})),a.next=12;break;case 10:a.prev=10,a.t0=a["catch"](2);case 12:return a.prev=12,t.clientLoading=!1,a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[2,10,12,15]])})))()},viewFn:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log("点击查看详情：",e),"true"!==e.flag){a.next=8;break}n={taskInstanceId:e.taskId,flowName:e.flowName,version:e.version,nodeInstanceId:Array.isArray(e.nodeList)?e.nodeList[e.nodeList.length-1]:e.nodeList},console.log("查看详情的taskObj：",n),n=encodeURIComponent(JSON.stringify(n)),t.$router.push({path:"/workbench/infoChangeDetailsSSC/".concat(e.taskId),query:{taskObj:n}}),a.next=37;break;case 8:return a.prev=8,t.containerLoading=!0,a.next=12,Object(h["f"])({id:e.id});case 12:i=a.sent,console.log("请求详情结果：",i),t.detailData=i.data,a.t0=e.type,a.next="IT_TWOL_001"===a.t0?18:"IT_TWOL_004"===a.t0?20:"IT_TWOL_002"===a.t0?22:"IT_TWOL_006"===a.t0?24:"IT_TWOL_003"===a.t0?26:"IT_TWOL_005"===a.t0?28:29;break;case 18:return t.changeDetail="detailPost",a.abrupt("break",29);case 20:return t.changeDetail="detailLevel",a.abrupt("break",29);case 22:return t.changeDetail="detailDep",a.abrupt("break",29);case 24:return t.changeDetail="detailDep",a.abrupt("break",29);case 26:return t.changeDetail="detailType",a.abrupt("break",29);case 28:t.changeDetail="detailType";case 29:t.employChange.detailVisible=!0,a.next=34;break;case 32:a.prev=32,a.t1=a["catch"](8);case 34:return a.prev=34,t.containerLoading=!1,a.finish(34);case 37:case"end":return a.stop()}}),a,null,[[8,32,34,37]])})))()},getLevelData:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={dateType:"IT_JSJB"},t.prev=1,t.next=4,Object(g["o"])(a);case 4:n=t.sent,e.levelOptionsList=n,t.next=11;break;case 8:throw t.prev=8,t.t0=t["catch"](1),new Error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},getFirst:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={dateType:"IT_XXBG"},t.prev=1,t.next=4,Object(g["o"])(a);case 4:n=t.sent,e.firstLineList=n,t.next=11;break;case 8:throw t.prev=8,t.t0=t["catch"](1),new Error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},getSec:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={dateType:"IT_TWOL"},t.prev=1,t.next=4,Object(g["o"])(a);case 4:n=t.sent,e.secLineList=n,t.next=11;break;case 8:throw t.prev=8,t.t0=t["catch"](1),new Error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},exportChangeEmploy:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n,i,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={displays:e.sortData,input:e.searchData},console.log("查询参数：",a),e.exportLoading=!0,t.prev=3,t.next=6,Object(x["e"])(a);case 6:i=t.sent,console.log("请求导出转正员工结果：",i),"200"===i.code&&(n=i.msg,r="https://www.tobowork.com//api/tobosoft-toms/commons/exportfile/download?delete=false&fileName="+n,o=document.createElement("a"),o.setAttribute("download",n),o.href=r,document.body.appendChild(o),o.click(),o.remove()),t.next=13;break;case 11:t.prev=11,t.t0=t["catch"](3);case 13:return t.prev=13,e.exportLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[3,11,13,16]])})))()},exportFin:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n,i,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={displays:e.sortData,input:e.searchData},console.log("查询参数：",a),e.exportFinLoading=!0,t.prev=3,t.next=6,Object(h["j"])(a);case 6:i=t.sent,console.log("财务导出结果：",i),"200"===i.code&&(n=i.msg,r="https://www.tobowork.com//api/tobosoft-toms/commons/exportfile/download?delete=false&fileName="+n,o=document.createElement("a"),o.setAttribute("download",n),o.href=r,document.body.appendChild(o),o.click(),o.remove()),t.next=13;break;case 11:t.prev=11,t.t0=t["catch"](3);case 13:return t.prev=13,e.exportFinLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[3,11,13,16]])})))()},closeDialog:function(){var e=this;console.log("dialog关闭"),this.changeEndInfo="",this.isShow=!1,this.$nextTick((function(){e.isShow=!0}))},dialogOpend:function(){this.$refs.employChangeInfoForm&&this.$refs.employChangeInfoForm.$refs.employChangeEndInfoData.clearValidate()}})},L=D,C=(a("4cc9"),a("2877")),k=Object(C["a"])(L,n,i,!1,null,"113c0eb8",null);t["default"]=k.exports},"3f5b":function(e,t,a){},"4cc9":function(e,t,a){"use strict";a("3f5b")}}]);