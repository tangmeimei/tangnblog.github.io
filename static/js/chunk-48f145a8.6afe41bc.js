(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48f145a8"],{1:function(t,e){},2:function(t,e){},"23ba":function(t,e,n){"use strict";n.d(e,"h",(function(){return i})),n.d(e,"l",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return s})),n.d(e,"g",(function(){return c})),n.d(e,"j",(function(){return u})),n.d(e,"e",(function(){return p})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return m})),n.d(e,"k",(function(){return f})),n.d(e,"b",(function(){return b}));var a=n("b775");n("ba0f");function i(t){return Object(a["a"])({url:"/business/client/queryClientGroupList",method:"post",data:t})}function r(t){return Object(a["a"])({url:"/business/client/saveOrUpdateClientGroup",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/business/client/queryClientCompanySelectList",method:"post",params:t})}function l(t){return Object(a["a"])({url:"/business/client/queryClientCompanyRelationListByGroupId",method:"post",data:t})}function s(t){return Object(a["a"])({url:"/business/client/checkReClientGroupName",method:"post",params:t})}function c(t){return Object(a["a"])({url:"/business/client/queryClientGroupInfo",method:"post",params:t})}function u(t){return Object(a["a"])({url:"/business/client/removeClientGroup",method:"post",params:t})}function p(t){return Object(a["a"])({url:"/business/client/queryClientCompanyWorkplaceInfo",method:"post",params:t})}function d(t){return Object(a["a"])({url:"/business/client/queryClientCompanyWorkplaceList",method:"post",data:t})}function m(t){return Object(a["a"])({url:"/business/client/removeClientCompanyWorkplace",method:"post",params:t})}function f(t){return Object(a["a"])({url:"/business/client/saveOrUpdateClientCompanyWorkplace",method:"post",data:t})}function b(t){return Object(a["a"])({url:"/business/client/queryAllClientCompanySelectList",method:"post",data:t})}},3:function(t,e){},4:function(t,e){},5:function(t,e){},b15a:function(t,e,n){"use strict";n("b852")},b852:function(t,e,n){},e3d0:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.clientGroupform,rules:t.rules}},[n("el-form-item",{attrs:{label:"集团名称",prop:"clientGroupName"}},[n("el-input",{attrs:{maxlength:"50",clearable:"",placeholder:"请输入集团名称"},model:{value:t.clientGroupform.clientGroupName,callback:function(e){t.$set(t.clientGroupform,"clientGroupName",e)},expression:"clientGroupform.clientGroupName"}})],1),n("el-form-item",{attrs:{label:"与下属公司的关系",prop:"clientRelationType"}},[n("el-select",{attrs:{clearable:""},model:{value:t.clientGroupform.clientRelationType,callback:function(e){t.$set(t.clientGroupform,"clientRelationType",e)},expression:"clientGroupform.clientRelationType"}},t._l(t.clientRelationType,(function(t,e){return n("el-option",{key:e,attrs:{label:t.text,value:t.value}})})),1)],1),n("el-form-item",{attrs:{label:"是否签订框架协议",prop:"isFrameContract"}},[n("el-radio-group",{model:{value:t.clientGroupform.isFrameContract,callback:function(e){t.$set(t.clientGroupform,"isFrameContract",e)},expression:"clientGroupform.isFrameContract"}},t._l(t.YesOrNo,(function(e,a){return n("el-radio",{key:a,attrs:{label:e.value}},[t._v(t._s(e.text))])})),1)],1)],1),t._m(0),n("div",{staticClass:"text-surfacee"},[n("el-card",{staticStyle:{height:"400px"}},[n("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"300px"},attrs:{options:t.editorOption},on:{change:function(e){return t.onEditorChange(e)}},model:{value:t.clientGroupform.clientGroupRemark,callback:function(e){t.$set(t.clientGroupform,"clientGroupRemark",e)},expression:"clientGroupform.clientGroupRemark"}}),n("div",{staticClass:"text-length"},[t._v(t._s(t.currentTextLength)+"/800")])],1)],1),n("div",{staticClass:"row-title"},[n("div",{staticClass:"title"},[n("h5",[t._v("下属公司")]),n("el-button",{attrs:{size:"mini"},on:{click:t.openDialog}},[t._v("+关联下属公司")])],1)]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.subsidiaryListText,border:""}},[n("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"100",index:t.indexMethod}}),n("el-table-column",{attrs:{prop:"clientCompany.clientCompanyName",align:"center",label:"公司名称"}}),n("el-table-column",{attrs:{prop:"contractRunCount",label:"执行中合同",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:null==e.row.contractRunNameTips||""==e.row.contractRunNameTips,placement:"top"}},[n("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.toArr(e.row.contractRunNameTips))},slot:"content"}),n("span",{staticClass:"adorn"},[t._v(t._s(e.row.contractRunCount)+"份")])])]}}])}),n("el-table-column",{attrs:{prop:"contractTotalCount",label:"累计合同",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:null==e.row.contractTotalNameTips||""==e.row.contractTotalNameTips,placement:"top"}},[n("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.toArr(e.row.contractTotalNameTips))},slot:"content"}),n("span",{staticClass:"adorn"},[t._v(t._s(e.row.contractTotalCount)+"份")])])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return t.disassociateBtn(e.row)}}},[t._v("取消关联")])]}}])})],1),t.paginationData.rowCount>0?n("div",{staticClass:"pagination-min"},[n("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[15,30,50],"page-size":t.pageSize,layout:"total,sizes,prev,pager,next,jumper",total:t.paginationData.rowCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e}}})],1):t._e(),n("div",{staticClass:"bottom-btn"},[n("el-button",{attrs:{size:"medium"},on:{click:t.closeCurrentPage}},[t._v("关闭")]),n("el-button",{attrs:{size:"medium"},on:{click:t.previewDraft}},[t._v("预览")]),n("Debounce",{attrs:{time:5100}},[n("el-button",{directives:[{name:"preventClick",rawName:"v-preventClick"}],attrs:{size:"medium",type:"primary"},nativeOn:{click:function(e){return t.newLyBtn("ruleForm")}}},[t._v("提交")])],1)],1),n("el-dialog",{attrs:{title:"关联下属公司",width:"40%","close-on-click-modal":!1,visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e},close:t.handleClose}},[n("div",{staticClass:"transfer-min"},[n("el-transfer",{attrs:{titles:["可选择","已选择"],filterable:"","filter-placeholder":"请输入城市拼音","target-order":"push",data:t.companySelectListData},model:{value:t.subsidiaryList,callback:function(e){t.subsidiaryList=e},expression:"subsidiaryList"}})],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancal}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.getSelectedValue}},[t._v("确 定")])],1)]),n("el-dialog",{attrs:{visible:t.dialogDraftVisible,top:"10vh",width:"90%"},on:{"update:visible":function(e){t.dialogDraftVisible=e}}},[n("div",{staticClass:"preview-box"},[n("div",{staticClass:"nav-bar"},[n("ul",t._l(t.navgator,(function(e,a){return n("li",{key:e,class:{active:t.morenIndex==a},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.Submit(a)}}},[t._v(" "+t._s(e)+" ")])})),0)]),n("div",{ref:"dialogScroll",staticClass:"cont-scroll"},[n("div",{staticClass:"detail-box basic-info",attrs:{id:"page0"}},[n("h4",[t._v("基本信息")]),n("table",{staticClass:"table-info"},[n("tr",[n("td",{attrs:{width:"12%"}},[t._v("集团名称")]),n("td",{attrs:{width:"88%",colspan:"3"}},[t._v(" "+t._s(t.clientGroupform.clientGroupName)+" ")])]),n("tr",[n("td",[t._v("集团简介")]),n("td",{attrs:{colspan:"3"}},[n("div",{staticStyle:{"text-align":"left"},domProps:{innerHTML:t._s(t.clientGroupform.clientGroupRemark)}})])]),n("tr",[n("td",{attrs:{width:"12%"}},[t._v("与下属公司的关系")]),n("td",{attrs:{width:"38%"}},[t._v(" "+t._s(t._f("relationClass")(t.clientGroupform.clientRelationType,t.clientRelationType))+" ")]),n("td",{attrs:{width:"12%"}},[t._v("是否签订框架协议")]),n("td",{attrs:{width:"38%"}},[t._v(" "+t._s(t._f("relationClass")(t.clientGroupform.isFrameContract,t.YesOrNo))+" ")])])])]),n("div",{staticClass:"detail-box child-info",attrs:{id:"page1"}},[n("h4",[t._v("下属公司")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.subsidiaryListText,border:""}},[n("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"80"}}),n("el-table-column",{attrs:{prop:"clientCompany.clientCompanyName",label:"公司名称",align:"center",width:"400"}}),n("el-table-column",{attrs:{prop:"contractRunCount",label:"执行中合同",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:null==e.row.contractRunNameTips||""==e.row.contractRunNameTips,placement:"top"}},[n("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.toArr(e.row.contractRunNameTips))},slot:"content"}),n("span",{staticClass:"adorn"},[t._v(t._s(e.row.contractRunCount)+"份")])])]}}])}),n("el-table-column",{attrs:{prop:"contractTotalCount",label:"累计合同",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:null==e.row.contractTotalNameTips||""==e.row.contractTotalNameTips,placement:"top"}},[n("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.toArr(e.row.contractTotalNameTips))},slot:"content"}),n("span",{staticClass:"adorn"},[t._v(t._s(e.row.contractTotalCount)+"份")])])]}}])}),n("el-table-column",{attrs:{label:"客户状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t.getqueryLabelById(t.clientCompanyStatusArr,e.row.clientCompany.customerStatus)))])]}}])})],1)],1)])])])],1)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row-title"},[n("div",{staticClass:"title"},[n("h5",[t._v("集团简介")])])])}],r=n("2909"),o=n("5530"),l=n("b85c"),s=n("ade3"),c=(n("d81d"),n("d3b7"),n("25f0"),n("99af"),n("a434"),n("a9e3"),n("ac1f"),n("1276"),n("a15b"),n("23ba")),u=n("ed08"),p=n("2f62"),d=n("953d"),m=(n("a753"),n("8096"),n("14e1"),n("ba0f"),{name:"saveUpdateGroup",components:{quillEditor:d["quillEditor"]},data:function(){var t,e=this,n=function(t,n,a){""===n?a(new Error("不能为空")):e.currentRegionName!=e.clientGroupform.clientGroupName?Object(c["a"])({clientGroupName:e.clientGroupform.clientGroupName}).then((function(t){a()})).catch((function(t){a(new Error("此集团名称已存在！"))})):a()};return t={navgator:["基本信息","下属公司"],morenIndex:0,scrollY:null,divHeight:null,tableData:[],content:"",currentRegionName:"",currentIsAdd:"",editorOption:{placeholder:"请在这里输入",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{align:[]}]]}},companySelectListData:[],dialogTableVisible:!1,dialogDraftVisible:!1,formInline:{user:"",region:"",resource:""},clientGroupform:{clientGroupId:"",clientGroupName:"",clientGroupRemark:"",clientRelationType:"",isFrameContract:""},rules:{clientGroupName:[{required:!0,validator:n,trigger:"blur"}],clientRelationType:[{required:!0,message:"请输入与公司的关系",trigger:"change"}],isFrameContract:[{required:!0,message:"请选择",trigger:"change"}]},totalTableData:[],subsidiaryListText:[],subsidiaryList:[]},Object(s["a"])(t,"companySelectListData",[]),Object(s["a"])(t,"currentPage",1),Object(s["a"])(t,"pageSize",15),Object(s["a"])(t,"currentTextLength",0),Object(s["a"])(t,"paginationData",{}),Object(s["a"])(t,"pageIndex",1),t},computed:{clientRelationType:function(){return this.$store.state.baseData.baseDataOptionList.IT_CRET},YesOrNo:function(){return this.$store.state.baseData.baseDataOptionList.IS_AGRE},clientCompanyStatusArr:function(){return this.$store.state.baseData.baseDataOptionList.IT_CLST}},watch:{totalTableData:{handler:function(t,e){this.subsidiaryList=t.map((function(t){return t.clientCompany.clientCompanyId})),console.log("this.subsidiaryList",this.subsidiaryList)}}},mounted:function(){this.getclientGroupformData()},filters:{relationClass:function(t,e){var n,a=Object(l["a"])(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.value==t)return i.text}}catch(r){a.e(r)}finally{a.f()}}},methods:Object(o["a"])(Object(o["a"])({},Object(p["d"])("listCacheFlag",["CHANGE_GPLT_STATUS"])),{},{indexMethod:function(t){return this.pageSize*this.currentPage+t-this.pageSize+1},getqueryLabelById:function(t,e){return Object(u["k"])(t,e)},getclientGroupformData:function(){var t=this;this.currentIsAdd=this.$route.query.clientGroupId,this.currentIsAdd?(Object(c["g"])({clientGroupId:this.currentIsAdd}).then((function(e){t.clientGroupform=e.clientGroup,t.clientGroupform.isFrameContract=t.clientGroupform.isFrameContract.toString(),t.currentRegionName=t.clientGroupform.clientGroupName})),Object(c["c"])({input:{clientGroupId:this.currentIsAdd},nextToken:"",pageEnd:0,pageIndex:1,pageSize:9999,pageStart:0}).then((function(e){var n=e.result;t.totalTableData=n;var a=n.map((function(t){return{key:t.clientCompany.clientCompanyId,label:t.clientCompany.clientCompanyName}}));t.changePagenation(),Object(c["d"])({keyword:"",clientType:"IT_CLTP_001"}).then((function(e){console.log("res",e);var n=e,i=n.map((function(t){return{key:t.clientCompanyId,label:t.clientCompanyName}}));t.companySelectListData=[].concat(Object(r["a"])(a),Object(r["a"])(i))}))}))):Object(c["d"])({keyword:"",clientType:"IT_CLTP_001"}).then((function(e){console.log("res",e);var n=e,a=n.map((function(t){return{key:t.clientCompanyId,label:t.clientCompanyName}}));t.companySelectListData=a}))},changePagenation:function(){this.paginationData.rowCount=this.totalTableData.length;var t=JSON.parse(JSON.stringify(this.totalTableData));this.subsidiaryListText=t.splice((this.currentPage-1)*this.pageSize,this.pageSize)},openDialog:function(){this.dialogTableVisible=!0},queryClientCompanyRelationPage:function(t){},getSelectedValue:function(){var t=this;this.subsidiaryList.map((function(t){return t.key})),console.log("subsidiaryList",this.subsidiaryList.length),0!=this.subsidiaryList.length?Object(c["c"])({input:{clientCompanyIds:this.subsidiaryList},nextToken:"",pageEnd:0,pageIndex:1,pageSize:9999,pageStart:0}).then((function(e){t.totalTableData=e.result,t.changePagenation(),t.dialogTableVisible=!1})):(console.log(1),this.totalTableData=[],this.changePagenation(),this.dialogTableVisible=!1)},cancal:function(){this.dialogTableVisible=!1,this.handleClose()},handleClose:function(){this.subsidiaryList=this.totalTableData.map((function(t){return t.clientCompany.clientCompanyId}))},newLyBtn:function(t){var e=this;this.$refs[t].validate((function(t){if(console.log("this.totalClientCompanyIds",e.totalClientCompanyIds),!t)return!1;console.log(11111),Object(c["l"])({clientCompanyIds:e.subsidiaryList,clientGroup:e.clientGroupform}).then((function(t){e.currentIsAdd?e.$message({message:"编辑成功！",type:"success"}):e.$message({message:"新增成功！",type:"success"});var n=e.$route;e.CHANGE_GPLT_STATUS(!0),e.$store.dispatch("tagsView/delView",n).then((function(t){t.visitedViews;e.$router.push("/customer/GroupList")}))})).catch((function(t){this.$message({message:t,type:"warning"})}))}))},closeCurrentPage:function(){var t=this;this.$confirm("内容未保存，是否直接关闭?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.$route;t.$store.dispatch("tagsView/delView",e).then((function(e){e.visitedViews;t.$router.push("/customer/GroupList")}))}))},disassociateBtn:function(t){console.log("row",t),console.log("index",this.subsidiaryListText.indexOf(t)+(this.currentPage-1)*this.pageSize);var e=this.subsidiaryListText.indexOf(t)+(this.currentPage-1)*this.pageSize;e%this.pageSize==0&&(this.currentPage=this.currentPage-1),this.totalTableData.splice(e,1),console.log("this.currentPage",this.currentPage),this.changePagenation()},previewDraft:function(){this.dialogDraftVisible=!0},onEditorChange:function(t){this.currentTextLength=t.quill.getLength()-1,console.log(this.currentTextLength,"文本长度"),t.quill.deleteText(800,1),""===this.content?this.TiLength=0:this.TiLength=t.quill.getLength()-1,this.currentTextLength>800&&t.quill.deleteText(800,Number(this.currentTextLength)-800)},Submit:function(t){this.morenIndex=t;var e=document.querySelector("#page"+t);this.$refs.dialogScroll.scrollTo({top:e.offsetTop-150,behavior:"smooth"})},toArr:function(t){var e=(t||"").split(","),n=e.join("<br/>");return n},handleSizeChange:function(){this.changePagenation()},handleCurrentChange:function(t){this.changePagenation()}})}),f=m,b=(n("b15a"),n("2877")),h=Object(b["a"])(f,a,i,!1,null,"14f79f8d",null);e["default"]=h.exports}}]);